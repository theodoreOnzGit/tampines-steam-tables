use uom::si::{available_energy::kilojoule_per_kilogram, f64::*, pressure::megapascal, specific_volume::cubic_meter_per_kilogram, thermodynamic_temperature::kelvin};
const T_PH_SUBREGION_3A_COEFFS: [[f64; 3]; 31] = [
    [0.0, 0.0, 0.10658070028513e1],
    [0.0, 0.0, -0.15732845290239e2],
    [0.0, 1.0, 0.20944396974307e2],
    [0.0, 2.0, -0.76867707878716e1],
    [0.0, 7.0, 0.26185947787954e1],
    [0.0, 10.0, -0.28080781148620e1],
    [0.0, 12.0, 0.12053369696517e1],
    [0.0, 23.0, -0.84566812812502e-2],
    [1.0, 2.0, -0.12654315477714e1],
    [1.0, 6.0, -0.11524407806681e1],
    [1.0, 15.0, 0.88521043984318],
    [1.0, 17.0, -0.64207765181607],
    [2.0, 0.0, 0.38493460186671],
    [2.0, 2.0, -0.85214708824206],
    [2.0, 6.0, 0.48972281541877e1],
    [2.0, 7.0, -0.30502617256965e1],
    [2.0, 22.0, 0.39420536879154e-1],
    [2.0, 26.0, 0.12558408424308],
    [3.0, 0.0, -0.27999329698710],
    [3.0, 2.0, 0.13899799569460e1],
    [3.0, 4.0, -0.20189915023570e1],
    [3.0, 16.0, -0.82147637173963e-2],
    [3.0, 26.0, -0.47596035734923],
    [4.0, 0.0, 0.43984074473500e-1],
    [4.0, 2.0, -0.44476435428739],
    [4.0, 4.0, 0.90572070719733],
    [4.0, 26.0, 0.70522450087967],
    [5.0, 1.0, 0.10770512626332],
    [5.0, 3.0, -0.32913623258954],
    [5.0, 26.0, -0.50871062041158],
    [6.0, 0.0, -0.22175400873096e-1],
];

const T_PH_SUBREGION_3B_COEFFS: [[f64; 3]; 33] = [
    [-12.0,0.0,3.23_254_573_644_920E-05],
    [-12.0,1.0,-1.27_575_556_587_181E-04],
    [-10.0,0.0,-4.75851877356068E-04],
    [-10.0,1.0,1.56183014181602E-03],
    [-10.0,5.0,1.05724860113781E-01],
    [-10.0,10.0,-8.58514221132534E+01],
    [-10.0,12.0,7.24140095480911E+02],
    [-8.0,0.0,2.96475810273257E-03],
    [-8.0,1.0,-5.9272198336599E-03],
    [-8.0,2.0,-1.2630542281867E-02],
    [-8.0,4.0,-1.1571619636485E-01],
    [-8.0,10.0,8.4900096973960E+01],
    [-6.0,0.0,-1.0860226008662E-02],
    [-6.0,1.0,1.5430447532885E-02],
    [-6.0,2.0,7.5045544152447E-02],
    [-4.0,0.0,2.5252097361298E-02],
    [-4.0,1.0,-6.0250790123300E-02],
    [-3.0,5.0,-3.0762222135050E+00],
    [-2.0,0.0,-5.7401195986488E-02],
    [-2.0,4.0,5.0347136093985E+00],
    [-1.0,2.0,-9.2508188858483E-01],
    [-1.0,4.0,3.9173388291755E+00],
    [-1.0,6.0,-7.7314600713019E+01],
    [-1.0,10.0,9.4930876209859E+03],
    [-1.0,14.0,-1.4104371967941E+06],
    [-1.0,16.0,8.4916623081903E+06],
    [0.0,0.0,8.6109572944670E-01],
    [0.0,2.0,3.2334644281172E-01],
    [1.0,1.0,8.7328193602044E-01],
    [3.0,1.0,-4.3665304852668E-01],
    [5.0,1.0,2.8659671452948E-01],
    [6.0,1.0,-1.3177833127623E-01],
    [8.0,1.0,6.7668206433028E-03],
    ];

/// eq 2.29
#[inline]
pub fn t_ph_3b(p: Pressure, h: AvailableEnergy) -> ThermodynamicTemperature {
    let p_ref = Pressure::new::<megapascal>(100.0);
    let h_ref = AvailableEnergy::new::<kilojoule_per_kilogram>(2800.0);
    let t_ref_kelvin = ThermodynamicTemperature::new::<kelvin>(860.0);

    let pi: f64 = (p/p_ref).into();
    let eta: f64 = (h/h_ref).into();

    // this is dimensionless temperature
    let mut theta = 0.0;

    for coeffs in T_PH_SUBREGION_3B_COEFFS {
        let ii = coeffs[0];
        let ji = coeffs[1];
        let ni = coeffs[2];

        theta += ni * (pi + 0.298).powi(ii as i32) * (eta - 0.720).powi(ji as i32);
    };

    return theta * t_ref_kelvin;

}
