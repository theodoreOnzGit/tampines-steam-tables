use uom::si::{f64::*, pressure::megapascal, ratio::ratio, specific_heat_capacity::kilojoule_per_kilogram_kelvin, specific_volume::cubic_meter_per_kilogram, thermodynamic_temperature::kelvin};

pub(crate) fn t_ps_3a(p: Pressure, s: SpecificHeatCapacity) -> ThermodynamicTemperature {

    let p_ref = Pressure::new::<megapascal>(100.0);
    let t_ref = ThermodynamicTemperature::new::<kelvin>(760.0);
    let s_ref = SpecificHeatCapacity::new::<kilojoule_per_kilogram_kelvin>(4.4);

    let sigma: f64 = (s/s_ref).get::<ratio>();
    let pi: f64 = (p/p_ref).get::<ratio>();

    let mut theta = 0.0;

    for coeffs in T_PS_SUBREGION_3A_COEFFS {
        let ii = coeffs[0];
        let ji = coeffs[1];
        let ni = coeffs[2];

        theta += ni * (pi + 0.240).powf(ii) * (sigma - 0.703).powf(ji);
    };

    return theta * t_ref;
}

const T_PS_SUBREGION_3A_COEFFS: [[f64; 3]; 33] = [
    [-12.0, 28.0, 0.150_042_008_263_875e10],
    [-12.0, 32.0, -0.159_397_258_480_424e12],
    [-10.0, 4.0, 0.502_181_140_217_975e-3],
    [-10.0, 10.0, -0.672_057_767_855_466e2],
    [-10.0, 12.0, 0.145_058_545_404_456e4],
    [-10.0, 14.0, -0.823_889_534_888_890e4],
    [-8.0, 5.0, -0.154_852_214_233_853],
    [-8.0, 7.0, 0.112_305_046_746_695e2],
    [-8.0, 8.0, -0.297_000_213_482_822e2],
    [-8.0, 28.0, 0.438_565_132_635_495e11],
    [-6.0, 2.0, 0.137_837_838_635_464e-2],
    [-6.0, 6.0, -0.297_478_527_157_462e1],
    [-6.0, 32.0, 0.971_777_947_349_413e13],
    [-5.0, 0.0, -0.571_527_767_052_397e-4],
    [-5.0, 14.0, 0.288_307_949_778_420e5],
    [-5.0, 32.0 , -0.744_428_289_262_703e14],
    [-4.0, 6.0, 0.128_017_324_848_921e2],
    [-4.0, 10.0, -0.368_275_545_889_071e3],
    [-4.0, 36.0, 0.664_768_904_779_177e16],
    [-2.0, 1.0, 0.449_359_251_958_880e-1],
    [-2.0, 4.0, -0.422_897_836_099_655e1],
    [-1.0, 1.0, -0.240_614_376_434_179],
    [-1.0, 6.0, -0.474_341_365_254_924e1],
    [0.0, 0.0, 0.724_093_999_126_110],
    [0.0, 1.0, 0.923_874_349_695_897],
    [0.0, 4.0, 0.399_043_655_281_015e1],
    [1.0, 0.0, 0.384_066_651_868_099e-1],
    [2.0, 0.0, -0.359_344_365_571_848e-2],
    [2.0, 3.0, -0.735_196_448_821_653],
    [3.0, 2.0, 0.188_367_048_396_131],
    [8.0, 0.0, 0.141_064_266_818_704e-3],
    [8.0, 1.0, -0.257_418_501_496_337e-2],
    [10.0, 2.0, 0.123_220_024_851_555e-2],
];

pub(crate) fn t_ps_3b(p: Pressure, s: SpecificHeatCapacity) -> ThermodynamicTemperature {

    let p_ref = Pressure::new::<megapascal>(100.0);
    let s_ref = SpecificHeatCapacity::new::<kilojoule_per_kilogram_kelvin>(5.3);
    let t_ref = ThermodynamicTemperature::new::<kelvin>(860.0);

    let sigma: f64 = (s/s_ref).get::<ratio>();
    let pi: f64 = (p/p_ref).get::<ratio>();

    let mut theta = 0.0;

    for coeffs in T_PS_SUBREGION_3B_COEFFS {
        let ii = coeffs[0];
        let ji = coeffs[1];
        let ni = coeffs[2];

        theta += ni * (pi + 0.760).powf(ii) * (sigma - 0.818).powf(ji);
    };

    return theta * t_ref;
}

const T_PS_SUBREGION_3B_COEFFS: [[f64; 3]; 28] = [
    [-12.0, 3.0, 0.598_647_302_038_590e-2],
    [-12.0, 5.0, -0.771_391_189_901_699],
    [-12.0, 6.0, 0.172_549_765_557_036e1],
    [-10.0, 0.0, -0.467_076_079_846_526e-3],
    [-10.0, 1.0, 0.134_533_823_384_439e-1],
    [-10.0, 2.0, -0.808_094_336_805_495e-1],
    [-10.0, 4.0, 0.508_139_374_365_767],
    [-8.0, 0.0, 0.128_584_643_361_683e-2],
    [-5.0, 1.0, -0.163_899_353_915_435e1],
    [-5.0, 2.0, 0.586_938_199_318_063e1],
    [-5.0, 3.0, -0.292_466_667_918_613e1],
    [-4.0, 0.0, -0.614_076_301_499_537e-2],
    [-4.0, 1.0, 0.576_199_014_049_172e1],
    [-4.0, 2.0, -0.121_613_320_606_788e2],
    [-4.0, 3.0, 0.167_637_540_957_944e1],
    [-3.0, 1.0, -0.744_135_838_773_463e1],
    [-2.0, 0.0, 0.378_168_091_437_659e-1],
    [-2.0, 1.0, 0.401_432_203_027_688e1],
    [-2.0, 2.0, 0.160_279_837_479_185e2],
    [-2.0, 3.0, 0.317_848_779_347_728e1],
    [-2.0, 4.0, -0.358_362_310_304_853e1],
    [-2.0, 12.0, -0.115_995_260_446_827e7],
    [0.0, 0.0, 0.199_256_573_577_909],
    [0.0, 1.0, -0.122_270_624_794_624],
    [0.0, 2.0, -0.191_449_143_716_586e2],
    [1.0, 0.0, -0.150_448_002_905_284e-1],
    [1.0, 2.0, 0.146_407_900_162_154e2],
    [2.0, 2.0, -0.327_477_787_188_230e1],
];



