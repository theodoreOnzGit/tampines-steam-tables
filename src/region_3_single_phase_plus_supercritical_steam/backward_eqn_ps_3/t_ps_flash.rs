use uom::si::{f64::*, pressure::megapascal, ratio::ratio, specific_heat_capacity::kilojoule_per_kilogram_kelvin, thermodynamic_temperature::kelvin};

pub(crate) fn t_ps_3a(p: Pressure, s: SpecificHeatCapacity) -> ThermodynamicTemperature {

    let p_ref = Pressure::new::<megapascal>(100.0);
    let t_ref = ThermodynamicTemperature::new::<kelvin>(760.0);
    let s_ref = SpecificHeatCapacity::new::<kilojoule_per_kilogram_kelvin>(4.4);

    let sigma: f64 = (s/s_ref).get::<ratio>();
    let pi: f64 = (p/p_ref).get::<ratio>();

    let mut theta = 0.0;

    for coeffs in T_PS_SUBREGION_3A_COEFFS {
        let ii = coeffs[0];
        let ji = coeffs[1];
        let ni = coeffs[2];

        theta += ni * (pi + 0.240).powf(ii) * (sigma - 0.703).powf(ji);
    };

    return theta * t_ref;
}

const T_PS_SUBREGION_3A_COEFFS: [[f64; 3]; 33] = [
    [-12.0, 28.0, 0.150_042_008_263_875e10],
    [-12.0, 32.0, -0.159_397_258_480_424e12],
    [-10.0, 4.0, 0.502_181_140_217_975e-3],
    [-10.0, 10.0, -0.672_057_767_855_466e2],
    [-10.0, 12.0, 0.145_058_545_404_456e4],
    [-10.0, 14.0, -0.823_889_534_888_890e4],
    [-8.0, 5.0, -0.154_852_214_233_853],
    [-8.0, 7.0, 0.112_305_046_746_695e2],
    [-8.0, 8.0, -0.297_000_213_482_822e2],
    [-8.0, 28.0, 0.438_565_132_635_495e11],
    [-6.0, 2.0, 0.137_837_838_635_464e-2],
    [-6.0, 6.0, -0.297_478_527_157_462e1],
    [-6.0, 32.0, 0.971_777_947_349_413e13],
    [-5.0, 0.0, -0.571_527_767_052_397e-4],
    [-5.0, 14.0, 0.288_307_949_778_420e5],
    [-5.0, 32.0 , -0.744_428_289_262_703e14],
    [-4.0, 6.0, 0.128_017_324_848_921e2],
    [-4.0, 10.0, -0.368_275_545_889_071e3],
    [-4.0, 36.0, 0.664_768_904_779_177e16],
    [-2.0, 1.0, 0.449_359_251_958_880e-1],
    [-2.0, 4.0, -0.422_897_836_099_655e1],
    [-1.0, 1.0, -0.240_614_376_434_179],
    [-1.0, 6.0, -0.474_341_365_254_924e1],
    [0.0, 0.0, 0.724_093_999_126_110],
    [0.0, 1.0, 0.923_874_349_695_897],
    [0.0, 4.0, 0.399_043_655_281_015e1],
    [1.0, 0.0, 0.384_066_651_868_099e-1],
    [2.0, 0.0, -0.359_344_365_571_848e-2],
    [2.0, 3.0, -0.735_196_448_821_653],
    [3.0, 2.0, 0.188_367_048_396_131],
    [8.0, 0.0, 0.141_064_266_818_704e-3],
    [8.0, 1.0, -0.257_418_501_496_337e-2],
    [10.0, 2.0, 0.123_220_024_851_555e-2],
];

pub(crate) fn t_ps_3b(p: Pressure, s: SpecificHeatCapacity) -> ThermodynamicTemperature {

    let p_ref = Pressure::new::<megapascal>(100.0);
    let s_ref = SpecificHeatCapacity::new::<kilojoule_per_kilogram_kelvin>(5.3);
    let t_ref = ThermodynamicTemperature::new::<kelvin>(860.0);

    let sigma: f64 = (s/s_ref).get::<ratio>();
    let pi: f64 = (p/p_ref).get::<ratio>();

    let mut theta = 0.0;

    for coeffs in T_PS_SUBREGION_3B_COEFFS {
        let ii = coeffs[0];
        let ji = coeffs[1];
        let ni = coeffs[2];

        theta += ni * (pi + 0.760).powf(ii) * (sigma - 0.818).powf(ji);
    };

    return theta * t_ref;
}

const T_PS_SUBREGION_3B_COEFFS: [[f64; 3]; 28] = [
    [-12.0, 1.0, 0.527_111_701_601_660],
    [-12.0,3.0, -0.401_317_830_052_742e2],
    [-12.0, 4.0, 0.153_020_073_134_484e3],
    [-12.0, 7.0, -0.224_799_398_218_827e4],
    [-8.0, 0.0, -0.193_993_484_669_048],
    [-8.0, 1.0, -0.140_467_557_893_768e1],
    [-8.0, 3.0, 0.426_799_878_114_024e2],
    [-6.0, 0.0, 0.752_810_643_416_743],
    [-6.0, 2.0, 0.226_657_238_616_417e2],
    [-6.0, 4.0, -0.622_873_556_909_932e3],
    [-5.0, 0.0, -0.660_823_667_935_396],
    [-5.0, 1.0, 0.841_267_087_271_658],
    [-5.0, 2.0, -0.253_717_501_764_397e2],
    [-5.0, 4.0, 0.485_708_963_532_948e3],
    [-5.0, 6.0, 0.880_531_517_490_555e3],
    [-4.0, 12.0, 0.265_015_592_794_626e7],
    [-3.0, 1.0, -0.359_287_150_025_783],
    [-3.0, 6.0, -0.656_991_567_673_753e3],
    [-2.0, 2.0, 0.241_768_149_185_367e1],
    [0.0, 0.0, 0.856_873_461_222_588],
    [2.0, 1.0, 0.655_143_675_313_458],
    [3.0, 1.0, -0.213_535_213_206_406],
    [4.0, 0.0, 0.562_974_957_606_348e-2],
    [5.0, 24.0, -0.316_955_725_450_471e15],
    [6.0, 0.0, -0.699_997_000_152_457e-3],
    [8.0, 3.0, 0.119_845_803_210_767e-1],
    [12.0, 1.0, 0.193_848_122_022_095e-4],
    [14.0, 2.0, -0.215_095_749_182_309e-4],
];



