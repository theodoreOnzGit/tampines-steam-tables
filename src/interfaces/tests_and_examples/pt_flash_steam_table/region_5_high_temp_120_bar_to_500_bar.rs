use uom::si::{available_energy::kilojoule_per_kilogram, temperature_interval};
use uom::si::pressure::bar;
use uom::si::f64::*;
use uom::si::ratio::ratio;
use uom::si::specific_heat_capacity::kilojoule_per_kilogram_kelvin;
use uom::si::specific_volume::cubic_meter_per_kilogram;
use uom::si::thermodynamic_temperature::degree_celsius;

use crate::{interfaces::functional_programming::{ph_flash_eqm::x_ph_flash, pt_flash_eqm::{cp_tp_eqm_two_phase, h_tp_eqm_two_phase, kappa_tp_eqm_two_phase, s_tp_eqm_two_phase, v_tp_eqm_two_phase}}, region_4_vap_liq_equilibrium::sat_temp_4};


#[test]
pub fn single_phase_table_120_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,120.0,0.0403706,4105.4,7.3175,2.4793,1.2571],
        [820.0,120.0,0.0412113,4154.94,7.3632,2.4842,1.2555],
        [840.0,120.0,0.0420447,4204.68,7.4083,2.49,1.2538],
        [860.0,120.0,0.0428743,4254.54,7.4527,2.4964,1.2522],
        [880.0,120.0,0.0437004,4304.54,7.4964,2.5033,1.2505],
        [900.0,120.0,0.0445234,4354.68,7.5395,2.5108,1.2489],
        [920.0,120.0,0.0453434,4404.97,7.582,2.5187,1.2473],
        [940.0,120.0,0.0461607,4455.43,7.624,2.527,1.2457],
        [960.0,120.0,0.0469755,4506.05,7.6654,2.5355,1.2441],
        [980.0,120.0,0.047788,4556.85,7.7062,2.5443,1.2426],
        [1020.0,120.0,0.0494065,4658.98,7.7865,2.5624,1.2396],
        [1040.0,120.0,0.0502128,4710.32,7.8259,2.5716,1.2381],
        [1060.0,120.0,0.0510173,4761.85,7.8648,2.581,1.2367],
        [1080.0,120.0,0.0518202,4813.56,7.9033,2.5904,1.2353],
        [1100.0,120.0,0.0526216,4865.46,7.9414,2.5998,1.234],
        [1120.0,120.0,0.0534214,4917.55,7.979,2.6093,1.2326],
        [1140.0,120.0,0.0542199,4969.83,8.0163,2.6188,1.2313],
        [1160.0,120.0,0.0550171,5022.3,8.0532,2.6282,1.23],
        [1180.0,120.0,0.055813,5074.96,8.0897,2.6376,1.2288],
        [1200.0,120.0,0.0566079,5127.81,8.1258,2.647,1.2276],
        [1220.0,120.0,0.0574016,5180.84,8.1615,2.6563,1.2264],
        [1240.0,120.0,0.0581943,5234.06,8.1969,2.6655,1.2252],
        [1260.0,120.0,0.058986,5287.46,8.232,2.6747,1.2241],
        [1280.0,120.0,0.0597768,5341.05,8.2667,2.6838,1.2229],
        [1300.0,120.0,0.0605667,5394.81,8.3011,2.6927,1.2219],
        [1320.0,120.0,0.0613559,5448.75,8.3352,2.7016,1.2208],
        [1340.0,120.0,0.0621442,5502.87,8.3689,2.7104,1.2198],
        [1360.0,120.0,0.0629318,5557.17,8.4024,2.7191,1.2188],
        [1380.0,120.0,0.0637186,5611.64,8.4355,2.7277,1.2178],
        [1400.0,120.0,0.0645049,5666.28,8.4684,2.7361,1.2168],
        [1420.0,120.0,0.0652904,5721.08,8.501,2.7445,1.2159],
        [1440.0,120.0,0.0660754,5776.06,8.5332,2.7527,1.215],
        [1460.0,120.0,0.0668598,5831.19,8.5652,2.7609,1.2141],
        [1480.0,120.0,0.0676436,5886.49,8.597,2.7689,1.2132],
        [1500.0,120.0,0.0684269,5941.95,8.6284,2.7768,1.2123],
        [1550.0,120.0,0.0703831,6081.27,8.7059,2.796,1.2103],
        [1600.0,120.0,0.0723364,6221.54,8.7818,2.8145,1.2084],
        [1650.0,120.0,0.0742873,6362.71,8.8562,2.8324,1.2066],
        [1700.0,120.0,0.0762359,6504.77,8.9291,2.8496,1.2048],
        [1750.0,120.0,0.0781825,6647.67,9.0006,2.8663,1.2032],
        [1800.0,120.0,0.0801273,6791.39,9.0708,2.8824,1.2016],
        [1850.0,120.0,0.0820705,6935.9,9.1397,2.8981,1.2001],
        [1900.0,120.0,0.0840121,7081.19,9.2073,2.9133,1.1987],
        [1950.0,120.0,0.0859525,7227.23,9.2737,2.9283,1.1973],
        [2000.0,120.0,0.0878916,7374.01,9.339,2.9429,1.196],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

#[test]
pub fn single_phase_table_140_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,140.0,0.0344758,4096.02,7.2393,2.5033,1.2596],
        [820.0,140.0,0.0352065,4146.04,7.2854,2.5067,1.2579],
        [840.0,140.0,0.0359302,4196.21,7.3309,2.5109,1.2562],
        [860.0,140.0,0.03665,4246.48,7.3757,2.516,1.2545],
        [880.0,140.0,0.0373664,4296.86,7.4197,2.5217,1.2528],
        [900.0,140.0,0.0380796,4347.35,7.4632,2.5281,1.2512],
        [920.0,140.0,0.0387898,4397.98,7.506,2.535,1.2496],
        [940.0,140.0,0.0394973,4448.75,7.5482,2.5423,1.248],
        [960.0,140.0,0.0402022,4499.68,7.5898,2.55,1.2464],
        [980.0,140.0,0.0409048,4550.76,7.6309,2.558,1.2448],
        [1020.0,140.0,0.0423035,4653.41,7.7115,2.5747,1.2418],
        [1040.0,140.0,0.043,4704.99,7.7511,2.5833,1.2403],
        [1060.0,140.0,0.0436946,4756.74,7.7902,2.5921,1.2389],
        [1080.0,140.0,0.0443876,4808.67,7.8289,2.601,1.2375],
        [1100.0,140.0,0.045079,4860.78,7.8671,2.6099,1.2361],
        [1120.0,140.0,0.0457689,4913.07,7.9049,2.6189,1.2347],
        [1140.0,140.0,0.0464575,4965.53,7.9423,2.6279,1.2334],
        [1160.0,140.0,0.0471448,5018.18,7.9793,2.637,1.2321],
        [1180.0,140.0,0.0478308,5071.01,8.0159,2.646,1.2308],
        [1200.0,140.0,0.0485157,5124.02,8.0521,2.655,1.2296],
        [1220.0,140.0,0.0491995,5177.21,8.088,2.6639,1.2284],
        [1240.0,140.0,0.0498823,5230.58,8.1235,2.6729,1.2272],
        [1260.0,140.0,0.0505641,5284.13,8.1586,2.6817,1.2261],
        [1280.0,140.0,0.0512449,5337.85,8.1935,2.6905,1.2249],
        [1300.0,140.0,0.0519249,5391.75,8.2279,2.6992,1.2238],
        [1320.0,140.0,0.0526041,5445.82,8.2621,2.7079,1.2228],
        [1340.0,140.0,0.0532825,5500.06,8.2959,2.7164,1.2217],
        [1360.0,140.0,0.0539602,5554.47,8.3295,2.7249,1.2207],
        [1380.0,140.0,0.0546372,5609.05,8.3627,2.7332,1.2197],
        [1400.0,140.0,0.0553134,5663.8,8.3956,2.7415,1.2187],
        [1420.0,140.0,0.0559891,5718.71,8.4282,2.7496,1.2178],
        [1440.0,140.0,0.0566641,5773.79,8.4605,2.7577,1.2168],
        [1460.0,140.0,0.0573386,5829.02,8.4926,2.7656,1.2159],
        [1480.0,140.0,0.0580125,5884.41,8.5244,2.7735,1.215],
        [1500.0,140.0,0.0586859,5939.96,8.5559,2.7812,1.2142],
        [1550.0,140.0,0.0603673,6079.49,8.6335,2.8001,1.2121],
        [1600.0,140.0,0.0620458,6219.95,8.7095,2.8183,1.2102],
        [1650.0,140.0,0.0637219,6361.31,8.784,2.8358,1.2083],
        [1700.0,140.0,0.0653958,6503.53,8.857,2.8528,1.2065],
        [1750.0,140.0,0.0670676,6646.58,8.9286,2.8692,1.2049],
        [1800.0,140.0,0.0687376,6790.44,8.9988,2.8851,1.2033],
        [1850.0,140.0,0.070406,6935.08,9.0677,2.9006,1.2018],
        [1900.0,140.0,0.072073,7080.49,9.1354,2.9157,1.2003],
        [1950.0,140.0,0.0737386,7226.65,9.2019,2.9304,1.1989],
        [2000.0,140.0,0.0754029,7373.53,9.2673,2.945,1.1975],



        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}


#[test]
pub fn single_phase_table_160_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,160.0,0.0300554,4086.62,7.1706,2.5277,1.2622],
        [820.0,160.0,0.0307035,4137.11,7.2172,2.5295,1.2603],
        [840.0,160.0,0.0313449,4187.73,7.263,2.5322,1.2586],
        [860.0,160.0,0.0319825,4238.41,7.3082,2.5358,1.2569],
        [880.0,160.0,0.0326166,4289.16,7.3526,2.5403,1.2553],
        [900.0,160.0,0.0332474,4340.02,7.3963,2.5455,1.2536],
        [920.0,160.0,0.0338753,4390.99,7.4394,2.5514,1.2519],
        [940.0,160.0,0.0345004,4442.08,7.4818,2.5577,1.2503],
        [960.0,160.0,0.0351229,4493.3,7.5237,2.5646,1.2487],
        [980.0,160.0,0.0357431,4544.66,7.565,2.5717,1.2471],
        [1020.0,160.0,0.0369769,4647.84,7.6461,2.587,1.2441],
        [1040.0,160.0,0.0375909,4699.66,7.6858,2.595,1.2426],
        [1060.0,160.0,0.0382031,4751.64,7.7251,2.6032,1.2411],
        [1080.0,160.0,0.0388137,4803.79,7.764,2.6116,1.2397],
        [1100.0,160.0,0.0394226,4856.1,7.8023,2.62,1.2383],
        [1120.0,160.0,0.0400301,4908.59,7.8403,2.6285,1.2369],
        [1140.0,160.0,0.0406362,4961.24,7.8778,2.6371,1.2355],
        [1160.0,160.0,0.041241,5014.07,7.9149,2.6457,1.2342],
        [1180.0,160.0,0.0418446,5067.07,7.9517,2.6544,1.2329],
        [1200.0,160.0,0.042447,5120.25,7.988,2.663,1.2317],
        [1220.0,160.0,0.0430484,5173.59,8.024,2.6716,1.2305],
        [1240.0,160.0,0.0436487,5227.11,8.0596,2.6802,1.2293],
        [1260.0,160.0,0.0442481,5280.8,8.0948,2.6888,1.2281],
        [1280.0,160.0,0.0448465,5334.66,8.1297,2.6973,1.227],
        [1300.0,160.0,0.045444,5388.69,8.1643,2.7057,1.2258],
        [1320.0,160.0,0.0460408,5442.89,8.1985,2.7141,1.2248],
        [1340.0,160.0,0.0466367,5497.25,8.2324,2.7224,1.2237],
        [1360.0,160.0,0.0472319,5551.78,8.266,2.7306,1.2227],
        [1380.0,160.0,0.0478264,5606.48,8.2993,2.7388,1.2216],
        [1400.0,160.0,0.0484203,5661.33,8.3323,2.7468,1.2206],
        [1420.0,160.0,0.0490135,5716.35,8.365,2.7548,1.2197],
        [1440.0,160.0,0.0496061,5771.52,8.3974,2.7626,1.2187],
        [1460.0,160.0,0.0501981,5826.85,8.4295,2.7704,1.2178],
        [1480.0,160.0,0.0507896,5882.34,8.4613,2.7781,1.2169],
        [1500.0,160.0,0.0513805,5937.97,8.4929,2.7856,1.216],
        [1550.0,160.0,0.0528558,6077.72,8.5706,2.8041,1.2139],
        [1600.0,160.0,0.0543282,6218.38,8.6467,2.822,1.2119],
        [1650.0,160.0,0.0557982,6359.91,8.7213,2.8393,1.21],
        [1700.0,160.0,0.057266,6502.29,8.7944,2.856,1.2083],
        [1750.0,160.0,0.0587317,6645.5,8.866,2.8721,1.2066],
        [1800.0,160.0,0.0601957,6789.5,8.9363,2.8878,1.2049],
        [1850.0,160.0,0.061658,6934.27,9.0053,2.9031,1.2034],
        [1900.0,160.0,0.0631188,7079.8,9.0731,2.918,1.2019],
        [1950.0,160.0,0.0645783,7226.07,9.1396,2.9326,1.2005],
        [2000.0,160.0,0.0660366,7373.06,9.205,2.947,1.1991],




        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

#[test]
pub fn single_phase_table_180_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,180.0,0.0266179,4077.18,7.1091,2.5525,1.265],
        [820.0,180.0,0.0272017,4128.17,7.1561,2.5526,1.263],
        [840.0,180.0,0.0277792,4179.23,7.2024,2.5536,1.2612],
        [860.0,180.0,0.0283528,4230.32,7.2479,2.5558,1.2595],
        [880.0,180.0,0.0289229,4281.47,7.2927,2.559,1.2578],
        [900.0,180.0,0.0294897,4332.69,7.3367,2.5631,1.2561],
        [920.0,180.0,0.0300535,4384.0,7.3801,2.5679,1.2544],
        [940.0,180.0,0.0306145,4435.41,7.4228,2.5733,1.2527],
        [960.0,180.0,0.0311729,4486.93,7.4649,2.5792,1.2511],
        [980.0,180.0,0.031729,4538.58,7.5065,2.5856,1.2495],
        [1020.0,180.0,0.0328346,4642.28,7.5879,2.5994,1.2464],
        [1040.0,180.0,0.0333845,4694.34,7.6279,2.6068,1.2448],
        [1060.0,180.0,0.0339325,4746.55,7.6673,2.6144,1.2434],
        [1080.0,180.0,0.0344789,4798.91,7.7063,2.6222,1.2419],
        [1100.0,180.0,0.0350237,4851.44,7.7448,2.6301,1.2405],
        [1120.0,180.0,0.0355671,4904.12,7.7829,2.6381,1.2391],
        [1140.0,180.0,0.0361091,4956.96,7.8206,2.6463,1.2377],
        [1160.0,180.0,0.0366497,5009.97,7.8578,2.6545,1.2364],
        [1180.0,180.0,0.0371892,5063.14,7.8947,2.6627,1.2351],
        [1200.0,180.0,0.0377275,5116.48,7.9311,2.671,1.2338],
        [1220.0,180.0,0.0382647,5169.98,7.9672,2.6793,1.2326],
        [1240.0,180.0,0.0388008,5223.65,8.0029,2.6875,1.2313],
        [1260.0,180.0,0.039336,5277.48,8.0383,2.6958,1.2302],
        [1280.0,180.0,0.0398703,5331.48,8.0733,2.704,1.229],
        [1300.0,180.0,0.0404037,5385.64,8.1079,2.7122,1.2279],
        [1320.0,180.0,0.0409363,5439.97,8.1422,2.7203,1.2268],
        [1340.0,180.0,0.0414681,5494.46,8.1762,2.7284,1.2257],
        [1360.0,180.0,0.0419992,5549.1,8.2099,2.7364,1.2246],
        [1380.0,180.0,0.0425296,5603.91,8.2432,2.7443,1.2236],
        [1400.0,180.0,0.0430593,5658.87,8.2763,2.7521,1.2226],
        [1420.0,180.0,0.0435884,5713.99,8.309,2.7599,1.2216],
        [1440.0,180.0,0.0441168,5769.27,8.3415,2.7676,1.2207],
        [1460.0,180.0,0.0446447,5824.69,8.3736,2.7751,1.2197],
        [1480.0,180.0,0.045172,5880.27,8.4055,2.7826,1.2188],
        [1500.0,180.0,0.0456989,5936.0,8.4371,2.7901,1.2179],
        [1550.0,180.0,0.0470138,6075.96,8.515,2.8082,1.2158],
        [1600.0,180.0,0.0483259,6216.81,8.5912,2.8257,1.2137],
        [1650.0,180.0,0.0496356,6358.52,8.6659,2.8427,1.2118],
        [1700.0,180.0,0.050943,6501.07,8.739,2.8591,1.21],
        [1750.0,180.0,0.0522485,6644.42,8.8108,2.875,1.2083],
        [1800.0,180.0,0.0535521,6788.56,8.8812,2.8905,1.2066],
        [1850.0,180.0,0.0548541,6933.47,8.9502,2.9056,1.205],
        [1900.0,180.0,0.0561547,7079.12,9.018,2.9203,1.2035],
        [1950.0,180.0,0.0574539,7225.49,9.0846,2.9348,1.202],
        [2000.0,180.0,0.0587519,7372.59,9.15,2.949,1.2006],





        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

#[test]
pub fn single_phase_table_200_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,200.0,0.0238685,4067.73,7.0534,2.5775,1.2679],
        [820.0,200.0,0.0244009,4119.21,7.1008,2.5759,1.2657],
        [840.0,200.0,0.0249273,4170.72,7.1475,2.5753,1.2639],
        [860.0,200.0,0.0254497,4222.23,7.1934,2.5761,1.2621],
        [880.0,200.0,0.0259686,4273.77,7.2385,2.5779,1.2604],
        [900.0,200.0,0.0264841,4325.36,7.2828,2.5808,1.2586],
        [920.0,200.0,0.0269966,4377.01,7.3265,2.5845,1.2569],
        [940.0,200.0,0.0275064,4428.74,7.3695,2.5889,1.2552],
        [960.0,200.0,0.0280135,4480.57,7.4118,2.5939,1.2535],
        [980.0,200.0,0.0285183,4532.5,7.4536,2.5995,1.2519],
        [1020.0,200.0,0.0295213,4636.72,7.5355,2.6119,1.2487],
        [1040.0,200.0,0.0300198,4689.03,7.5756,2.6186,1.2472],
        [1060.0,200.0,0.0305166,4741.47,7.6153,2.6256,1.2457],
        [1080.0,200.0,0.0310116,4794.05,7.6544,2.6328,1.2442],
        [1100.0,200.0,0.0315051,4846.78,7.6931,2.6402,1.2427],
        [1120.0,200.0,0.0319972,4899.66,7.7313,2.6478,1.2413],
        [1140.0,200.0,0.0324878,4952.69,7.7691,2.6555,1.2399],
        [1160.0,200.0,0.0329771,5005.88,7.8065,2.6632,1.2386],
        [1180.0,200.0,0.0334652,5059.22,7.8435,2.6711,1.2373],
        [1200.0,200.0,0.0339522,5112.72,7.88,2.679,1.236],
        [1220.0,200.0,0.0344381,5166.38,7.9162,2.6869,1.2347],
        [1240.0,200.0,0.0349229,5220.2,7.952,2.6949,1.2335],
        [1260.0,200.0,0.0354068,5274.18,7.9874,2.7028,1.2323],
        [1280.0,200.0,0.0358898,5328.31,8.0225,2.7107,1.2311],
        [1300.0,200.0,0.0363719,5382.61,8.0573,2.7186,1.2299],
        [1320.0,200.0,0.0368531,5437.06,8.0917,2.7265,1.2288],
        [1340.0,200.0,0.0373336,5491.67,8.1257,2.7343,1.2277],
        [1360.0,200.0,0.0378134,5546.43,8.1595,2.7421,1.2266],
        [1380.0,200.0,0.0382924,5601.35,8.1929,2.7498,1.2256],
        [1400.0,200.0,0.0387708,5656.42,8.226,2.7574,1.2246],
        [1420.0,200.0,0.0392486,5711.65,8.2588,2.765,1.2236],
        [1440.0,200.0,0.0397257,5767.02,8.2913,2.7725,1.2226],
        [1460.0,200.0,0.0402023,5822.55,8.3235,2.7799,1.2216],
        [1480.0,200.0,0.0406783,5878.22,8.3555,2.7872,1.2207],
        [1500.0,200.0,0.0411538,5934.03,8.3871,2.7945,1.2198],
        [1550.0,200.0,0.0423405,6074.2,8.4651,2.8122,1.2176],
        [1600.0,200.0,0.0435243,6215.25,8.5414,2.8294,1.2156],
        [1650.0,200.0,0.0447057,6357.14,8.6162,2.8461,1.2136],
        [1700.0,200.0,0.0458849,6499.85,8.6894,2.8623,1.2117],
        [1750.0,200.0,0.0470621,6643.35,8.7612,2.878,1.21],
        [1800.0,200.0,0.0482375,6787.63,8.8317,2.8932,1.2083],
        [1850.0,200.0,0.0494112,6932.67,8.9008,2.9081,1.2067],
        [1900.0,200.0,0.0505835,7078.44,8.9687,2.9226,1.2051],
        [1950.0,200.0,0.0517545,7224.93,9.0353,2.9369,1.2036],
        [2000.0,200.0,0.0529243,7372.13,9.1008,2.951,1.2022],






        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_220_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,220.0,0.0216197,4058.25,7.0022,2.6029,1.271],
        [820.0,220.0,0.02211,4110.24,7.0501,2.5996,1.2686],
        [840.0,220.0,0.0225945,4162.21,7.0972,2.5973,1.2667],
        [860.0,220.0,0.0230751,4214.14,7.1435,2.5965,1.2649],
        [880.0,220.0,0.023552,4266.07,7.1889,2.597,1.2631],
        [900.0,220.0,0.0240256,4318.03,7.2336,2.5986,1.2613],
        [920.0,220.0,0.0244962,4370.02,7.2775,2.6012,1.2595],
        [940.0,220.0,0.0249639,4422.08,7.3208,2.6046,1.2578],
        [960.0,220.0,0.0254291,4474.21,7.3634,2.6087,1.2561],
        [980.0,220.0,0.0258919,4526.43,7.4054,2.6134,1.2544],
        [1020.0,220.0,0.0268109,4631.18,7.4877,2.6243,1.2512],
        [1040.0,220.0,0.0272674,4683.73,7.528,2.6304,1.2496],
        [1060.0,220.0,0.0277222,4736.4,7.5678,2.6368,1.2481],
        [1080.0,220.0,0.0281752,4789.2,7.6072,2.6434,1.2465],
        [1100.0,220.0,0.0286267,4842.14,7.646,2.6503,1.2451],
        [1120.0,220.0,0.0290767,4895.21,7.6844,2.6574,1.2436],
        [1140.0,220.0,0.0295254,4948.43,7.7223,2.6647,1.2422],
        [1160.0,220.0,0.0299727,5001.8,7.7598,2.672,1.2408],
        [1180.0,220.0,0.0304188,5055.31,7.7969,2.6795,1.2395],
        [1200.0,220.0,0.0308638,5108.98,7.8335,2.687,1.2382],
        [1220.0,220.0,0.0313076,5162.79,7.8698,2.6946,1.2369],
        [1240.0,220.0,0.0317505,5216.76,7.9057,2.7022,1.2356],
        [1260.0,220.0,0.0321923,5270.88,7.9413,2.7098,1.2344],
        [1280.0,220.0,0.0326333,5325.16,7.9764,2.7175,1.2332],
        [1300.0,220.0,0.0330734,5379.58,8.0113,2.7251,1.232],
        [1320.0,220.0,0.0335127,5434.16,8.0457,2.7327,1.2309],
        [1340.0,220.0,0.0339512,5488.89,8.0799,2.7403,1.2298],
        [1360.0,220.0,0.0343889,5543.77,8.1137,2.7478,1.2287],
        [1380.0,220.0,0.034826,5598.8,8.1472,2.7553,1.2276],
        [1400.0,220.0,0.0352624,5653.98,8.1804,2.7627,1.2266],
        [1420.0,220.0,0.0356981,5709.31,8.2132,2.7701,1.2255],
        [1440.0,220.0,0.0361333,5764.79,8.2458,2.7774,1.2246],
        [1460.0,220.0,0.0365679,5820.41,8.2781,2.7846,1.2236],
        [1480.0,220.0,0.0370019,5876.17,8.3101,2.7918,1.2226],
        [1500.0,220.0,0.0374354,5932.08,8.3418,2.7989,1.2217],
        [1550.0,220.0,0.0385171,6072.46,8.4199,2.8162,1.2195],
        [1600.0,220.0,0.039596,6213.69,8.4963,2.8331,1.2174],
        [1650.0,220.0,0.0406724,6355.76,8.5711,2.8495,1.2154],
        [1700.0,220.0,0.0417466,6498.63,8.644,2.8654,1.2135],
        [1750.0,220.0,0.0428189,6642.29,8.716,2.8809,1.2117],
        [1800.0,220.0,0.0438893,6786.71,8.787,2.8959,1.21],
        [1850.0,220.0,0.0449582,6931.87,8.856,2.9106,1.2083],
        [1900.0,220.0,0.0460255,7077.76,8.924,2.9249,1.2067],
        [1950.0,220.0,0.0470915,7224.36,8.991,2.9391,1.2052],
        [2000.0,220.0,0.0481564,7371.67,9.056,2.953,1.2037],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}


#[test]
pub fn single_phase_table_240_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,240.0,0.0197464,4048.76,6.9549,2.6286,1.2742],
        [820.0,240.0,0.0202015,4101.26,7.0033,2.6235,1.2716],
        [840.0,240.0,0.0206512,4153.69,7.0508,2.6194,1.2697],
        [860.0,240.0,0.0210968,4206.05,7.0974,2.617,1.2678],
        [880.0,240.0,0.0215388,4258.38,7.1432,2.6161,1.2659],
        [900.0,240.0,0.0219774,4310.7,7.1882,2.6165,1.264],
        [920.0,240.0,0.022413,4363.05,7.2324,2.6179,1.2622],
        [940.0,240.0,0.0228458,4415.43,7.276,2.6203,1.2605],
        [960.0,240.0,0.023276,4467.86,7.3188,2.6235,1.2587],
        [980.0,240.0,0.0237038,4520.37,7.3611,2.6274,1.257],
        [1020.0,240.0,0.0245527,4625.65,7.4438,2.6368,1.2537],
        [1040.0,240.0,0.0249743,4678.44,7.4843,2.6422,1.2521],
        [1060.0,240.0,0.025394,4731.34,7.5243,2.648,1.2505],
        [1080.0,240.0,0.025812,4784.36,7.5637,2.6541,1.2489],
        [1100.0,240.0,0.0262285,4837.5,7.6027,2.6605,1.2474],
        [1120.0,240.0,0.0266435,4890.78,7.6412,2.667,1.246],
        [1140.0,240.0,0.0270571,4944.19,7.6793,2.6738,1.2445],
        [1160.0,240.0,0.0274694,4997.73,7.7169,2.6808,1.2431],
        [1180.0,240.0,0.0278805,5051.42,7.7541,2.6878,1.2417],
        [1200.0,240.0,0.0282904,5105.25,7.7909,2.695,1.2404],
        [1220.0,240.0,0.0286993,5159.22,7.8273,2.7022,1.2391],
        [1240.0,240.0,0.0291071,5213.34,7.8633,2.7095,1.2378],
        [1260.0,240.0,0.029514,5267.6,7.8989,2.7169,1.2365],
        [1280.0,240.0,0.0299199,5322.01,7.9342,2.7242,1.2353],
        [1300.0,240.0,0.030325,5376.57,7.9691,2.7316,1.2341],
        [1320.0,240.0,0.0307293,5431.27,8.0036,2.7389,1.233],
        [1340.0,240.0,0.0311327,5486.12,8.0379,2.7462,1.2318],
        [1360.0,240.0,0.0315355,5541.12,8.0717,2.7535,1.2307],
        [1380.0,240.0,0.0319375,5596.26,8.1053,2.7608,1.2296],
        [1400.0,240.0,0.0323389,5651.55,8.1385,2.768,1.2286],
        [1420.0,240.0,0.0327397,5706.98,8.1715,2.7752,1.2275],
        [1440.0,240.0,0.0331398,5762.56,8.2041,2.7823,1.2265],
        [1460.0,240.0,0.0335394,5818.27,8.2364,2.7893,1.2255],
        [1480.0,240.0,0.0339385,5874.13,8.2685,2.7963,1.2246],
        [1500.0,240.0,0.034337,5930.13,8.3003,2.8033,1.2236],
        [1550.0,240.0,0.0353312,6070.72,8.3784,2.8203,1.2214],
        [1600.0,240.0,0.0363226,6212.15,8.455,2.8368,1.2192],
        [1650.0,240.0,0.0373115,6354.39,8.5299,2.8529,1.2172],
        [1700.0,240.0,0.0382983,6497.43,8.6033,2.8685,1.2153],
        [1750.0,240.0,0.0392831,6641.23,8.6753,2.8837,1.2134],
        [1800.0,240.0,0.040266,6785.79,8.7459,2.8986,1.2117],
        [1850.0,240.0,0.0412474,6931.09,8.8151,2.9131,1.21],
        [1900.0,240.0,0.0422273,7077.1,8.8831,2.9273,1.2084],
        [1950.0,240.0,0.0432059,7223.81,8.9499,2.9412,1.2068],
        [2000.0,240.0,0.0441833,7371.21,9.0154,2.955,1.2053],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_260_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,260.0,0.018162,4039.25,6.9107,2.6545,1.2776],
        [820.0,260.0,0.0185873,4092.28,6.9596,2.6476,1.2748],
        [840.0,260.0,0.0190074,4145.17,7.0075,2.6417,1.2727],
        [860.0,260.0,0.0194235,4197.96,7.0546,2.6377,1.2708],
        [880.0,260.0,0.0198359,4250.69,7.1007,2.6354,1.2688],
        [900.0,260.0,0.020245,4303.39,7.146,2.6345,1.2669],
        [920.0,260.0,0.020651,4356.08,7.1905,2.6348,1.265],
        [940.0,260.0,0.0210541,4408.78,7.2343,2.6361,1.2632],
        [960.0,260.0,0.0214547,4461.53,7.2775,2.6383,1.2614],
        [980.0,260.0,0.0218528,4514.32,7.3199,2.6414,1.2596],
        [1020.0,260.0,0.0226425,4620.13,7.403,2.6493,1.2562],
        [1040.0,260.0,0.0230344,4673.16,7.4437,2.654,1.2546],
        [1060.0,260.0,0.0234244,4726.29,7.4839,2.6592,1.253],
        [1080.0,260.0,0.0238128,4779.53,7.5235,2.6647,1.2514],
        [1100.0,260.0,0.0241996,4832.88,7.5627,2.6706,1.2498],
        [1120.0,260.0,0.024585,4886.35,7.6013,2.6767,1.2483],
        [1140.0,260.0,0.024969,4939.95,7.6395,2.683,1.2469],
        [1160.0,260.0,0.0253516,4993.68,7.6773,2.6895,1.2454],
        [1180.0,260.0,0.0257331,5047.53,7.7146,2.6962,1.244],
        [1200.0,260.0,0.0261134,5101.52,7.7515,2.703,1.2427],
        [1220.0,260.0,0.0264926,5155.65,7.788,2.7099,1.2413],
        [1240.0,260.0,0.0268708,5209.92,7.8241,2.7168,1.24],
        [1260.0,260.0,0.027248,5264.33,7.8598,2.7239,1.2387],
        [1280.0,260.0,0.0276243,5318.87,7.8952,2.7309,1.2375],
        [1300.0,260.0,0.0279997,5373.56,7.9301,2.738,1.2363],
        [1320.0,260.0,0.0283744,5428.39,7.9648,2.7451,1.2351],
        [1340.0,260.0,0.0287482,5483.37,7.9991,2.7522,1.2339],
        [1360.0,260.0,0.0291213,5538.48,8.033,2.7592,1.2328],
        [1380.0,260.0,0.0294938,5593.73,8.0667,2.7663,1.2317],
        [1400.0,260.0,0.0298655,5649.13,8.1,2.7733,1.2306],
        [1420.0,260.0,0.0302366,5704.67,8.133,2.7803,1.2296],
        [1440.0,260.0,0.0306072,5760.34,8.1656,2.7872,1.2285],
        [1460.0,260.0,0.0309771,5816.15,8.198,2.7941,1.2275],
        [1480.0,260.0,0.0313466,5872.1,8.2301,2.8009,1.2265],
        [1500.0,260.0,0.0317154,5928.19,8.2619,2.8076,1.2256],
        [1550.0,260.0,0.0326356,6068.99,8.3403,2.8243,1.2233],
        [1600.0,260.0,0.033553,6210.61,8.4169,2.8405,1.2211],
        [1650.0,260.0,0.0344679,6353.03,8.4919,2.8563,1.219],
        [1700.0,260.0,0.0353806,6496.23,8.5654,2.8716,1.217],
        [1750.0,260.0,0.0362914,6640.19,8.6375,2.8866,1.2152],
        [1800.0,260.0,0.0372003,6784.88,8.7081,2.9012,1.2134],
        [1850.0,260.0,0.0381077,6930.3,8.7774,2.9155,1.2117],
        [1900.0,260.0,0.0390136,7076.43,8.8455,2.9296,1.21],
        [1950.0,260.0,0.0399182,7223.26,8.9123,2.9434,1.2084],
        [2000.0,260.0,0.0408215,7370.77,8.9779,2.957,1.2069],



        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_280_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,280.0,0.0168046,4029.74,6.8693,2.6808,1.2811],
        [820.0,280.0,0.0172043,4083.29,6.9187,2.6719,1.2781],
        [840.0,280.0,0.0175991,4136.65,6.967,2.6641,1.276],
        [860.0,280.0,0.0179898,4189.87,7.0144,2.6586,1.2739],
        [880.0,280.0,0.0183769,4243.01,7.0609,2.6548,1.2719],
        [900.0,280.0,0.0187606,4296.08,7.1065,2.6526,1.2699],
        [920.0,280.0,0.0191412,4349.12,7.1514,2.6517,1.2679],
        [940.0,280.0,0.0195189,4402.15,7.1955,2.652,1.2661],
        [960.0,280.0,0.019894,4455.2,7.2388,2.6532,1.2642],
        [980.0,280.0,0.0202667,4508.29,7.2815,2.6554,1.2624],
        [1020.0,280.0,0.0210056,4614.62,7.3651,2.6618,1.2589],
        [1040.0,280.0,0.021372,4667.9,7.4059,2.6659,1.2572],
        [1060.0,280.0,0.0217367,4721.26,7.4463,2.6704,1.2555],
        [1080.0,280.0,0.0220996,4774.72,7.4861,2.6754,1.2539],
        [1100.0,280.0,0.022461,4828.28,7.5254,2.6807,1.2523],
        [1120.0,280.0,0.022821,4881.95,7.5642,2.6863,1.2508],
        [1140.0,280.0,0.0231795,4935.73,7.6025,2.6922,1.2493],
        [1160.0,280.0,0.0235367,4989.63,7.6404,2.6983,1.2478],
        [1180.0,280.0,0.0238928,5043.66,7.6778,2.7045,1.2464],
        [1200.0,280.0,0.0242476,5097.82,7.7148,2.7109,1.245],
        [1220.0,280.0,0.0246014,5152.1,7.7514,2.7175,1.2436],
        [1240.0,280.0,0.0249542,5206.52,7.7876,2.7241,1.2423],
        [1260.0,280.0,0.025306,5261.07,7.8234,2.7308,1.241],
        [1280.0,280.0,0.0256569,5315.75,7.8589,2.7376,1.2397],
        [1300.0,280.0,0.0260069,5370.57,7.8939,2.7444,1.2385],
        [1320.0,280.0,0.0263562,5425.53,7.9287,2.7512,1.2372],
        [1340.0,280.0,0.0267046,5480.62,7.963,2.7581,1.2361],
        [1360.0,280.0,0.0270523,5535.85,7.9971,2.7649,1.2349],
        [1380.0,280.0,0.0273993,5591.22,8.0307,2.7717,1.2338],
        [1400.0,280.0,0.0277457,5646.72,8.0641,2.7785,1.2327],
        [1420.0,280.0,0.0280914,5702.36,8.0972,2.7853,1.2316],
        [1440.0,280.0,0.0284366,5758.13,8.1299,2.7921,1.2305],
        [1460.0,280.0,0.0287811,5814.04,8.1624,2.7988,1.2295],
        [1480.0,280.0,0.0291251,5870.08,8.1945,2.8054,1.2285],
        [1500.0,280.0,0.0294686,5926.26,8.2264,2.812,1.2275],
        [1550.0,280.0,0.0303253,6067.26,8.3048,2.8283,1.2252],
        [1600.0,280.0,0.0311792,6209.08,8.3815,2.8442,1.223],
        [1650.0,280.0,0.0320307,6351.67,8.4567,2.8597,1.2208],
        [1700.0,280.0,0.0328799,6495.03,8.5303,2.8748,1.2188],
        [1750.0,280.0,0.0337272,6639.14,8.6024,2.8895,1.2169],
        [1800.0,280.0,0.0345727,6783.98,8.6731,2.9039,1.2151],
        [1850.0,280.0,0.0354167,6929.53,8.7425,2.918,1.2134],
        [1900.0,280.0,0.0362591,7075.78,8.8106,2.9318,1.2117],
        [1950.0,280.0,0.0371002,7222.71,8.8774,2.9455,1.2101],
        [2000.0,280.0,0.0379402,7370.32,8.9431,2.959,1.2085],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

#[test]
pub fn single_phase_table_300_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,300.0,0.0156288,4020.23,6.8303,2.7072,1.2848],
        [820.0,300.0,0.0160064,4074.31,6.8801,2.6964,1.2816],
        [840.0,300.0,0.0163792,4128.14,6.9289,2.6868,1.2793],
        [860.0,300.0,0.016748,4181.8,6.9767,2.6795,1.2772],
        [880.0,300.0,0.017113,4235.33,7.0235,2.6743,1.275],
        [900.0,300.0,0.0174747,4288.78,7.0695,2.6707,1.273],
        [920.0,300.0,0.0178332,4342.17,7.1146,2.6686,1.271],
        [940.0,300.0,0.0181889,4395.53,7.1589,2.6679,1.269],
        [960.0,300.0,0.018542,4448.89,7.2026,2.6682,1.2671],
        [980.0,300.0,0.0188926,4502.27,7.2455,2.6694,1.2652],
        [1020.0,300.0,0.0195874,4609.13,7.3294,2.6743,1.2616],
        [1040.0,300.0,0.0199318,4662.65,7.3705,2.6777,1.2598],
        [1060.0,300.0,0.0202744,4716.24,7.411,2.6816,1.2581],
        [1080.0,300.0,0.0206153,4769.92,7.451,2.686,1.2565],
        [1100.0,300.0,0.0209546,4823.68,7.4904,2.6908,1.2548],
        [1120.0,300.0,0.0212925,4877.55,7.5294,2.6959,1.2533],
        [1140.0,300.0,0.021629,4931.52,7.5678,2.7013,1.2517],
        [1160.0,300.0,0.0219642,4985.61,7.6058,2.707,1.2502],
        [1180.0,300.0,0.0222982,5039.8,7.6434,2.7129,1.2487],
        [1200.0,300.0,0.022631,5094.12,7.6805,2.7189,1.2473],
        [1220.0,300.0,0.0229627,5148.56,7.7172,2.7251,1.2459],
        [1240.0,300.0,0.0232935,5203.13,7.7535,2.7314,1.2446],
        [1260.0,300.0,0.0236233,5257.82,7.7894,2.7378,1.2432],
        [1280.0,300.0,0.0239521,5312.64,7.825,2.7443,1.2419],
        [1300.0,300.0,0.0242801,5367.59,7.8601,2.7508,1.2407],
        [1320.0,300.0,0.0246073,5422.67,7.8949,2.7574,1.2394],
        [1340.0,300.0,0.0249337,5477.88,7.9293,2.764,1.2382],
        [1360.0,300.0,0.0252594,5533.23,7.9634,2.7706,1.237],
        [1380.0,300.0,0.0255844,5588.71,7.9972,2.7772,1.2359],
        [1400.0,300.0,0.0259088,5644.32,8.0306,2.7838,1.2348],
        [1420.0,300.0,0.0262325,5700.06,8.0638,2.7904,1.2337],
        [1440.0,300.0,0.0265556,5755.93,8.0966,2.7969,1.2326],
        [1460.0,300.0,0.0268781,5811.94,8.1291,2.8034,1.2315],
        [1480.0,300.0,0.0272001,5868.07,8.1613,2.8099,1.2305],
        [1500.0,300.0,0.0275216,5924.33,8.1932,2.8164,1.2295],
        [1550.0,300.0,0.0283232,6065.55,8.2717,2.8323,1.2271],
        [1600.0,300.0,0.0291221,6207.55,8.3486,2.8478,1.2248],
        [1650.0,300.0,0.0299186,6350.33,8.4238,2.863,1.2227],
        [1700.0,300.0,0.0307128,6493.85,8.4975,2.8779,1.2206],
        [1750.0,300.0,0.0315051,6638.11,8.5697,2.8924,1.2187],
        [1800.0,300.0,0.0322956,6783.08,8.6404,2.9066,1.2168],
        [1850.0,300.0,0.0330846,6928.76,8.7099,2.9205,1.215],
        [1900.0,300.0,0.033872,7075.12,8.778,2.9341,1.2133],
        [1950.0,300.0,0.0346582,7222.17,8.8449,2.9476,1.2117],
        [2000.0,300.0,0.0354431,7369.88,8.9106,2.961,1.2101],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_400_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,400.0,0.0115229,3972.81,6.6614,2.8428,1.3059],
        [820.0,400.0,0.0118223,4029.55,6.7137,2.821,1.3016],
        [840.0,400.0,0.0121179,4085.77,6.7647,2.8015,1.2986],
        [860.0,400.0,0.0124093,4141.63,6.8144,2.7855,1.2957],
        [880.0,400.0,0.012697,4197.2,6.863,2.7725,1.2929],
        [900.0,400.0,0.0129812,4252.55,6.9106,2.762,1.2902],
        [920.0,400.0,0.0132623,4307.7,6.9572,2.7538,1.2877],
        [940.0,400.0,0.0135406,4362.71,7.003,2.7475,1.2852],
        [960.0,400.0,0.0138162,4417.61,7.0478,2.7429,1.2829],
        [980.0,400.0,0.0140894,4472.44,7.0919,2.7396,1.2806],
        [1020.0,400.0,0.0146292,4581.95,7.178,2.7366,1.2762],
        [1040.0,400.0,0.0148962,4636.68,7.22,2.7366,1.2742],
        [1060.0,400.0,0.0151614,4691.42,7.2613,2.7374,1.2721],
        [1080.0,400.0,0.0154249,4746.18,7.3021,2.7389,1.2702],
        [1100.0,400.0,0.0156869,4800.98,7.3423,2.741,1.2683],
        [1120.0,400.0,0.0159474,4855.82,7.382,2.7437,1.2665],
        [1140.0,400.0,0.0162065,4910.73,7.4211,2.7468,1.2647],
        [1160.0,400.0,0.0164644,4965.7,7.4597,2.7503,1.263],
        [1180.0,400.0,0.0167211,5020.74,7.4979,2.7542,1.2613],
        [1200.0,400.0,0.0169766,5075.87,7.5355,2.7584,1.2597],
        [1220.0,400.0,0.0172311,5131.08,7.5728,2.7628,1.2581],
        [1240.0,400.0,0.0174846,5186.38,7.6096,2.7675,1.2565],
        [1260.0,400.0,0.0177371,5241.78,7.6459,2.7724,1.255],
        [1280.0,400.0,0.0179887,5297.28,7.6819,2.7774,1.2536],
        [1300.0,400.0,0.0182395,5352.88,7.7175,2.7826,1.2521],
        [1320.0,400.0,0.0184895,5408.58,7.7526,2.7879,1.2508],
        [1340.0,400.0,0.0187387,5464.39,7.7875,2.7932,1.2494],
        [1360.0,400.0,0.0189872,5520.31,7.8219,2.7987,1.2481],
        [1380.0,400.0,0.019235,5576.34,7.856,2.8042,1.2468],
        [1400.0,400.0,0.0194822,5632.48,7.8898,2.8098,1.2455],
        [1420.0,400.0,0.0197287,5688.73,7.9232,2.8154,1.2443],
        [1440.0,400.0,0.0199747,5745.1,7.9563,2.821,1.2431],
        [1460.0,400.0,0.0202201,5801.57,7.9891,2.8267,1.242],
        [1480.0,400.0,0.020465,5858.16,8.0215,2.8323,1.2408],
        [1500.0,400.0,0.0207094,5914.87,8.0537,2.838,1.2397],
        [1550.0,400.0,0.0213182,6057.12,8.1328,2.852,1.237],
        [1600.0,400.0,0.0219244,6200.07,8.2101,2.866,1.2345],
        [1650.0,400.0,0.0225282,6343.71,8.2858,2.8797,1.2321],
        [1700.0,400.0,0.0231298,6488.04,8.3599,2.8933,1.2299],
        [1750.0,400.0,0.0237294,6633.03,8.4325,2.9066,1.2277],
        [1800.0,400.0,0.0243274,6778.69,8.5036,2.9197,1.2256],
        [1850.0,400.0,0.0249237,6925.0,8.5733,2.9327,1.2237],
        [1900.0,400.0,0.0255186,7071.96,8.6417,2.9455,1.2218],
        [1950.0,400.0,0.0261123,7219.55,8.7089,2.9582,1.2199],
        [2000.0,400.0,0.0267047,7367.77,8.7748,2.9708,1.2182],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

#[test]
pub fn single_phase_table_500_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![

        [800.0,500.0,0.00907413,3925.96,6.5226,2.9813,1.3319],
        [820.0,500.0,0.00932613,3985.35,6.5774,2.9475,1.3268],
        [840.0,500.0,0.0095746,4043.99,6.6306,2.9174,1.3224],
        [860.0,500.0,0.00981891,4102.08,6.6823,2.8921,1.3184],
        [880.0,500.0,0.0100595,4159.7,6.7327,2.8709,1.3145],
        [900.0,500.0,0.0102966,4216.94,6.7819,2.8533,1.311],
        [920.0,500.0,0.0105307,4273.85,6.83,2.8387,1.3076],
        [940.0,500.0,0.0107619,4330.51,6.8771,2.8267,1.3043],
        [960.0,500.0,0.0109905,4386.94,6.9232,2.817,1.3013],
        [980.0,500.0,0.0112167,4443.2,6.9685,2.8091,1.2984],
        [1020.0,500.0,0.0116628,4555.32,7.0566,2.7982,1.2929],
        [1040.0,500.0,0.0118829,4611.25,7.0995,2.7947,1.2904],
        [1060.0,500.0,0.0121012,4667.12,7.1417,2.7924,1.2879],
        [1080.0,500.0,0.012318,4722.95,7.1833,2.791,1.2856],
        [1100.0,500.0,0.0125332,4778.77,7.2242,2.7904,1.2833],
        [1120.0,500.0,0.012747,4834.57,7.2646,2.7906,1.2811],
        [1140.0,500.0,0.0129594,4890.39,7.3044,2.7915,1.279],
        [1160.0,500.0,0.0131706,4946.24,7.3436,2.7929,1.277],
        [1180.0,500.0,0.0133807,5002.11,7.3823,2.7948,1.275],
        [1200.0,500.0,0.0135896,5058.03,7.4205,2.7971,1.2731],
        [1220.0,500.0,0.0137975,5114.0,7.4583,2.7999,1.2713],
        [1240.0,500.0,0.0140044,5170.03,7.4956,2.8029,1.2695],
        [1260.0,500.0,0.0142103,5226.12,7.5324,2.8063,1.2678],
        [1280.0,500.0,0.0144154,5282.28,7.5688,2.8099,1.2661],
        [1300.0,500.0,0.0146197,5338.52,7.6047,2.8137,1.2645],
        [1320.0,500.0,0.0148232,5394.83,7.6403,2.8178,1.2629],
        [1340.0,500.0,0.015026,5451.23,7.6755,2.822,1.2613],
        [1360.0,500.0,0.015228,5507.71,7.7103,2.8263,1.2598],
        [1380.0,500.0,0.0154294,5564.28,7.7447,2.8308,1.2584],
        [1400.0,500.0,0.0156301,5620.94,7.7788,2.8353,1.257],
        [1420.0,500.0,0.0158303,5677.7,7.8125,2.84,1.2556],
        [1440.0,500.0,0.0160298,5734.54,7.8459,2.8447,1.2542],
        [1460.0,500.0,0.0162288,5791.48,7.8789,2.8495,1.2529],
        [1480.0,500.0,0.0164273,5848.52,7.9117,2.8543,1.2516],
        [1500.0,500.0,0.0166253,5905.66,7.9441,2.8592,1.2504],
        [1550.0,500.0,0.0171183,6048.92,8.0237,2.8715,1.2474],
        [1600.0,500.0,0.0176086,6192.8,8.1016,2.8838,1.2446],
        [1650.0,500.0,0.0180966,6337.3,8.1777,2.8961,1.2419],
        [1700.0,500.0,0.0185824,6482.42,8.2522,2.9084,1.2394],
        [1750.0,500.0,0.0190664,6628.14,8.3252,2.9206,1.237],
        [1800.0,500.0,0.0195486,6774.47,8.3966,2.9327,1.2347],
        [1850.0,500.0,0.0200293,6921.41,8.4666,2.9447,1.2325],
        [1900.0,500.0,0.0205086,7068.94,8.5353,2.9567,1.2304],
        [1950.0,500.0,0.0209866,7217.07,8.6027,2.9686,1.2284],
        [2000.0,500.0,0.0214634,7365.8,8.6689,2.9805,1.2265],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

fn assert_pt_flash_high_temp(
    t_deg_c: f64,
    p_bar: f64,
    v_m3_per_kg: f64,
    h_kj_per_kg: f64,
    s_kj_per_kg_k: f64,
    cp_kj_per_kg_k: f64,
    kappa_dimensionless: f64,
){
    let p = Pressure::new::<bar>(p_bar);
    let t = ThermodynamicTemperature::new::<degree_celsius>(t_deg_c);
    let h_ref = AvailableEnergy::new::<kilojoule_per_kilogram>(h_kj_per_kg);
    // check if t is less than or equal to tsat 
    
    let t_sat = sat_temp_4(p);
    let fifty_kelvin = TemperatureInterval::new::<temperature_interval::kelvin>(50.0);
    
    let x: f64;
    
    if t > t_sat + fifty_kelvin {
        x = 1.0;
    } else {
        x = x_ph_flash(p, h_ref);
    };


    // assert h
    let h_test = h_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        h_kj_per_kg,
        h_test.get::<kilojoule_per_kilogram>(),
        max_relative=2e-4
        );

    // assert volume to within 0.01%  (that's the tolerable error for 
    // backward eqn)
    let v_test = v_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        v_m3_per_kg,
        v_test.get::<cubic_meter_per_kilogram>(),
        max_relative=2e-4
        );

    // now entropy 
    let s_test = s_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        s_kj_per_kg_k,
        s_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=1e-3
        );

    // cp 
    let cp_test = cp_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        cp_kj_per_kg_k,
        cp_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=1e-3
        );

    // kappa
    let kappa_test = kappa_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        kappa_dimensionless,
        kappa_test.get::<ratio>(),
        max_relative=9e-3
        );

    // eta and lambda tbd



}




