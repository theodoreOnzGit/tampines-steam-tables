use uom::si::{available_energy::kilojoule_per_kilogram, pressure::megapascal};
use uom::si::pressure::bar;
use uom::si::f64::*;
use uom::si::ratio::ratio;
use uom::si::specific_heat_capacity::kilojoule_per_kilogram_kelvin;
use uom::si::specific_volume::cubic_meter_per_kilogram;
use uom::si::thermodynamic_temperature::degree_celsius;
use uom::si::velocity::meter_per_second;

use crate::interfaces::functional_programming::{ph_flash_eqm::x_ph_flash, pt_flash_eqm::{cp_tp_eqm_two_phase, h_tp_eqm_two_phase, kappa_tp_eqm_two_phase, s_tp_eqm_two_phase, v_tp_eqm_two_phase, w_tp_eqm_two_phase}};

/// single phase table (see page 201)
///
/// NOTE: ph flash UNABLE to do triple point liquid and vapour accurately.
/// or even close to 0 degc
#[test]
pub fn single_phase_table_2_to_750_degc_20_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[20.000,0.000,0.000999193,1.99229,-0.00002608,4.21,1405.40000,988.40000,1787.50000,557.09000],
        [20.000,2.000,0.000999107,10.4062,0.030665,4.2041,1415.20000,1002.30000,1670.00000,562.05000],
        [20.000,4.000,0.000999088,18.8091,0.061094,4.199,1424.60000,1015.70000,1564.30000,566.81000],
        [20.000,6.000,0.000999132,27.2029,0.091271,4.1948,1433.70000,1028.60000,1469.00000,571.38000],
        [20.000,8.000,0.000999235,35.589,0.12121,4.1913,1442.30000,1040.90000,1382.70000,575.78000],
        [20.000,10.000,0.000999394,43.9685,0.1509,4.1883,1450.60000,1052.70000,1304.20000,580.01000],
        [20.000,12.000,0.000999605,52.3425,0.18038,4.1858,1458.40000,1063.90000,1232.60000,584.10000],
        [20.000,14.000,0.000999866,60.7118,0.20962,4.1836,1466.00000,1074.70000,1167.20000,588.04000],
        [20.000,16.000,0.00100018,69.0772,0.23865,4.1818,1473.10000,1084.90000,1107.20000,591.86000],
        [20.000,18.000,0.00100053,77.4392,0.26747,4.1802,1479.90000,1094.50000,1051.90000,595.55000],
        [20.000,20.000,0.00100093,85.7984,0.29609,4.1789,1486.40000,1103.70000,1001.00000,599.12000],
        [20.000,25.000,0.0010021,106.686,0.36674,4.1764,1501.20000,1124.40000,889.76000,607.59000],
        [20.000,30.000,0.00100352,127.564,0.43618,4.1749,1514.00000,1142.10000,797.19000,615.44000],
        [20.000,35.000,0.00100515,148.437,0.50447,4.1741,1525.00000,1156.90000,719.25000,622.73000],
        [20.000,40.000,0.001007,169.306,0.57166,4.1739,1534.40000,1169.00000,652.97000,629.50000],
        [20.000,45.000,0.00100903,190.177,0.63778,4.1743,1542.20000,1178.50000,596.10000,635.79000],
        [20.000,50.000,0.00101125,211.05,0.70287,4.1752,1548.50000,1185.60000,546.90000,641.62000],
        [20.000,55.000,0.00101365,231.929,0.76699,4.1766,1553.40000,1190.30000,504.06000,647.02000],
        [20.000,60.000,0.00101622,252.817,0.83016,4.1786,1557.10000,1193.00000,466.50000,652.01000],
        [20.000,65.000,0.00101896,273.716,0.89243,4.181,1559.60000,1193.60000,433.39000,656.59000],
        [20.000,70.000,0.00102185,294.628,0.95382,4.184,1561.00000,1192.30000,404.05000,660.78000],
        [20.000,75.000,0.00102491,315.556,1.0144,4.1874,1561.30000,1189.20000,377.93000,664.59000],
        [20.000,80.000,0.00102812,336.503,1.0741,4.1914,1560.60000,1184.40000,354.57000,668.03000],
        [20.000,85.000,0.00103148,357.471,1.1331,4.1958,1559.00000,1178.10000,333.59000,671.11000],
        [20.000,90.000,0.001035,378.462,1.1913,4.2008,1556.50000,1170.30000,314.69000,673.84000],
        [20.000,95.000,0.00103867,399.479,1.2487,4.2063,1553.10000,1161.20000,297.60000,676.24000],
        [20.000,100.000,0.00104249,420.526,1.3055,4.2123,1549.00000,1150.80000,282.10000,678.29000],
        [20.000,110.000,0.00105059,462.715,1.4171,4.2259,1538.40000,1126.40000,255.11000,681.44000],
        [20.000,120.000,0.00105932,505.051,1.5262,4.2418,1525.10000,1097.80000,232.51000,683.33000],
        [20.000,130.000,0.00106869,547.559,1.6329,4.2601,1509.20000,1065.60000,213.39000,684.04000],
        [20.000,140.000,0.00107873,590.263,1.7376,4.2812,1490.80000,1030.10000,197.06000,683.59000],
        [20.000,150.000,0.00108948,633.193,1.8403,4.3053,1470.10000,991.86000,183.00000,682.05000],
        [20.000,160.000,0.00110099,676.382,1.9411,4.333,1447.20000,951.08000,170.78000,679.66000],
        [20.000,170.000,0.00111332,719.867,2.0404,4.3647,1422.00000,908.11000,160.08000,676.39000],
        [20.000,180.000,0.00112654,763.691,2.1382,4.4011,1394.60000,863.22000,150.64000,672.04000],
        [20.000,190.000,0.00114075,807.906,2.2347,4.443,1365.00000,816.67000,142.23000,666.70000],
        [20.000,200.000,0.00115606,852.572,2.3301,4.4914,1333.20000,768.70000,134.70000,660.40000],
        [20.000,210.000,0.0011726,897.76,2.4246,4.5476,1299.00000,719.55000,127.89000,653.16000],
        [20.000,212.385,0.00117675,908.622,2.447,4.5623,1290.60000,707.68000,126.36000,651.29000],
        [20.000,212.385,0.0995805,2798.38,6.3392,3.1904,504.66000,1.27880,16.09100,40.93600],
        [20.000,220.000,0.102167,2821.67,6.3868,2.9487,512.58000,1.28580,16.45400,41.31300],
        [20.000,230.000,0.105394,2850.17,6.444,2.7665,521.47000,1.29010,16.92400,41.87400],
        [20.000,240.000,0.108488,2877.21,6.4972,2.6481,529.47000,1.29200,17.38800,42.49200],
        [20.000,250.000,0.111484,2903.23,6.5474,2.5602,536.96000,1.29310,17.84800,43.15800],
        [20.000,260.000,0.1144,2928.47,6.5952,2.4909,544.07000,1.29380,18.30300,43.86600],
        [20.000,270.000,0.117251,2953.09,6.641,2.4349,550.89000,1.29410,18.75500,44.61200],
        [20.000,280.000,0.120046,2977.21,6.685,2.389,557.44000,1.29430,19.20300,45.39300],
        [20.000,290.000,0.122794,3000.9,6.7274,2.3512,563.78000,1.29420,19.64900,46.20600],
        [20.000,300.000,0.125501,3024.25,6.7685,2.3201,569.91000,1.29400,20.09200,47.04800],
        [20.000,310.000,0.128174,3047.32,6.8084,2.2944,575.87000,1.29370,20.53300,47.91900],
        [20.000,320.000,0.130816,3070.16,6.8472,2.2733,581.67000,1.29320,20.97100,48.81500],
        [20.000,330.000,0.133431,3092.8,6.8851,2.2559,587.33000,1.29260,21.40800,49.73600],
        [20.000,340.000,0.136023,3115.28,6.9221,2.2417,592.86000,1.29200,21.84200,50.68100],
        [20.000,350.000,0.138594,3137.64,6.9582,2.2301,598.27000,1.29130,22.27500,51.64700],
        [20.000,360.000,0.141147,3159.89,6.9937,2.2207,603.57000,1.29050,22.70600,52.63300],
        [20.000,370.000,0.143683,3182.06,7.0284,2.2133,608.77000,1.28970,23.13600,53.63900],
        [20.000,380.000,0.146205,3204.16,7.0625,2.2074,613.88000,1.28880,23.56400,54.66400],
        [20.000,390.000,0.148712,3226.21,7.096,2.203,618.91000,1.28790,23.99100,55.70600],
        [20.000,400.000,0.151208,3248.23,7.129,2.1997,623.85000,1.28690,24.41700,56.76500],
        [20.000,410.000,0.153693,3270.21,7.1614,2.1974,628.72000,1.28600,24.84100,57.84000],
        [20.000,420.000,0.156167,3292.18,7.1933,2.1961,633.52000,1.28500,25.26400,58.93100],
        [20.000,430.000,0.158632,3314.14,7.2248,2.1955,638.25000,1.28400,25.68600,60.03600],
        [20.000,440.000,0.161088,3336.09,7.2558,2.1957,642.92000,1.28300,26.10600,61.15400],
        [20.000,450.000,0.163537,3358.05,7.2863,2.1964,647.52000,1.28190,26.52500,62.28600],
        [20.000,460.000,0.165978,3380.02,7.3165,2.1976,652.08000,1.28090,26.94400,63.43100],
        [20.000,470.000,0.168413,3402.01,7.3463,2.1994,656.57000,1.27990,27.36100,64.58800],
        [20.000,480.000,0.170841,3424.01,7.3757,2.2015,661.02000,1.27880,27.77600,65.75700],
        [20.000,490.000,0.173263,3446.04,7.4048,2.2041,665.41000,1.27770,28.19100,66.93700],
        [20.000,500.000,0.17568,3468.09,7.4335,2.2069,669.76000,1.27670,28.60500,68.12700],
        [20.000,510.000,0.178092,3490.18,7.4619,2.2101,674.06000,1.27560,29.01700,69.32800],
        [20.000,520.000,0.180499,3512.3,7.4899,2.2136,678.32000,1.27460,29.42900,70.53900],
        [20.000,530.000,0.182902,3534.45,7.5177,2.2173,682.54000,1.27350,29.83900,71.75900],
        [20.000,540.000,0.1853,3556.64,7.5451,2.2212,686.71000,1.27250,30.24900,72.98800],
        [20.000,550.000,0.187694,3578.88,7.5723,2.2254,690.85000,1.27140,30.65700,74.22600],
        [20.000,560.000,0.190085,3601.15,7.5992,2.2297,694.95000,1.27040,31.06400,75.47300],
        [20.000,570.000,0.192472,3623.47,7.6258,2.2342,699.01000,1.26930,31.47000,76.72800],
        [20.000,580.000,0.194856,3645.84,7.6522,2.2389,703.04000,1.26830,31.87500,77.99000],
        [20.000,590.000,0.197237,3668.25,7.6783,2.2437,707.03000,1.26720,32.27900,79.26000],
        [20.000,600.000,0.199614,3690.71,7.7042,2.2486,710.99000,1.26620,32.68200,80.53800],
        [20.000,650.000,0.211464,3803.79,7.8301,2.275,730.32000,1.26110,34.68100,87.02500],
        [20.000,700.000,0.22326,3918.24,7.9509,2.3035,748.96000,1.25620,36.65300,93.66000],
        [20.000,750.000,0.235015,4034.16,8.067,2.3333,766.98000,1.25150,38.60000,100.42000],
        //[20.000,800.000,0.246737,4151.59,8.1791,2.3642,784.44000,1.24700,40.52000,107.29000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_750_degc_40_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![

        //[40.000,0.000,0.000998184,4.02062,0.00008726,4.2003,1408.6000,496.9200,1783.2000,558.6000],
        [40.000,2.000,0.000998113,12.4157,0.03071,4.1949,1418.4000,503.9000,1666.3000,563.5100],
        [40.000,4.000,0.000998107,20.8009,0.061075,4.1904,1427.8000,510.6200,1561.3000,568.2200],
        [40.000,6.000,0.000998163,29.1779,0.091192,4.1867,1436.8000,517.0700,1466.5000,572.7500],
        [40.000,8.000,0.000998277,37.5481,0.12107,4.1835,1445.5000,523.2500,1380.6000,577.1000],
        [40.000,10.000,0.000998446,45.9125,0.15071,4.1809,1453.7000,529.1600,1302.4000,581.3000],
        [40.000,12.000,0.000998666,54.272,0.18013,4.1787,1461.6000,534.7900,1231.2000,585.3600],
        [40.000,14.000,0.000998936,62.6275,0.20933,4.1768,1469.1000,540.1700,1166.0000,589.2800],
        [40.000,16.000,0.000999252,70.9796,0.23832,4.1753,1476.3000,545.2800,1106.2000,593.0700],
        [40.000,18.000,0.000999613,79.3288,0.26709,4.1739,1483.1000,550.1300,1051.2000,596.7400],
        [40.000,20.000,0.00100002,87.6755,0.29566,4.1728,1489.6000,554.7200,1000.4000,600.2900],
        [40.000,25.000,0.0010012,108.534,0.36622,4.1708,1504.4000,565.1000,889.5100,608.7100],
        [40.000,30.000,0.00100263,129.385,0.43557,4.1696,1517.2000,573.9700,797.1600,616.5300],
        [40.000,35.000,0.00100427,150.231,0.50378,4.169,1528.2000,581.4000,719.3900,623.7900],
        [40.000,40.000,0.00100611,171.076,0.57088,4.1691,1537.6000,587.4800,653.2300,630.5500],
        [40.000,45.000,0.00100815,191.923,0.63692,4.1696,1545.4000,592.2700,596.4400,636.8300],
        [40.000,50.000,0.00101037,212.773,0.70195,4.1706,1551.8000,595.8400,547.3100,642.6600],
        [40.000,55.000,0.00101276,233.63,0.766,4.1722,1556.8000,598.2800,504.5100,648.0600],
        [40.000,55.000,0.00101276,233.63,0.766,4.1722,1556.8000,598.2800,504.5100,648.0600],
        [40.000,65.000,0.00101806,275.372,0.8913,4.1767,1563.1000,599.9800,433.8900,657.6300],
        [40.000,70.000,0.00102094,296.263,0.95263,4.1796,1564.5000,599.3800,404.5700,661.8200],
        [40.000,75.000,0.00102398,317.169,1.0131,4.1831,1564.9000,597.9000,378.4600,665.6400],
        [40.000,80.000,0.00102718,338.095,1.0728,4.1871,1564.3000,595.5700,355.1000,669.1000],
        [40.000,85.000,0.00103053,359.041,1.1317,4.1915,1562.8000,592.4700,334.1300,672.1900],
        [40.000,90.000,0.00103403,380.01,1.1898,4.1964,1560.3000,588.6400,315.2300,674.9400],
        [40.000,95.000,0.00103768,401.006,1.2473,4.2018,1557.1000,584.1200,298.1400,677.3500],
        [40.000,100.000,0.00104148,422.029,1.304,4.2078,1553.0000,578.9700,282.6400,679.4200],
        [40.000,110.000,0.00104953,464.172,1.4154,4.2212,1542.7000,566.9100,255.6400,682.6000],
        [40.000,110.000,0.00104953,464.172,1.4154,4.2212,1542.7000,566.9100,255.6400,682.6000],
        [40.000,130.000,0.00106751,548.916,1.631,4.2548,1513.9000,536.7600,213.9100,685.2900],
        [40.000,140.000,0.00107748,591.564,1.7355,4.2754,1495.9000,519.1700,197.5800,684.9000],
        [40.000,150.000,0.00108814,634.433,1.838,4.299,1475.5000,500.1700,183.5100,683.4000],
        [40.000,160.000,0.00109956,677.555,1.9388,4.326,1452.9000,479.9200,171.2900,681.0000],
        [40.000,170.000,0.00111177,720.966,2.0378,4.3569,1428.1000,458.5900,160.5800,677.8300],
        [40.000,180.000,0.00112486,764.707,2.1354,4.3923,1401.1000,436.3000,151.1400,673.5500],
        [40.000,190.000,0.00113892,808.829,2.2317,4.433,1372.0000,413.1800,142.7400,668.2800],
        [40.000,200.000,0.00115404,853.387,2.3269,4.4799,1340.6000,389.3500,135.2100,662.0600],
        [40.000,210.000,0.00117037,898.451,2.4212,4.5342,1307.1000,364.9300,128.4100,654.9000],
        [40.000,220.000,0.00118806,944.102,2.5147,4.5975,1271.2000,340.0300,122.2100,646.8200],
        [40.000,230.000,0.00120732,990.438,2.6077,4.6717,1232.9000,314.7600,116.5200,637.8100],
        [40.000,240.000,0.00122842,1037.58,2.7005,4.7595,1192.1000,289.2200,111.2400,627.8500],
        [40.000,250.000,0.00125169,1085.69,2.7933,4.8646,1148.5000,263.4500,106.3000,616.9000],
        [40.000,250.358,0.00125257,1087.43,2.7967,4.8688,1146.9000,262.5300,106.1200,616.5000],
        [40.000,250.358,0.0497766,2800.9,6.0697,4.0217,501.6400,1.2639,17.4430,50.4410],
        [40.000,260.000,0.051777,2837.19,6.1384,3.5536,513.7800,1.2746,17.9360,50.3430],
        [40.000,270.000,0.0536916,2871.2,6.2016,3.2702,524.2600,1.2797,18.4360,50.4590],
        [40.000,280.000,0.0554948,2902.88,6.2594,3.0774,533.5800,1.2826,18.9270,50.7220],
        [40.000,290.000,0.0572145,2932.91,6.3132,2.9332,542.1800,1.2844,19.4090,51.0980],
        [40.000,300.000,0.058868,2961.65,6.3638,2.8199,550.2300,1.2857,19.8850,51.5650],
        [40.000,310.000,0.0604671,2989.38,6.4118,2.7285,557.8500,1.2866,20.3550,52.1070],
        [40.000,320.000,0.0620211,3016.28,6.4575,2.6536,565.1000,1.2872,20.8200,52.7150],
        [40.000,330.000,0.0635367,3042.49,6.5014,2.5915,572.0400,1.2876,21.2800,53.3810],
        [40.000,340.000,0.0650195,3068.14,6.5435,2.5399,578.7100,1.2877,21.7360,54.0970],
        [40.000,350.000,0.066474,3093.32,6.5843,2.4967,585.1400,1.2877,22.1880,54.8590],
        [40.000,360.000,0.067904,3118.1,6.6237,2.4604,591.3500,1.2875,22.6370,55.6630],
        [40.000,370.000,0.0693123,3142.55,6.662,2.4299,597.3800,1.2871,23.0830,56.5050],
        [40.000,380.000,0.0707017,3166.71,6.6993,2.4042,603.2300,1.2867,23.5250,57.3810],
        [40.000,390.000,0.0720743,3190.64,6.7357,2.3825,608.9300,1.2862,23.9650,58.2890],
        [40.000,400.000,0.0734318,3214.37,6.7712,2.3642,614.4900,1.2855,24.4030,59.2270],
        [40.000,410.000,0.0747759,3237.94,6.8059,2.3488,619.9200,1.2849,24.8380,60.1930],
        [40.000,420.000,0.0761079,3261.36,6.84,2.3359,625.2400,1.2841,25.2710,61.1840],
        [40.000,430.000,0.077429,3284.66,6.8734,2.3251,630.4500,1.2833,25.7020,62.1990],
        [40.000,440.000,0.0787401,3307.87,6.9061,2.3162,635.5600,1.2825,26.1300,63.2370],
        [40.000,450.000,0.0800422,3330.99,6.9383,2.3088,640.5800,1.2816,26.5570,64.2950],
        [40.000,460.000,0.081336,3354.05,6.97,2.3027,645.5100,1.2807,26.9820,65.3740],
        [40.000,470.000,0.0826222,3377.05,7.0012,2.2979,650.3600,1.2798,27.4050,66.4710],
        [40.000,480.000,0.0839015,3400.01,7.0318,2.2941,655.1400,1.2789,27.8270,67.5860],
        [40.000,490.000,0.0851742,3422.94,7.0621,2.2913,659.8400,1.2780,28.2470,68.7170],
        [40.000,500.000,0.086441,3445.84,7.0919,2.2892,664.4800,1.2770,28.6660,69.8650],
        [40.000,510.000,0.0877022,3468.72,7.1213,2.2879,669.0600,1.2760,29.0820,71.0270],
        [40.000,520.000,0.0889583,3491.6,7.1503,2.2872,673.5800,1.2751,29.4980,72.2030],
        [40.000,530.000,0.0902096,3514.47,7.179,2.2871,678.0400,1.2741,29.9120,73.3930],
        [40.000,540.000,0.0914564,3537.34,7.2073,2.2875,682.4400,1.2731,30.3240,74.5960],
        [40.000,550.000,0.092699,3560.22,7.2353,2.2883,686.8000,1.2721,30.7360,75.8110],
        [40.000,560.000,0.0939376,3583.11,7.2629,2.2896,691.1000,1.2711,31.1450,77.0370],
        [40.000,570.000,0.0951726,3606.01,7.2902,2.2913,695.3600,1.2701,31.5540,78.2740],
        [40.000,580.000,0.0964041,3628.93,7.3172,2.2933,699.5800,1.2692,31.9610,79.5220],
        [40.000,590.000,0.0976323,3651.88,7.344,2.2956,703.7500,1.2682,32.3670,80.7800],
        [40.000,600.000,0.0988574,3674.85,7.3704,2.2982,707.8700,1.2672,32.7720,82.0470],
        [40.000,650.000,0.104943,3790.15,7.4989,2.3149,727.9400,1.2624,34.7770,88.5130],
        [40.000,700.000,0.110973,3906.41,7.6215,2.336,747.1700,1.2577,36.7520,95.1620],
        [40.000,750.000,0.116961,4023.8,7.7391,2.3601,765.6800,1.2531,38.6990,101.9600],
        //[40.000,800.000,0.122915,4142.46,7.8523,2.3865,783.5500,1.2487,40.6180,108.8800],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_750_degc_60_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[60.000,0.000,0.000997183,6.04286,0.0001856,4.1908,1411.80000,333.11000,1778.90000,560.09000],
        [60.000,2.000,0.000997126,14.4195,0.030741,4.186,1421.60000,337.78000,1662.80000,564.95000],
        [60.000,4.000,0.000997133,22.7873,0.061042,4.182,1431.00000,342.27000,1558.30000,569.61000],
        [60.000,6.000,0.000997201,31.1478,0.0911,4.1787,1440.00000,346.58000,1464.00000,574.10000],
        [60.000,8.000,0.000997326,39.5024,0.12092,4.1759,1448.70000,350.71000,1378.50000,578.42000],
        [60.000,10.000,0.000997504,47.8519,0.15051,4.1737,1456.90000,354.65000,1300.70000,582.59000],
        [60.000,12.000,0.000997733,56.1973,0.17988,4.1718,1464.80000,358.42000,1229.80000,586.61000],
        [60.000,14.000,0.000998011,64.5391,0.20904,4.1702,1472.30000,362.01000,1164.90000,590.50000],
        [60.000,16.000,0.000998335,72.8781,0.23798,4.1689,1479.50000,365.42000,1105.30000,594.27000],
        [60.000,18.000,0.000998702,81.2147,0.26671,4.1678,1486.30000,368.66000,1050.40000,597.91000],
        [60.000,20.000,0.000999112,89.5493,0.29524,4.1668,1492.80000,371.73000,999.86000,601.45000],
        [60.000,25.000,0.00100031,110.379,0.36569,4.1652,1507.60000,378.67000,889.26000,609.83000],
        [60.000,30.000,0.00100174,131.203,0.43496,4.1643,1520.40000,384.60000,797.14000,617.61000],
        [60.000,35.000,0.00100339,152.024,0.50308,4.1641,1531.50000,389.58000,719.54000,624.86000],
        [60.000,40.000,0.00100524,172.844,0.5701,4.1643,1540.90000,393.65000,653.49000,631.60000],
        [60.000,45.000,0.00100727,193.667,0.63607,4.165,1548.70000,396.87000,596.79000,637.87000],
        [60.000,50.000,0.00100949,214.495,0.70103,4.1661,1555.10000,399.28000,547.72000,643.69000],
        [60.000,55.000,0.00101188,235.329,0.76501,4.1678,1560.20000,400.93000,504.96000,649.09000],
        [60.000,60.000,0.00101444,256.173,0.82805,4.1698,1564.00000,401.87000,467.46000,654.07000],
        [60.000,65.000,0.00101716,277.028,0.89018,4.1724,1566.60000,402.13000,434.40000,658.66000],
        [60.000,70.000,0.00102004,297.898,0.95145,4.1754,1568.10000,401.76000,405.09000,662.87000],
        [60.000,75.000,0.00102307,318.783,1.0119,4.1788,1568.50000,400.81000,378.98000,666.70000],
        [60.000,80.000,0.00102625,339.687,1.0715,4.1828,1568.00000,399.29000,355.64000,670.16000],
        [60.000,85.000,0.00102958,360.612,1.1303,4.1872,1566.50000,397.26000,334.67000,673.27000],
        [60.000,90.000,0.00103307,381.559,1.1884,4.1921,1564.20000,394.74000,315.77000,676.04000],
        [60.000,95.000,0.0010367,402.533,1.2458,4.1974,1561.00000,391.77000,298.68000,678.46000],
        [60.000,100.000,0.00104048,423.535,1.3024,4.2033,1557.10000,388.37000,283.17000,680.55000],
        [60.000,110.000,0.00104849,465.632,1.4138,4.2165,1547.00000,380.41000,256.17000,683.77000],
        [60.000,120.000,0.0010571,507.871,1.5226,4.2318,1534.10000,371.05000,233.56000,685.75000],
        [60.000,130.000,0.00106635,550.276,1.6291,4.2495,1518.70000,360.47000,214.43000,686.54000],
        [60.000,140.000,0.00107624,592.869,1.7335,4.2697,1500.90000,348.83000,198.09000,686.19000],
        [60.000,150.000,0.00108682,635.679,1.8358,4.2927,1480.80000,336.25000,184.01000,684.75000],
        [60.000,160.000,0.00109814,678.735,1.9364,4.3191,1458.50000,322.85000,171.79000,682.26000],
        [60.000,170.000,0.00111024,722.073,2.0353,4.3492,1434.10000,308.72000,161.08000,679.26000],
        [60.000,180.000,0.00112321,765.733,2.1327,4.3837,1407.50000,293.96000,151.64000,675.05000],
        [60.000,190.000,0.00113711,809.763,2.2289,4.4232,1378.80000,278.65000,143.24000,669.85000],
        [60.000,200.000,0.00115205,854.217,2.3238,4.4687,1348.00000,262.87000,135.71000,663.71000],
        [60.000,210.000,0.00116817,899.16,2.4178,4.5213,1314.90000,246.69000,128.92000,656.64000],
        [60.000,220.000,0.00118561,944.671,2.511,4.5823,1279.70000,230.19000,122.73000,648.65000],
        [60.000,230.000,0.00120456,990.841,2.6037,4.6537,1242.00000,213.45000,117.05000,639.75000],
        [60.000,240.000,0.00122528,1037.79,2.6961,4.7378,1202.00000,196.52000,111.79000,629.91000],
        [60.000,250.000,0.00124808,1085.65,2.7885,4.8379,1159.30000,179.46000,106.86000,619.12000],
        [60.000,260.000,0.00127338,1134.61,2.8812,4.9589,1113.50000,162.29000,102.21000,607.32000],
        [60.000,270.000,0.00130177,1184.92,2.9747,5.1082,1064.20000,145.00000,97.74400,594.46000],
        [60.000,275.586,0.00131927,1213.73,3.0274,5.208,1034.80000,135.28000,95.31000,586.78000],
        [60.000,275.586,0.0324487,2784.56,5.8901,4.8768,494.01000,1.25350,18.44000,59.06500],
        [60.000,280.000,0.0331998,2805.25,5.9276,4.516,501.07000,1.26040,18.67700,58.55300],
        [60.000,290.000,0.0347631,2847.5,6.0033,3.9812,514.56000,1.26940,19.20200,57.84100],
        [60.000,300.000,0.0361911,2885.49,6.0702,3.6378,526.04000,1.27430,19.71300,57.51500],
        [60.000,310.000,0.037523,2920.58,6.1309,3.3929,536.29000,1.27750,20.21300,57.44200],
        [60.000,320.000,0.0387819,2953.55,6.187,3.2078,545.69000,1.27970,20.70500,57.55200],
        [60.000,330.000,0.0399833,2984.87,6.2393,3.0626,554.43000,1.28130,21.18800,57.80400],
        [60.000,340.000,0.0411378,3014.89,6.2887,2.9459,562.64000,1.28250,21.66500,58.17100],
        [60.000,350.000,0.0422535,3043.86,6.3356,2.8504,570.41000,1.28340,22.13500,58.63300],
        [60.000,360.000,0.0433364,3071.96,6.3803,2.7714,577.79000,1.28390,22.60100,59.17800],
        [60.000,370.000,0.0443912,3099.33,6.4232,2.7054,584.85000,1.28420,23.06100,59.79300],
        [60.000,380.000,0.045422,3126.1,6.4645,2.6499,591.62000,1.28430,23.51700,60.47000],
        [60.000,390.000,0.0464317,3152.36,6.5044,2.603,598.14000,1.28420,23.96900,61.20200],
        [60.000,400.000,0.047423,3178.18,6.5431,2.5632,604.44000,1.28400,24.41700,61.98400],
        [60.000,410.000,0.048398,3203.64,6.5806,2.5293,610.54000,1.28370,24.86200,62.81000],
        [60.000,420.000,0.0493586,3228.79,6.6171,2.5004,616.47000,1.28320,25.30400,63.67700],
        [60.000,430.000,0.0503063,3253.66,6.6528,2.4757,622.23000,1.28270,25.74300,64.58100],
        [60.000,440.000,0.0512425,3278.31,6.6876,2.4545,627.84000,1.28210,26.17900,65.51900],
        [60.000,450.000,0.0521683,3302.76,6.7216,2.4364,633.32000,1.28140,26.61200,66.48900],
        [60.000,460.000,0.0530847,3327.05,6.755,2.4209,638.68000,1.28070,27.04300,67.48700],
        [60.000,470.000,0.0539925,3351.19,6.7877,2.4077,643.93000,1.27990,27.47200,68.51300],
        [60.000,480.000,0.0548925,3375.21,6.8198,2.3964,649.07000,1.27910,27.89800,69.56300],
        [60.000,490.000,0.0557854,3399.12,6.8513,2.3868,654.12000,1.27830,28.32300,70.63700],
        [60.000,500.000,0.0566717,3422.95,6.8824,2.3787,659.07000,1.27750,28.74500,71.73300],
        [60.000,510.000,0.0575519,3446.7,6.9129,2.3719,663.95000,1.27660,29.16500,72.84900],
        [60.000,520.000,0.0584266,3470.39,6.9429,2.3663,668.74000,1.27570,29.58400,73.98400],
        [60.000,530.000,0.059296,3494.03,6.9726,2.3616,673.46000,1.27480,30.00100,75.13800],
        [60.000,540.000,0.0601607,3517.63,7.0018,2.3579,678.11000,1.27390,30.41600,76.30800],
        [60.000,550.000,0.0610209,3541.19,7.0306,2.355,682.70000,1.27300,30.83000,77.49500],
        [60.000,560.000,0.0618769,3564.73,7.059,2.3528,687.22000,1.27210,31.24200,78.69600],
        [60.000,570.000,0.062729,3588.25,7.087,2.3512,691.69000,1.27120,31.65200,79.91200],
        [60.000,580.000,0.0635775,3611.76,7.1148,2.3503,696.09000,1.27020,32.06100,81.14100],
        [60.000,590.000,0.0644225,3635.26,7.1421,2.3498,700.45000,1.26930,32.46800,82.38300],
        [60.000,600.000,0.0652644,3658.76,7.1692,2.3499,704.75000,1.26840,32.87400,83.63700],
        [60.000,650.000,0.0694316,3776.36,7.3002,2.3559,725.58000,1.26380,34.88300,90.06800],
        [60.000,700.000,0.0735419,3894.47,7.4248,2.3692,745.42000,1.25930,36.85900,96.71900],
        [60.000,750.000,0.0776087,4013.37,7.5439,2.3874,764.42000,1.25490,38.80500,103.54700],
        //[60.000,800.000,0.0816416,4133.27,7.6583,2.4092,782.69000,1.25060,40.72100,110.51200],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_750_degc_80_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[80.000,0.000,0.000996188,8.05907,0.0002693,4.1814,1414.9000,251.2200,1774.7000,561.5600],
        [80.000,2.000,0.000996145,16.4176,0.030758,4.1772,1424.8000,254.7300,1659.3000,566.3700],
        [80.000,4.000,0.000996165,24.7683,0.060998,4.1737,1434.2000,258.1000,1555.4000,571.0000],
        [80.000,6.000,0.000996245,33.1127,0.090998,4.1708,1443.2000,261.3400,1461.5000,575.4400],
        [80.000,8.000,0.00099638,41.4519,0.12076,4.1685,1451.9000,264.4400,1376.5000,579.7300],
        [80.000,10.000,0.000996568,49.7868,0.15031,4.1665,1460.1000,267.4100,1299.1000,583.8600],
        [80.000,12.000,0.000996806,58.1182,0.17963,4.1649,1468.0000,270.2400,1228.4000,587.8500],
        [80.000,14.000,0.000997092,66.4467,0.20873,4.1636,1475.5000,272.9400,1163.7000,591.7200],
        [80.000,16.000,0.000997423,74.7728,0.23763,4.1625,1482.7000,275.5000,1104.4000,595.4600],
        [80.000,18.000,0.000997797,83.097,0.26632,4.1617,1489.5000,277.9400,1049.7000,599.0800],
        [80.000,20.000,0.000998213,91.4196,0.2948,4.1609,1496.0000,280.2400,999.3100,602.6000],
        [80.000,25.000,0.000999424,112.221,0.36516,4.1597,1510.7000,285.4600,889.0300,610.9400],
        [80.000,30.000,0.00100086,133.018,0.43434,4.1592,1523.6000,289.9200,797.1400,618.6900],
        [80.000,35.000,0.00100252,153.814,0.50238,4.1591,1534.7000,293.6700,719.6900,625.9100],
        [80.000,40.000,0.00100437,174.61,0.56932,4.1596,1544.1000,296.7400,653.7600,632.6400],
        [80.000,45.000,0.0010064,195.41,0.63522,4.1604,1552.0000,299.1700,597.1400,638.9000],
        [80.000,50.000,0.00100862,216.215,0.70011,4.1617,1558.5000,301.0000,548.1300,644.7200],
        [80.000,55.000,0.00101101,237.028,0.76402,4.1634,1563.6000,302.2600,505.4100,650.1100],
        [80.000,60.000,0.00101356,257.85,0.82699,4.1656,1567.4000,302.9900,467.9500,655.1000],
        [80.000,65.000,0.00101627,278.684,0.88906,4.1681,1570.1000,303.2100,434.9000,659.7000],
        [80.000,70.000,0.00101913,299.532,0.95027,4.1712,1571.6000,302.9600,405.6100,663.9100],
        [80.000,75.000,0.00102215,320.396,1.0106,4.1746,1572.2000,302.2600,379.5100,667.7500],
        [80.000,80.000,0.00102532,341.279,1.0702,4.1786,1571.7000,301.1500,356.1700,671.2300],
        [80.000,85.000,0.00102864,362.183,1.129,4.1829,1570.3000,299.6600,335.2100,674.3500],
        [80.000,90.000,0.00103211,383.109,1.187,4.1878,1568.1000,297.7900,316.3100,677.1300],
        [80.000,95.000,0.00103572,404.061,1.2443,4.1931,1565.0000,295.5900,299.2200,679.5600],
        [80.000,100.000,0.00103948,425.041,1.3009,4.1989,1561.1000,293.0700,283.7100,681.6700],
        [80.000,110.000,0.00104745,467.093,1.4121,4.2119,1551.2000,287.1500,256.7100,684.9300],
        [80.000,120.000,0.00105601,509.285,1.5208,4.2269,1538.5000,280.1900,234.0900,686.9500],
        [80.000,130.000,0.00106519,551.639,1.6272,4.2442,1523.4000,272.3200,214.9500,687.7800],
        [80.000,140.000,0.00107502,594.178,1.7314,4.264,1505.8000,263.6500,198.6000,687.4800],
        [80.000,150.000,0.00108552,636.929,1.8337,4.2866,1486.0000,254.2900,184.5200,686.1000],
        [80.000,160.000,0.00109674,679.921,1.9341,4.3123,1464.1000,244.3000,172.2900,683.6600],
        [80.000,170.000,0.00110874,723.187,2.0328,4.3417,1440.0000,233.7800,161.5800,680.6900],
        [80.000,180.000,0.00112157,766.768,2.1301,4.3752,1413.8000,222.7800,152.1300,676.5400],
        [80.000,190.000,0.00113533,810.708,2.226,4.4137,1385.6000,211.3700,143.7300,671.4100],
        [80.000,200.000,0.0011501,855.061,2.3207,4.4578,1355.2000,199.6100,136.2100,665.3500],
        [80.000,210.000,0.00116601,899.887,2.4145,4.5087,1322.7000,187.5500,129.4200,658.3600],
        [80.000,220.000,0.0011832,945.262,2.5074,4.5677,1288.0000,175.2500,123.2500,650.4700],
        [80.000,230.000,0.00120186,991.273,2.5998,4.6363,1251.0000,162.7700,117.5800,641.6700],
        [80.000,240.000,0.00122222,1038.03,2.6918,4.7169,1211.6000,150.1500,112.3300,631.9500],
        [80.000,250.000,0.00124457,1085.66,2.7837,4.8125,1169.8000,137.4300,107.4300,621.3000],
        [80.000,260.000,0.0012693,1134.34,2.8759,4.9272,1125.0000,124.6500,102.8000,609.6700],
        [80.000,270.000,0.00129694,1184.29,2.9687,5.0674,1077.0000,111.8000,98.3760,597.0100],
        [80.000,280.000,0.00132823,1235.81,3.0627,5.2431,1024.9000,98.8650,94.0900,583.2300],
        [80.000,290.000,0.00136429,1289.33,3.1586,5.4713,967.7200,85.8030,89.8660,568.1800],
        [80.000,295.009,0.00138466,1317.08,3.2077,5.614,936.7300,79.2120,87.7450,560.0900],
        [80.000,295.009,0.0235275,2758.61,5.7448,5.8831,484.0700,1.2450,19.3260,68.0520],
        [80.000,300.000,0.0242802,2786.38,5.7935,5.287,493.5600,1.2541,19.5960,66.7090],
        [80.000,310.000,0.0256318,2835.27,5.8781,4.5559,509.1100,1.2640,20.1250,65.0070],
        [80.000,320.000,0.0268425,2878.35,5.9514,4.0905,522.1600,1.2697,20.6400,64.0290],
        [80.000,330.000,0.0279551,2917.53,6.0169,3.762,533.6900,1.2736,21.1450,63.4890],
        [80.000,340.000,0.0289946,2953.87,6.0766,3.5176,544.1200,1.2764,21.6390,63.2470],
        [80.000,350.000,0.0299776,2988.06,6.1319,3.3288,553.7100,1.2785,22.1260,63.2230],
        [80.000,360.000,0.0309152,3020.57,6.1837,3.1789,562.6400,1.2800,22.6050,63.3700],
        [80.000,370.000,0.0318155,3051.73,6.2325,3.0573,571.0200,1.2811,23.0780,63.6520],
        [80.000,380.000,0.0326848,3081.79,6.2789,2.9572,578.9400,1.2818,23.5460,64.0480],
        [80.000,390.000,0.0335276,3110.93,6.3232,2.8738,586.4600,1.2823,24.0080,64.5390],
        [80.000,400.000,0.0343477,3139.31,6.3657,2.8037,593.6500,1.2825,24.4650,65.1110],
        [80.000,410.000,0.0351482,3167.04,6.4066,2.7444,600.5400,1.2826,24.9180,65.7550],
        [80.000,420.000,0.0359315,3194.23,6.4461,2.6939,607.1700,1.2825,25.3670,66.4620],
        [80.000,430.000,0.0366996,3220.95,6.4843,2.6507,613.5600,1.2822,25.8120,67.2250],
        [80.000,440.000,0.0374543,3247.26,6.5215,2.6136,619.7500,1.2819,26.2540,68.0390],
        [80.000,450.000,0.038197,3273.23,6.5577,2.5817,625.7500,1.2814,26.6930,68.8980],
        [80.000,460.000,0.038929,3298.91,6.5929,2.5541,631.5900,1.2809,27.1280,69.7980],
        [80.000,470.000,0.0396513,3324.33,6.6274,2.5303,637.2700,1.2803,27.5610,70.7360],
        [80.000,480.000,0.0403649,3349.53,6.6611,2.5097,642.8200,1.2796,27.9920,71.7080],
        [80.000,490.000,0.0410706,3374.53,6.694,2.4919,648.2400,1.2789,28.4190,72.7130],
        [80.000,500.000,0.0417691,3399.37,6.7264,2.4765,653.5400,1.2782,28.8450,73.7460],
        [80.000,510.000,0.0424609,3424.07,6.7581,2.4631,658.7300,1.2774,29.2680,74.8070],
        [80.000,520.000,0.0431467,3448.64,6.7893,2.4516,663.8200,1.2766,29.6890,75.8930],
        [80.000,530.000,0.0438269,3473.11,6.8199,2.4416,668.8200,1.2758,30.1080,77.0030],
        [80.000,540.000,0.0445019,3497.48,6.8501,2.4331,673.7300,1.2750,30.5250,78.1350],
        [80.000,550.000,0.0451721,3521.77,6.8798,2.4258,678.5600,1.2741,30.9400,79.2870],
        [80.000,560.000,0.0458379,3546.0,6.9091,2.4196,683.3100,1.2733,31.3530,80.4580],
        [80.000,570.000,0.0464996,3570.17,6.9379,2.4144,687.9900,1.2724,31.7640,81.6470],
        [80.000,580.000,0.0471574,3594.29,6.9663,2.4101,692.6000,1.2715,32.1740,82.8530],
        [80.000,590.000,0.0478117,3618.37,6.9944,2.4066,697.1500,1.2707,32.5820,84.0750],
        [80.000,600.000,0.0484625,3642.42,7.0221,2.4038,701.6400,1.2698,32.9890,85.3120],
        [80.000,650.000,0.0516732,3762.42,7.1557,2.3983,723.2500,1.2654,34.9990,91.6920],
        [80.000,700.000,0.0548251,3882.42,7.2823,2.4032,743.7000,1.2610,36.9740,98.3330],
        [80.000,750.000,0.0579325,4002.86,7.403,2.4152,763.2000,1.2568,38.9180,105.1800],
        //[80.000,800.000,0.0610054,4124.02,7.5186,2.4322,781.8800,1.2526,40.8310,112.1900],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_100_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[100.000,0.000,0.0009952,10.0693,0.0003384,4.1723,1418.20000,202.09000,1770.60000,563.03000],
        [100.000,2.000,0.000995171,18.41,0.030762,4.1686,1428.00000,204.90000,1655.80000,567.79000],
        [100.000,4.000,0.000995203,26.744,0.060942,4.1655,1437.40000,207.61000,1552.50000,572.37000],
        [100.000,6.000,0.000995294,35.0726,0.090884,4.1631,1446.40000,210.21000,1459.10000,576.77000],
        [100.000,8.000,0.00099544,43.3967,0.1206,4.1611,1455.10000,212.69000,1374.50000,581.02000],
        [100.000,10.000,0.000995638,51.7173,0.15009,4.1595,1463.30000,215.07000,1297.40000,585.12000],
        [100.000,12.000,0.000995884,60.0349,0.17936,4.1582,1471.20000,217.34000,1227.10000,589.09000],
        [100.000,14.000,0.000996178,68.3503,0.20842,4.1572,1478.70000,219.50000,1162.60000,592.92000],
        [100.000,16.000,0.000996516,76.6637,0.23727,4.1563,1485.90000,221.56000,1103.50000,596.64000],
        [100.000,18.000,0.000996897,84.9757,0.26592,4.1557,1492.70000,223.51000,1049.00000,600.24000],
        [100.000,20.000,0.000997318,93.2865,0.29437,4.1551,1499.20000,225.36000,998.78000,603.74000],
        [100.000,25.000,0.000998541,114.06,0.36463,4.1543,1514.00000,229.54000,888.81000,612.04000],
        [100.000,30.000,0.000999989,134.831,0.43372,4.1541,1526.80000,233.12000,797.14000,619.76000],
        [100.000,35.000,0.00100165,155.601,0.50168,4.1543,1537.90000,236.13000,719.85000,626.96000],
        [100.000,40.000,0.0010035,176.374,0.56855,4.1549,1547.40000,238.60000,654.03000,633.67000],
        [100.000,45.000,0.00100554,197.151,0.63437,4.1559,1555.30000,240.56000,597.49000,639.92000],
        [100.000,50.000,0.00100775,217.934,0.69919,4.1573,1561.80000,242.04000,548.54000,645.74000],
        [100.000,55.000,0.00101013,238.725,0.76303,4.1591,1566.90000,243.06000,505.86000,651.13000],
        [100.000,60.000,0.00101268,259.526,0.82594,4.1613,1570.80000,243.66000,468.43000,656.13000],
        [100.000,65.000,0.00101538,280.339,0.88795,4.1639,1573.60000,243.86000,435.41000,660.73000],
        [100.000,70.000,0.00101824,301.166,0.94909,4.167,1575.20000,243.67000,406.13000,664.95000],
        [100.000,75.000,0.00102125,322.009,1.0094,4.1705,1575.80000,243.14000,380.04000,668.80000],
        [100.000,80.000,0.00102441,342.871,1.0689,4.1744,1575.40000,242.27000,356.71000,672.29000],
        [100.000,85.000,0.00102771,363.754,1.1276,4.1787,1574.10000,241.09000,335.75000,675.42000],
        [100.000,90.000,0.00103116,384.659,1.1856,4.1835,1571.90000,239.62000,316.85000,678.21000],
        [100.000,95.000,0.00103475,405.59,1.2428,4.1888,1568.90000,237.88000,299.76000,680.67000],
        [100.000,100.000,0.0010385,426.548,1.2994,4.1945,1565.10000,235.89000,284.25000,682.79000],
        [100.000,110.000,0.00104641,468.555,1.4105,4.2073,1555.40000,231.20000,257.24000,686.08000],
        [100.000,120.000,0.00105493,510.701,1.519,4.2221,1543.00000,225.68000,234.61000,688.14000],
        [100.000,130.000,0.00106405,553.005,1.6253,4.2391,1528.00000,219.43000,215.46000,689.02000],
        [100.000,140.000,0.0010738,595.491,1.7294,4.2585,1510.70000,212.54000,199.11000,688.77000],
        [100.000,150.000,0.00108422,638.184,1.8315,4.2806,1491.20000,205.10000,185.02000,687.44000],
        [100.000,160.000,0.00109535,681.112,1.9318,4.3057,1469.60000,197.16000,172.79000,685.06000],
        [100.000,170.000,0.00110724,724.309,2.0304,4.3343,1445.80000,188.80000,162.07000,682.10000],
        [100.000,180.000,0.00111996,767.812,2.1274,4.367,1420.10000,180.06000,152.62000,678.03000],
        [100.000,190.000,0.00113357,811.665,2.2232,4.4044,1392.20000,170.99000,144.23000,672.97000],
        [100.000,200.000,0.00114818,855.918,2.3177,4.4472,1362.30000,161.64000,136.71000,666.98000],
        [100.000,210.000,0.00116389,900.631,2.4112,4.4965,1330.30000,152.05000,129.92000,660.08000],
        [100.000,220.000,0.00118085,945.874,2.5039,4.5535,1296.10000,142.27000,123.76000,652.28000],
        [100.000,230.000,0.00119922,991.731,2.5959,4.6196,1259.80000,132.34000,118.10000,643.58000],
        [100.000,240.000,0.00121923,1038.3,2.6876,4.697,1221.10000,122.30000,112.87000,633.98000],
        [100.000,250.000,0.00124116,1085.72,2.7791,4.7883,1180.00000,112.19000,107.99000,623.46000],
        [100.000,260.000,0.00126534,1134.13,2.8708,4.8972,1136.30000,102.03000,103.38000,611.99000],
        [100.000,270.000,0.00129228,1183.74,2.9629,5.0293,1089.40000,91.84000,98.99500,599.52000],
        [100.000,280.000,0.00132264,1234.82,3.0561,5.1931,1038.90000,81.60500,94.75500,585.97000],
        [100.000,290.000,0.00135739,1287.75,3.151,5.4023,983.78000,71.30000,90.59600,571.21000],
        [100.000,300.000,0.00139804,1343.1,3.2484,5.6816,922.76000,60.90500,86.43400,555.07000],
        [100.000,310.000,0.0014471,1401.77,3.3498,6.0782,854.92000,50.50700,82.15600,537.19000],
        [100.000,310.999,0.00145262,1407.87,3.3603,6.1275,847.74000,49.47400,81.71600,535.29000],
        [100.000,310.999,0.0180336,2725.47,5.6159,7.1472,472.44000,1.23770,20.19400,78.33800],
        [100.000,320.000,0.0192716,2782.66,5.7131,5.7468,491.71000,1.25460,20.66400,74.14800],
        [100.000,330.000,0.0204462,2835.67,5.8017,4.9228,508.20000,1.26320,21.17700,71.58000],
        [100.000,340.000,0.0214897,2882.06,5.878,4.3885,522.16000,1.26880,21.68200,70.04000],
        [100.000,350.000,0.0224422,2923.96,5.9458,4.0118,534.45000,1.27280,22.17700,69.10400],
        [100.000,360.000,0.0233274,2962.61,6.0073,3.7324,545.52000,1.27570,22.66500,68.57000],
        [100.000,370.000,0.0241605,2998.82,6.0641,3.5174,555.64000,1.27790,23.14600,68.32300],
        [100.000,380.000,0.0249522,3033.11,6.117,3.3471,565.02000,1.27940,23.62100,68.29300],
        [100.000,390.000,0.0257099,3065.87,6.1668,3.2092,573.79000,1.28060,24.08900,68.43400],
        [100.000,400.000,0.0264393,3097.38,6.2139,3.0958,582.04000,1.28130,24.55300,68.71500],
        [100.000,410.000,0.0271447,3127.85,6.2589,3.0013,589.86000,1.28180,25.01100,69.11100],
        [100.000,420.000,0.0278294,3157.45,6.3019,2.9217,597.31000,1.28200,25.46500,69.60600],
        [100.000,430.000,0.0284963,3186.32,6.3432,2.8542,604.44000,1.28210,25.91400,70.18600],
        [100.000,440.000,0.0291475,3214.57,6.3831,2.7965,611.28000,1.28200,26.36000,70.84000],
        [100.000,450.000,0.029785,3242.28,6.4217,2.747,617.87000,1.28170,26.80200,71.56000],
        [100.000,460.000,0.0304102,3269.53,6.4591,2.7043,624.24000,1.28140,27.24100,72.33800],
        [100.000,470.000,0.0310246,3296.38,6.4955,2.6674,630.41000,1.28100,27.67600,73.16700],
        [100.000,480.000,0.0316292,3322.89,6.531,2.6354,636.39000,1.28040,28.10900,74.04400],
        [100.000,490.000,0.032225,3349.11,6.5655,2.6076,642.21000,1.27990,28.53900,74.96400],
        [100.000,500.000,0.0328129,3375.06,6.5993,2.5833,647.89000,1.27920,28.96600,75.92200],
        [100.000,510.000,0.0333935,3400.78,6.6324,2.5622,653.42000,1.27860,29.39100,76.91600],
        [100.000,520.000,0.0339675,3426.31,6.6648,2.5437,658.83000,1.27790,29.81300,77.94300],
        [100.000,530.000,0.0345355,3451.67,6.6965,2.5275,664.12000,1.27710,30.23300,79.00000],
        [100.000,540.000,0.0350979,3476.87,6.7277,2.5134,669.31000,1.27640,30.65100,80.08500],
        [100.000,550.000,0.0356552,3501.94,6.7584,2.5011,674.39000,1.27560,31.06700,81.19500],
        [100.000,560.000,0.0362078,3526.9,6.7885,2.4904,679.39000,1.27480,31.48000,82.33000],
        [100.000,570.000,0.0367561,3551.75,6.8182,2.4811,684.29000,1.27400,31.89200,83.48700],
        [100.000,580.000,0.0373002,3576.52,6.8474,2.473,689.11000,1.27310,32.30200,84.66500],
        [100.000,590.000,0.0378406,3601.22,6.8761,2.466,693.86000,1.27230,32.71100,85.86200],
        [100.000,600.000,0.0383775,3625.84,6.9045,2.46,698.54000,1.27150,33.11700,87.07700],
        [100.000,650.000,0.0410163,3748.32,7.0409,2.442,720.95000,1.26720,35.12600,93.38700],
        [100.000,700.000,0.0435944,3870.27,7.1696,2.438,742.03000,1.26300,37.09800,100.00000],
        [100.000,750.000,0.0461269,3992.28,7.2918,2.4435,762.03000,1.25890,39.03800,106.87000],
        //[100.000,800.000,0.0486242,4114.73,7.4087,2.4555,781.12000,1.25480,40.94700,113.90000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_120_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[120.000,0.000,0.000994218,12.0737,0.0003931,4.1633,1421.40000,169.34000,1766.60000,564.48000],
        [120.000,2.000,0.000994202,20.397,0.030754,4.1601,1431.20000,171.70000,1652.50000,569.19000],
        [120.000,4.000,0.000994247,28.7145,0.060873,4.1575,1440.60000,173.96000,1549.70000,573.72000],
        [120.000,6.000,0.00099435,37.0275,0.09076,4.1555,1449.70000,176.12000,1456.80000,578.09000],
        [120.000,8.000,0.000994506,45.3369,0.12042,4.1539,1458.30000,178.20000,1372.50000,582.30000],
        [120.000,10.000,0.000994713,53.6433,0.14986,4.1526,1466.60000,180.19000,1295.80000,586.37000],
        [120.000,12.000,0.000994968,61.9475,0.17909,4.1516,1474.40000,182.08000,1225.80000,590.31000],
        [120.000,14.000,0.000995269,70.2499,0.2081,4.1508,1481.90000,183.88000,1161.60000,594.12000],
        [120.000,16.000,0.000995614,78.5509,0.23691,4.1502,1489.10000,185.60000,1102.60000,597.81000],
        [120.000,18.000,0.000996001,86.8509,0.26551,4.1498,1495.90000,187.23000,1048.40000,601.40000],
        [120.000,20.000,0.000996429,95.15,0.29392,4.1494,1502.40000,188.77000,998.27000,604.87000],
        [120.000,25.000,0.000997663,115.896,0.36409,4.149,1517.20000,192.26000,888.60000,613.13000],
        [120.000,30.000,0.00099912,136.641,0.43309,4.1491,1530.00000,195.26000,797.15000,620.83000],
        [120.000,35.000,0.00100078,157.387,0.50097,4.1495,1541.20000,197.78000,720.02000,628.01000],
        [120.000,40.000,0.00100264,178.136,0.56777,4.1503,1550.60000,199.84000,654.31000,634.70000],
        [120.000,45.000,0.00100468,198.891,0.63352,4.1515,1558.60000,201.49000,597.85000,640.95000],
        [120.000,50.000,0.00100689,219.652,0.69827,4.153,1565.10000,202.73000,548.95000,646.76000],
        [120.000,55.000,0.00100927,240.421,0.76205,4.1549,1570.30000,203.60000,506.32000,652.15000],
        [120.000,60.000,0.00101181,261.201,0.82489,4.1571,1574.20000,204.11000,468.92000,657.15000],
        [120.000,65.000,0.0010145,281.993,0.88684,4.1598,1577.00000,204.29000,435.91000,661.75000],
        [120.000,70.000,0.00101735,302.8,0.94792,4.1629,1578.70000,204.15000,406.65000,665.98000],
        [120.000,75.000,0.00102035,323.622,1.0082,4.1664,1579.40000,203.72000,380.57000,669.84000],
        [120.000,80.000,0.00102349,344.464,1.0676,4.1703,1579.10000,203.02000,357.24000,673.34000],
        [120.000,85.000,0.00102678,365.326,1.1263,4.1746,1577.80000,202.05000,336.28000,676.49000],
        [120.000,90.000,0.00103022,386.21,1.1842,4.1793,1575.70000,200.85000,317.39000,679.30000],
        [120.000,95.000,0.00103379,407.12,1.2414,4.1845,1572.80000,199.41000,300.30000,681.77000],
        [120.000,100.000,0.00103751,428.056,1.2978,4.1902,1569.10000,197.77000,284.78000,683.91000],
        [120.000,110.000,0.00104539,470.02,1.4088,4.2028,1559.60000,193.89000,257.76000,687.24000],
        [120.000,120.000,0.00105385,512.119,1.5173,4.2174,1547.40000,189.33000,235.13000,689.34000],
        [120.000,130.000,0.00106291,554.374,1.6234,4.234,1532.60000,184.16000,215.98000,690.26000],
        [120.000,140.000,0.0010726,596.807,1.7274,4.253,1515.60000,178.46000,199.62000,690.06000],
        [120.000,150.000,0.00108294,639.443,1.8294,4.2746,1496.40000,172.30000,185.52000,688.77000],
        [120.000,160.000,0.00109398,682.309,1.9295,4.2992,1475.00000,165.73000,173.28000,686.44000],
        [120.000,170.000,0.00110577,725.438,2.0279,4.3271,1451.60000,158.80000,162.57000,683.51000],
        [120.000,180.000,0.00111836,768.865,2.1248,4.359,1426.20000,151.56000,153.11000,679.50000],
        [120.000,190.000,0.00113184,812.632,2.2204,4.3953,1398.80000,144.05000,144.72000,674.52000],
        [120.000,200.000,0.00114628,856.788,2.3147,4.4369,1369.30000,136.31000,137.20000,668.60000],
        [120.000,210.000,0.0011618,901.391,2.408,4.4847,1337.80000,128.36000,130.42000,661.78000],
        [120.000,220.000,0.00117853,946.506,2.5004,4.5397,1304.10000,120.26000,124.26000,654.07000],
        [120.000,230.000,0.00119664,992.215,2.5921,4.6035,1268.40000,112.04000,118.61000,645.47000],
        [120.000,240.000,0.00121632,1038.61,2.6834,4.6779,1230.40000,103.72000,113.40000,635.98000],
        [120.000,250.000,0.00123783,1085.81,2.7745,4.7652,1190.10000,95.34600,108.53000,625.59000],
        [120.000,260.000,0.00126151,1133.97,2.8657,4.8688,1147.20000,86.93700,103.96000,614.27000],
        [120.000,270.000,0.00128779,1183.26,2.9573,4.9936,1101.50000,78.50800,99.60000,601.98000],
        [120.000,280.000,0.00131728,1233.94,3.0498,5.1467,1052.40000,70.06300,95.40300,588.65000],
        [120.000,290.000,0.00135084,1286.33,3.1436,5.3398,999.16000,61.58700,91.30200,574.18000],
        [120.000,300.000,0.00138976,1340.93,3.2397,5.5924,940.65000,53.05600,87.22200,558.39000],
        [120.000,310.000,0.00143614,1398.49,3.3393,5.9411,875.62000,44.48900,83.06700,541.03000],
        [120.000,320.000,0.00149369,1460.31,3.4444,6.4621,803.26000,35.99800,78.69500,521.62000],
        [120.000,324.678,0.00152633,1491.33,3.4965,6.8126,765.59000,32.00100,76.51100,511.64000],
        [120.000,324.678,0.0142689,2685.58,5.4941,8.8189,459.46000,1.23290,21.10900,91.06200],
        [120.000,330.000,0.0150236,2728.14,5.565,7.3313,474.22000,1.24740,21.35700,85.82700],
        [120.000,340.000,0.0162112,2793.47,5.6725,5.8968,494.92000,1.25910,21.83700,80.37400],
        [120.000,350.000,0.0172227,2848.01,5.7607,5.0746,511.54000,1.26610,22.32100,77.30400],
        [120.000,360.000,0.0181226,2895.87,5.8369,4.5309,525.77000,1.27110,22.80400,75.41300],
        [120.000,370.000,0.0189442,2939.15,5.9047,4.1447,538.33000,1.27480,23.28300,74.22200],
        [120.000,380.000,0.0197077,2979.09,5.9664,3.8563,549.63000,1.27740,23.75600,73.49400],
        [120.000,390.000,0.0204258,3016.49,6.0232,3.6329,559.97000,1.27930,24.22500,73.09600],
        [120.000,400.000,0.0211077,3051.9,6.0762,3.4551,569.54000,1.28060,24.68900,72.94800],
        [120.000,410.000,0.0217597,3085.7,6.1261,3.3106,578.47000,1.28150,25.14900,72.99500],
        [120.000,420.000,0.0223867,3118.19,6.1733,3.1912,586.89000,1.28210,25.60400,73.20000],
        [120.000,430.000,0.0229924,3149.59,6.2182,3.0914,594.85000,1.28250,26.05400,73.53600],
        [120.000,440.000,0.0235799,3180.07,6.2613,3.0071,602.43000,1.28260,26.50100,73.98200],
        [120.000,450.000,0.0241515,3209.77,6.3027,2.9353,609.68000,1.28260,26.94400,74.52200],
        [120.000,460.000,0.0247091,3238.81,6.3425,2.8737,616.64000,1.28240,27.38400,75.14500],
        [120.000,470.000,0.0252545,3267.28,6.3811,2.8207,623.34000,1.28210,27.82000,75.84000],
        [120.000,480.000,0.025789,3295.25,6.4185,2.7748,629.81000,1.28170,28.25300,76.59800],
        [120.000,490.000,0.0263138,3322.79,6.4548,2.7349,636.07000,1.28130,28.68300,77.41400],
        [120.000,500.000,0.0268298,3349.97,6.4902,2.7002,642.14000,1.28070,29.11100,78.28100],
        [120.000,510.000,0.0273378,3376.81,6.5247,2.6698,648.04000,1.28010,29.53600,79.19300],
        [120.000,520.000,0.0278387,3403.37,6.5584,2.6432,653.79000,1.27950,29.95800,80.14800],
        [120.000,530.000,0.0283331,3429.69,6.5914,2.6199,659.39000,1.27880,30.37800,81.14200],
        [120.000,540.000,0.0288215,3455.78,6.6237,2.5993,664.86000,1.27810,30.79600,82.17000],
        [120.000,550.000,0.0293045,3481.68,6.6553,2.5813,670.22000,1.27740,31.21100,83.23100],
        [120.000,560.000,0.0297824,3507.41,6.6864,2.5654,675.46000,1.27660,31.62500,84.32100],
        [120.000,570.000,0.0302557,3533.0,6.7169,2.5514,680.60000,1.27580,32.03600,85.43800],
        [120.000,580.000,0.0307247,3558.45,6.7469,2.5391,685.64000,1.27510,32.44600,86.58100],
        [120.000,590.000,0.0311897,3583.78,6.7764,2.5283,690.60000,1.27430,32.85300,87.74800],
        [120.000,600.000,0.0316511,3609.02,6.8055,2.5188,695.46000,1.27340,33.25900,88.93600],
        [120.000,650.000,0.0339104,3734.07,6.9448,2.4871,718.70000,1.26930,35.26400,95.15800],
        [120.000,700.000,0.0361069,3858.03,7.0756,2.4737,740.40000,1.26520,37.23100,101.74000],
        [120.000,750.000,0.0382567,3981.64,7.1994,2.4723,760.90000,1.26120,39.16500,108.60000],
        //[120.000,800.000,0.0403706,4105.4,7.3175,2.4793,780.40000,1.25710,41.06800,115.66000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_140_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[140.000,0.000,0.000993243,14.0723,0.0004338,4.1545,1424.7000,145.9600,1762.6000,565.9100],
        [140.000,2.000,0.00099324,22.3784,0.030732,4.1518,1434.5000,147.9800,1649.2000,570.5800],
        [140.000,4.000,0.000993298,30.6799,0.060793,4.1497,1443.9000,149.9200,1546.9000,575.0700],
        [140.000,6.000,0.000993411,38.9776,0.090625,4.1481,1452.9000,151.7800,1454.5000,579.4000],
        [140.000,8.000,0.000993577,47.2724,0.12023,4.1468,1461.6000,153.5700,1370.6000,583.5800],
        [140.000,10.000,0.000993794,55.565,0.14962,4.1458,1469.8000,155.2700,1294.2000,587.6200],
        [140.000,12.000,0.000994058,63.8559,0.1788,4.1451,1477.7000,156.9000,1224.5000,591.5200],
        [140.000,14.000,0.000994366,72.1456,0.20777,4.1446,1485.2000,158.4500,1160.5000,595.3100],
        [140.000,16.000,0.000994718,80.4344,0.23654,4.1442,1492.3000,159.9200,1101.8000,598.9800],
        [140.000,18.000,0.000995112,88.7225,0.2651,4.1439,1499.1000,161.3200,1047.7000,602.5400],
        [140.000,20.000,0.000995544,97.0102,0.29347,4.1438,1505.6000,162.6400,997.7700,606.0000],
        [140.000,25.000,0.00099679,117.729,0.36355,4.1438,1520.4000,165.6400,888.4100,614.2200],
        [140.000,30.000,0.000998255,138.448,0.43247,4.1441,1533.3000,168.2200,797.1700,621.8900],
        [140.000,35.000,0.000999923,159.17,0.50027,4.1448,1544.4000,170.3800,720.1900,629.0500],
        [140.000,40.000,0.00100178,179.897,0.56699,4.1458,1553.9000,172.1600,654.5900,635.7300],
        [140.000,45.000,0.00100382,200.629,0.63267,4.1471,1561.9000,173.5800,598.2100,641.9600],
        [140.000,50.000,0.00100603,221.368,0.69735,4.1487,1568.4000,174.6600,549.3700,647.7700],
        [140.000,55.000,0.0010084,242.116,0.76106,4.1507,1573.7000,175.4100,506.7800,653.1700],
        [140.000,60.000,0.00101094,262.875,0.82385,4.153,1577.7000,175.8700,469.4000,658.1600],
        [140.000,65.000,0.00101363,283.647,0.88573,4.1557,1580.5000,176.0300,436.4200,662.7700],
        [140.000,70.000,0.00101647,304.433,0.94675,4.1588,1582.3000,175.9300,407.1700,667.0100],
        [140.000,75.000,0.00101945,325.235,1.0069,4.1623,1583.0000,175.5700,381.1000,670.8800],
        [140.000,80.000,0.00102258,346.056,1.0663,4.1662,1582.7000,174.9800,357.7800,674.3900],
        [140.000,85.000,0.00102586,366.898,1.1249,4.1705,1581.6000,174.1700,336.8200,677.5600],
        [140.000,90.000,0.00102928,387.762,1.1828,4.1752,1579.6000,173.1500,317.9300,680.3800],
        [140.000,95.000,0.00103284,408.65,1.2399,4.1803,1576.7000,171.9300,300.8300,682.8600],
        [140.000,100.000,0.00103654,429.566,1.2963,4.1859,1573.1000,170.5400,285.3100,685.0200],
        [140.000,110.000,0.00104437,471.485,1.4072,4.1983,1563.8000,167.2500,258.2900,688.3900],
        [140.000,120.000,0.00105278,513.539,1.5155,4.2127,1551.7000,163.3700,235.6500,690.5200],
        [140.000,130.000,0.00106179,555.745,1.6215,4.229,1537.2000,158.9700,216.4900,691.4900],
        [140.000,140.000,0.00107141,598.127,1.7254,4.2476,1520.4000,154.1100,200.1200,691.3300],
        [140.000,150.000,0.00108168,640.707,1.8272,4.2688,1501.4000,148.8700,186.0200,690.1000],
        [140.000,160.000,0.00109263,683.512,1.9272,4.2928,1480.4000,143.2700,173.7700,687.8300],
        [140.000,170.000,0.00110432,726.573,2.0255,4.32,1457.3000,137.3700,163.0500,684.9100],
        [140.000,180.000,0.00111679,769.925,2.1222,4.3511,1432.2000,131.2000,153.6000,680.9700],
        [140.000,190.000,0.00113013,813.609,2.2176,4.3864,1405.2000,124.8000,145.2000,676.0600],
        [140.000,200.000,0.00114442,857.671,2.3117,4.4269,1376.2000,118.2000,137.6900,670.2100],
        [140.000,210.000,0.00115975,902.166,2.4048,4.4732,1345.1000,111.4400,130.9100,663.4700],
        [140.000,220.000,0.00117627,947.158,2.4969,4.5265,1312.0000,104.5300,124.7600,655.8500],
        [140.000,230.000,0.00119411,992.722,2.5884,4.588,1276.8000,97.5210,119.1200,647.3500],
        [140.000,240.000,0.00121347,1038.95,2.6794,4.6595,1239.5000,90.4340,113.9200,637.9700],
        [140.000,250.000,0.0012346,1085.95,2.7701,4.7431,1199.9000,83.2980,109.0800,627.7100],
        [140.000,260.000,0.00125779,1133.86,2.8608,4.8419,1157.9000,76.1360,104.5200,616.5300],
        [140.000,270.000,0.00128346,1182.85,2.9518,4.96,1113.2000,68.9640,100.1900,604.4100],
        [140.000,280.000,0.00131214,1233.15,3.0436,5.1037,1065.4000,61.7890,96.0360,591.2900],
        [140.000,290.000,0.00134461,1285.05,3.1366,5.2826,1013.9000,54.6090,91.9870,577.0700],
        [140.000,300.000,0.00138198,1338.97,3.2315,5.5128,957.7300,47.4090,87.9800,561.6300],
        [140.000,310.000,0.00142603,1395.56,3.3293,5.8226,895.5900,40.1760,83.9310,544.7200],
        [140.000,320.000,0.00147974,1455.87,3.4319,6.2683,826.5000,32.9740,79.7230,525.9900],
        [140.000,330.000,0.00154886,1521.8,3.5421,6.983,748.3800,25.8290,75.1630,504.7700],
        [140.000,336.669,0.00160971,1570.88,3.623,7.8117,682.8400,20.6900,71.7320,488.7400],
        [140.000,336.669,0.0114889,2638.09,5.373,11.26,445.1800,1.2322,22.1350,108.1100],
        [140.000,340.000,0.0119989,2672.38,5.4291,9.4878,457.1600,1.2442,22.2400,101.2500],
        [140.000,350.000,0.0132316,2752.92,5.5595,7.0059,482.9000,1.2588,22.6320,90.6220],
        [140.000,360.000,0.0142288,2816.39,5.6605,5.7978,502.2800,1.2665,23.0680,85.3110],
        [140.000,370.000,0.0150919,2870.38,5.7452,5.0539,518.4300,1.2721,23.5200,82.1560],
        [140.000,380.000,0.0158666,2918.26,5.819,4.5496,532.4000,1.2761,23.9760,80.1540],
        [140.000,390.000,0.0165779,2961.83,5.8853,4.184,544.8000,1.2789,24.4330,78.8600],
        [140.000,400.000,0.017241,3002.23,5.9457,3.9064,556.0200,1.2808,24.8890,78.0450],
        [140.000,410.000,0.0178661,3040.16,6.0017,3.6884,566.3100,1.2822,25.3420,77.5760],
        [140.000,420.000,0.0184603,3076.14,6.0539,3.5132,575.8500,1.2831,25.7920,77.3690],
        [140.000,430.000,0.019029,3110.53,6.1032,3.3697,584.7900,1.2837,26.2390,77.3690],
        [140.000,440.000,0.0195762,3143.61,6.1499,3.2504,593.2100,1.2840,26.6830,77.5370],
        [140.000,450.000,0.0201049,3175.6,6.1945,3.15,601.2000,1.2841,27.1230,77.8440],
        [140.000,460.000,0.0206177,3206.66,6.2371,3.0648,608.8100,1.2841,27.5610,78.2680],
        [140.000,470.000,0.0211167,3236.94,6.2782,2.992,616.0900,1.2839,27.9950,78.7910],
        [140.000,480.000,0.0216034,3266.54,6.3177,2.9293,623.0800,1.2836,28.4270,79.4020],
        [140.000,490.000,0.0220794,3295.55,6.356,2.875,629.8100,1.2832,28.8550,80.0890],
        [140.000,500.000,0.0225457,3324.06,6.3931,2.8278,636.3100,1.2828,29.2810,80.8430],
        [140.000,510.000,0.0230034,3352.13,6.4292,2.7867,642.6000,1.2822,29.7050,81.6580],
        [140.000,520.000,0.0234533,3379.81,6.4643,2.7506,648.7100,1.2816,30.1260,82.5260],
        [140.000,530.000,0.0238961,3407.15,6.4986,2.719,654.6400,1.2810,30.5440,83.4420],
        [140.000,540.000,0.0243326,3434.2,6.532,2.6911,660.4200,1.2803,30.9600,84.4020],
        [140.000,550.000,0.0247632,3460.99,6.5648,2.6666,666.0500,1.2796,31.3750,85.4030],
        [140.000,560.000,0.0251885,3487.54,6.5968,2.6449,671.5500,1.2789,31.7870,86.4400],
        [140.000,570.000,0.0256089,3513.89,6.6283,2.6256,676.9300,1.2781,32.1970,87.5100],
        [140.000,580.000,0.0260247,3540.06,6.6591,2.6086,682.2000,1.2774,32.6050,88.6110],
        [140.000,590.000,0.0264364,3566.07,6.6894,2.5936,687.3700,1.2766,33.0110,89.7410],
        [140.000,600.000,0.0268442,3591.94,6.7192,2.5803,692.4300,1.2758,33.4160,90.8970],
        [140.000,650.000,0.0288338,3719.67,6.8615,2.5336,716.4900,1.2717,35.4130,97.0060],
        [140.000,700.000,0.0307586,3845.69,6.9944,2.5103,738.8300,1.2676,37.3730,103.5300],
        [140.000,750.000,0.0326354,3970.94,7.12,2.5017,759.8300,1.2636,39.2990,110.3900],
        //[140.000,800.000,0.0344758,4096.02,7.2393,2.5033,779.7200,1.2596,41.1950,117.4700],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_160_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[160.000,0.000,0.000992274,16.0651,0.0004606,4.1458,1427.90000,128.43000,1758.70000,567.34000],
        [160.000,2.000,0.000992285,24.3545,0.030697,4.1437,1437.70000,130.20000,1645.90000,571.96000],
        [160.000,4.000,0.000992354,32.6401,0.060701,4.142,1447.20000,131.90000,1544.30000,576.41000],
        [160.000,6.000,0.000992478,40.9228,0.090479,4.1408,1456.20000,133.53000,1452.30000,580.70000],
        [160.000,8.000,0.000992655,49.2033,0.12004,4.1399,1464.80000,135.10000,1368.80000,584.84000],
        [160.000,10.000,0.00099288,57.4824,0.14938,4.1392,1473.10000,136.59000,1292.70000,588.85000],
        [160.000,12.000,0.000993152,65.7603,0.17851,4.1387,1480.90000,138.01000,1223.20000,592.73000],
        [160.000,14.000,0.000993469,74.0374,0.20744,4.1385,1488.40000,139.37000,1159.50000,596.49000],
        [160.000,16.000,0.000993828,82.3141,0.23616,4.1383,1495.60000,140.66000,1101.00000,600.14000],
        [160.000,18.000,0.000994227,90.5906,0.26469,4.1382,1502.40000,141.89000,1047.10000,603.68000],
        [160.000,20.000,0.000994665,98.8671,0.29302,4.1382,1508.80000,143.05000,997.29000,607.12000],
        [160.000,25.000,0.000995923,119.559,0.36301,4.1386,1523.60000,145.68000,888.23000,615.30000],
        [160.000,30.000,0.000997395,140.253,0.43184,4.1392,1536.50000,147.94000,797.20000,622.94000],
        [160.000,35.000,0.000999068,160.952,0.49956,4.1401,1547.60000,149.84000,720.37000,630.08000],
        [160.000,40.000,0.00100093,181.655,0.56621,4.1413,1557.20000,151.41000,654.88000,636.75000],
        [160.000,45.000,0.00100297,202.365,0.63182,4.1427,1565.20000,152.66000,598.57000,642.98000],
        [160.000,50.000,0.00100518,223.083,0.69643,4.1445,1571.80000,153.61000,549.79000,648.78000],
        [160.000,55.000,0.00100755,243.81,0.76008,4.1465,1577.00000,154.28000,507.24000,654.17000],
        [160.000,60.000,0.00101008,264.549,0.8228,4.1489,1581.10000,154.68000,469.89000,659.17000],
        [160.000,65.000,0.00101276,285.3,0.88463,4.1516,1584.00000,154.84000,436.93000,663.79000],
        [160.000,70.000,0.00101559,306.066,0.94559,4.1548,1585.80000,154.76000,407.69000,668.04000],
        [160.000,75.000,0.00101856,326.848,1.0057,4.1583,1586.60000,154.46000,381.63000,671.92000],
        [160.000,80.000,0.00102168,347.649,1.065,4.1621,1586.40000,153.95000,358.31000,675.44000],
        [160.000,85.000,0.00102494,368.47,1.1236,4.1664,1585.30000,153.25000,337.36000,678.62000],
        [160.000,90.000,0.00102835,389.314,1.1814,4.1711,1583.40000,152.37000,318.46000,681.45000],
        [160.000,95.000,0.00103189,410.182,1.2384,4.1762,1580.60000,151.32000,301.37000,683.95000],
        [160.000,100.000,0.00103558,431.076,1.2948,4.1817,1577.10000,150.11000,285.85000,686.13000],
        [160.000,110.000,0.00104337,472.953,1.4056,4.1939,1567.90000,147.26000,258.82000,689.53000],
        [160.000,120.000,0.00105173,514.961,1.5138,4.208,1556.10000,143.89000,236.17000,691.71000],
        [160.000,130.000,0.00106067,557.12,1.6197,4.2241,1541.80000,140.07000,217.00000,692.72000],
        [160.000,140.000,0.00107023,599.45,1.7234,4.2423,1525.20000,135.85000,200.62000,692.61000],
        [160.000,150.000,0.00108042,641.975,1.8251,4.263,1506.50000,131.29000,186.52000,691.42000],
        [160.000,160.000,0.00109129,684.72,1.925,4.2865,1485.70000,126.42000,174.26000,689.20000],
        [160.000,170.000,0.00110288,727.715,2.0231,4.3131,1463.00000,121.29000,163.54000,686.29000],
        [160.000,180.000,0.00111524,770.994,2.1197,4.3434,1438.20000,115.92000,154.09000,682.44000],
        [160.000,190.000,0.00112845,814.596,2.2148,4.3778,1411.60000,110.36000,145.69000,677.59000],
        [160.000,200.000,0.00114258,858.566,2.3088,4.4171,1382.90000,104.62000,138.17000,671.81000],
        [160.000,210.000,0.00115774,902.956,2.4016,4.462,1352.30000,98.72800,131.40000,665.15000],
        [160.000,220.000,0.00117404,947.828,2.4935,4.5136,1319.80000,92.72200,125.25000,657.61000],
        [160.000,230.000,0.00119163,993.254,2.5847,4.573,1285.10000,86.62200,119.63000,649.21000],
        [160.000,240.000,0.00121069,1039.32,2.6754,4.6418,1248.40000,80.45600,114.44000,639.94000],
        [160.000,250.000,0.00123144,1086.13,2.7657,4.722,1209.50000,74.24800,109.61000,629.80000],
        [160.000,260.000,0.00125418,1133.81,2.856,4.8163,1168.30000,68.02000,105.07000,618.76000],
        [160.000,270.000,0.00127926,1182.51,2.9465,4.9284,1124.60000,61.78700,100.77000,606.81000],
        [160.000,280.000,0.0013072,1232.45,3.0376,5.0636,1078.00000,55.56100,96.65300,593.88000],
        [160.000,290.000,0.00133866,1283.89,3.1297,5.2301,1028.00000,49.34400,92.65200,579.91000],
        [160.000,300.000,0.00137464,1337.2,3.2236,5.4411,973.99000,43.13200,88.70900,564.77000],
        [160.000,310.000,0.00141664,1392.93,3.32,5.719,914.67000,36.91000,84.75200,548.28000],
        [160.000,320.000,0.00146711,1451.94,3.4203,6.1063,848.79000,30.69200,80.68300,530.13000],
        [160.000,330.000,0.00153049,1515.71,3.5269,6.6932,775.52000,24.56000,76.35100,509.81000],
        [160.000,340.000,0.00161627,1587.27,3.6445,7.7439,687.82000,18.29500,71.46900,486.41000],
        [160.000,347.357,0.00170954,1649.67,3.7457,9.4729,597.67000,13.05900,67.05600,466.33000],
        [160.000,347.357,0.00930813,2580.8,5.2463,15.207,429.20000,1.23690,23.36300,132.79000],
        [160.000,350.000,0.00976565,2616.99,5.3045,12.413,441.49000,1.24750,23.35500,121.52000],
        [160.000,360.000,0.0110599,2715.63,5.4616,8.1928,472.82000,1.26340,23.57000,102.25000],
        [160.000,370.000,0.0120464,2788.3,5.5755,6.5172,494.85000,1.27050,23.92200,93.94400],
        [160.000,380.000,0.0128781,2848.27,5.668,5.5538,512.76000,1.27600,24.32100,89.24300],
        [160.000,390.000,0.0136131,2900.49,5.7474,4.9289,527.98000,1.27980,24.74100,86.30100],
        [160.000,400.000,0.014281,2947.46,5.8177,4.4882,541.32000,1.28240,25.17100,84.37400],
        [160.000,410.000,0.0148991,2990.62,5.8814,4.1588,553.28000,1.28410,25.60600,83.10300],
        [160.000,420.000,0.0154783,3030.88,5.9399,3.9032,564.18000,1.28530,26.04200,82.29000],
        [160.000,430.000,0.0160263,3068.85,5.9943,3.6993,574.24000,1.28600,26.47800,81.81700],
        [160.000,440.000,0.0165486,3104.99,6.0453,3.5333,583.62000,1.28640,26.91300,81.60500],
        [160.000,450.000,0.0170494,3139.61,6.0935,3.396,592.43000,1.28660,27.34600,81.60000],
        [160.000,460.000,0.017532,3172.98,6.1393,3.2809,600.76000,1.28660,27.77700,81.76400],
        [160.000,470.000,0.0179988,3205.29,6.1831,3.1835,608.68000,1.28650,28.20600,82.07000],
        [160.000,480.000,0.018452,3236.7,6.2251,3.1004,616.23000,1.28620,28.63300,82.49400],
        [160.000,490.000,0.0188931,3267.34,6.2655,3.0289,623.47000,1.28590,29.05700,83.02100],
        [160.000,500.000,0.0193237,3297.31,6.3045,2.9671,630.42000,1.28540,29.47900,83.63700],
        [160.000,510.000,0.0197449,3326.71,6.3423,2.9134,637.13000,1.28490,29.89900,84.33000],
        [160.000,520.000,0.0201577,3355.6,6.379,2.8664,643.61000,1.28440,30.31700,85.09300],
        [160.000,530.000,0.0205628,3384.05,6.4146,2.8253,649.89000,1.28370,30.73300,85.91600],
        [160.000,540.000,0.0209611,3412.12,6.4494,2.7891,655.98000,1.28310,31.14600,86.79500],
        [160.000,550.000,0.0213532,3439.85,6.4832,2.7572,661.91000,1.28240,31.55800,87.72300],
        [160.000,560.000,0.0217396,3467.28,6.5164,2.729,667.68000,1.28160,31.96700,88.69600],
        [160.000,570.000,0.0221208,3494.44,6.5488,2.7039,673.31000,1.28090,32.37500,89.71000],
        [160.000,580.000,0.0224972,3521.37,6.5805,2.6817,678.81000,1.28010,32.78000,90.76100],
        [160.000,590.000,0.0228693,3548.08,6.6117,2.662,684.18000,1.27930,33.18400,91.84700],
        [160.000,600.000,0.0232373,3574.61,6.6422,2.6444,689.45000,1.27850,33.58700,92.96300],
        [160.000,650.000,0.0250259,3705.11,6.7876,2.5817,714.35000,1.27440,35.57300,98.93500],
        [160.000,700.000,0.0267475,3833.26,6.9228,2.5477,737.32000,1.27030,37.52300,105.39000],
        [160.000,750.000,0.02842,3960.18,7.0499,2.5316,758.80000,1.26620,39.44100,112.23000],
        //[160.000,800.000,0.0300554,4086.62,7.1706,2.5277,779.09000,1.26220,41.32800,119.31000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_180_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[180.000,0.000,0.000991311,18.0523,0.0004737,4.1373,1431.20000,114.80000,1755.00000,568.75000],
        [180.000,2.000,0.000991335,26.3252,0.03065,4.1357,1441.00000,116.37000,1642.80000,573.32000],
        [180.000,4.000,0.000991416,34.5952,0.060598,4.1344,1450.50000,117.89000,1541.60000,577.73000],
        [180.000,6.000,0.000991551,42.8632,0.090323,4.1336,1459.50000,119.34000,1450.10000,581.98000],
        [180.000,8.000,0.000991738,51.1298,0.11983,4.133,1468.10000,120.73000,1367.00000,586.09000],
        [180.000,10.000,0.000991972,59.3954,0.14913,4.1327,1476.30000,122.06000,1291.20000,590.07000],
        [180.000,12.000,0.000992253,67.6605,0.17821,4.1325,1484.20000,123.33000,1222.00000,593.92000],
        [180.000,14.000,0.000992576,75.9254,0.2071,4.1324,1491.70000,124.54000,1158.50000,597.66000],
        [180.000,16.000,0.000992942,84.1903,0.23578,4.1325,1498.80000,125.69000,1100.20000,601.28000],
        [180.000,18.000,0.000993347,92.4553,0.26426,4.1326,1505.60000,126.78000,1046.50000,604.81000],
        [180.000,20.000,0.000993791,100.721,0.29256,4.1328,1512.10000,127.81000,996.84000,608.23000],
        [180.000,25.000,0.00099506,121.386,0.36246,4.1335,1526.80000,130.16000,888.07000,616.38000],
        [180.000,30.000,0.000996541,142.056,0.43121,4.1344,1539.70000,132.17000,797.24000,623.99000],
        [180.000,35.000,0.000998219,162.731,0.49885,4.1355,1550.90000,133.86000,720.56000,631.11000],
        [180.000,40.000,0.00100008,183.412,0.56543,4.1369,1560.40000,135.26000,655.17000,637.76000],
        [180.000,45.000,0.00100212,204.1,0.63097,4.1384,1568.50000,136.38000,598.94000,643.98000],
        [180.000,50.000,0.00100433,224.796,0.69552,4.1403,1575.10000,137.24000,550.22000,649.78000],
        [180.000,55.000,0.0010067,245.503,0.7591,4.1424,1580.40000,137.84000,507.70000,655.18000],
        [180.000,60.000,0.00100922,266.221,0.82176,4.1449,1584.50000,138.21000,470.38000,660.18000],
        [180.000,65.000,0.00101189,286.952,0.88353,4.1476,1587.50000,138.36000,437.44000,664.81000],
        [180.000,70.000,0.00101471,307.698,0.94443,4.1508,1589.30000,138.30000,408.21000,669.06000],
        [180.000,75.000,0.00101768,328.461,1.0045,4.1543,1590.20000,138.04000,382.16000,672.95000],
        [180.000,80.000,0.00102079,349.241,1.0638,4.1582,1590.10000,137.60000,358.84000,676.49000],
        [180.000,85.000,0.00102404,370.043,1.1223,4.1624,1589.00000,136.99000,337.89000,679.67000],
        [180.000,90.000,0.00102742,390.866,1.18,4.167,1587.20000,136.22000,319.00000,682.52000],
        [180.000,95.000,0.00103095,411.714,1.237,4.1721,1584.50000,135.29000,301.90000,685.04000],
        [180.000,100.000,0.00103462,432.587,1.2933,4.1775,1581.10000,134.23000,286.38000,687.23000],
        [180.000,110.000,0.00104236,474.421,1.404,4.1896,1572.10000,131.72000,259.34000,690.67000],
        [180.000,120.000,0.00105068,516.385,1.5121,4.2035,1560.40000,128.74000,236.69000,692.89000],
        [180.000,130.000,0.00105957,558.497,1.6178,4.2192,1546.30000,125.37000,217.51000,693.94000],
        [180.000,140.000,0.00106906,600.777,1.7214,4.2371,1530.00000,121.64000,201.13000,693.88000],
        [180.000,150.000,0.00107918,643.247,1.823,4.2574,1511.50000,117.61000,187.01000,692.74000],
        [180.000,160.000,0.00108996,685.933,1.9227,4.2803,1491.00000,113.31000,174.75000,690.57000],
        [180.000,170.000,0.00110145,728.864,2.0207,4.3063,1468.50000,108.77000,164.03000,687.67000],
        [180.000,180.000,0.00111371,772.071,2.1171,4.3358,1444.10000,104.03000,154.57000,683.89000],
        [180.000,190.000,0.00112679,815.593,2.2121,4.3693,1417.80000,99.11300,146.17000,679.11000],
        [180.000,200.000,0.00114077,859.473,2.3058,4.4075,1389.60000,94.03900,138.66000,673.41000],
        [180.000,210.000,0.00115575,903.761,2.3985,4.4511,1359.40000,88.83600,131.89000,666.82000],
        [180.000,220.000,0.00117185,948.516,2.4902,4.5011,1327.30000,83.52700,125.75000,659.37000],
        [180.000,230.000,0.0011892,993.807,2.5811,4.5585,1293.30000,78.13500,120.13000,651.06000],
        [180.000,240.000,0.00120796,1039.72,2.6714,4.6248,1257.10000,72.68500,114.95000,641.89000],
        [180.000,250.000,0.00122836,1086.34,2.7614,4.7018,1218.90000,67.19800,110.10000,631.87000],
        [180.000,260.000,0.00125066,1133.8,2.8513,4.7919,1178.50000,61.69400,105.60000,620.97000],
        [180.000,270.000,0.0012752,1182.23,2.9413,4.8984,1135.70000,56.19100,101.30000,609.17000],
        [180.000,280.000,0.00130243,1231.83,3.0317,5.026,1090.20000,50.69800,97.26000,596.44000],
        [180.000,290.000,0.00133297,1282.84,3.1231,5.1816,1041.70000,45.22300,93.30000,582.69000],
        [180.000,300.000,0.00136769,1335.6,3.216,5.3761,989.47000,39.76900,89.41000,567.84000],
        [180.000,310.000,0.00140788,1390.56,3.311,5.6275,932.73000,34.33000,85.54000,551.72000],
        [180.000,320.000,0.00145557,1448.44,3.4095,5.9683,870.13000,28.89800,81.59000,534.09000],
        [180.000,330.000,0.00151428,1510.43,3.5131,6.4631,800.55000,23.51200,77.44000,514.54000],
        [180.000,340.000,0.00159084,1578.71,3.6253,7.2691,722.19000,18.21400,72.89000,492.33000],
        [180.000,350.000,0.00170295,1658.65,3.7546,8.9989,619.19000,12.50800,67.45000,466.22000],
        [180.000,356.992,0.00183949,1732.02,3.8717,12.84,513.11000,7.95150,62.12000,445.07000],
        [180.000,356.992,0.00749867,2509.53,5.1055,22.966,410.33000,1.24740,24.96000,172.52000],
        [180.000,360.000,0.00810999,2566.03,5.195,15.82,428.85000,1.25990,24.72000,145.53000],
        [180.000,370.000,0.0094513,2683.67,5.3795,9.327,465.42000,1.27330,24.64000,114.66000],
        [180.000,380.000,0.0104189,2764.89,5.5048,7.1712,489.69000,1.27860,24.87000,102.90000],
        [180.000,390.000,0.0112174,2830.24,5.6041,5.9991,509.01000,1.28320,25.20000,96.49700],
        [180.000,400.000,0.0119147,2886.31,5.6881,5.2645,525.21000,1.28620,25.57000,92.55300],
        [180.000,410.000,0.0125434,2936.27,5.7618,4.7572,539.29000,1.28810,25.96000,89.96400],
        [180.000,420.000,0.013122,2981.89,5.8281,4.3826,551.82000,1.28920,26.37000,88.22100],
        [180.000,430.000,0.0136617,3024.21,5.8887,4.0939,563.20000,1.28990,26.78000,87.05700],
        [180.000,440.000,0.0141706,3063.96,5.9448,3.8649,573.67000,1.29020,27.20000,86.31300],
        [180.000,450.000,0.0146541,3101.65,5.9973,3.6792,583.40000,1.29030,27.62000,85.88600],
        [180.000,460.000,0.0151165,3137.66,6.0468,3.5262,592.52000,1.29030,28.04000,85.70900],
        [180.000,470.000,0.015561,3172.26,6.0936,3.3983,601.13000,1.29010,28.46000,85.73200],
        [180.000,480.000,0.0159901,3205.69,6.1383,3.2902,609.29000,1.28980,28.88000,85.92000],
        [180.000,490.000,0.016406,3238.12,6.1811,3.1981,617.07000,1.28940,29.29000,86.24700],
        [180.000,500.000,0.0168102,3269.69,6.2222,3.119,624.51000,1.28890,29.71000,86.69100],
        [180.000,510.000,0.0172042,3300.53,6.2618,3.0506,631.65000,1.28840,30.12000,87.23700],
        [180.000,520.000,0.017589,3330.73,6.3002,2.9911,638.52000,1.28780,30.53000,87.87100],
        [180.000,530.000,0.0179656,3360.38,6.3373,2.9391,645.16000,1.28710,30.95000,88.58300],
        [180.000,540.000,0.018335,3389.54,6.3734,2.8935,651.58000,1.28640,31.35000,89.36300],
        [180.000,550.000,0.0186977,3418.27,6.4085,2.8533,657.80000,1.28570,31.76000,90.20500],
        [180.000,560.000,0.0190544,3446.62,6.4427,2.8179,663.85000,1.28490,32.17000,91.10200],
        [180.000,570.000,0.0194055,3474.64,6.4762,2.7864,669.73000,1.28410,32.57000,92.04900],
        [180.000,580.000,0.0197517,3502.36,6.5089,2.7585,675.47000,1.28330,32.97000,93.04000],
        [180.000,590.000,0.0200933,3529.82,6.5408,2.7336,681.06000,1.28250,33.37000,94.07200],
        [180.000,600.000,0.0204306,3557.04,6.5722,2.7114,686.53000,1.28160,33.77000,95.14200],
        [180.000,650.000,0.0220638,3690.42,6.7208,2.6313,712.27000,1.27740,35.75000,100.95000],
        [180.000,700.000,0.0236279,3820.74,6.8583,2.5859,735.86000,1.27320,37.68000,107.31000],
        [180.000,750.000,0.0251418,3949.37,6.9872,2.562,757.84000,1.26910,39.59000,114.12000],
        //[180.000,800.000,0.0266179,4077.18,7.1091,2.5525,778.51000,1.26500,41.47000,121.20000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_200_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[200.000,0.000,0.000990355,20.0338,0.0004733,4.129,1434.50000,103.89000,1751.20000,570.14000],
        [200.000,2.000,0.000990391,28.2906,0.030591,4.1278,1444.30000,105.32000,1639.70000,574.67000],
        [200.000,4.000,0.000990484,36.5454,0.060484,4.127,1453.70000,106.68000,1539.00000,579.04000],
        [200.000,6.000,0.00099063,44.799,0.090157,4.1265,1462.80000,107.99000,1448.00000,583.26000],
        [200.000,8.000,0.000990826,53.0518,0.11962,4.1263,1471.40000,109.25000,1365.20000,587.34000],
        [200.000,10.000,0.00099107,61.3043,0.14886,4.1262,1479.60000,110.45000,1289.80000,591.28000],
        [200.000,12.000,0.000991358,69.5568,0.17791,4.1263,1487.40000,111.59000,1220.80000,595.11000],
        [200.000,14.000,0.000991689,77.8096,0.20675,4.1265,1494.90000,112.68000,1157.60000,598.82000],
        [200.000,16.000,0.000992062,86.0628,0.23539,4.1267,1502.10000,113.71000,1099.50000,602.42000],
        [200.000,18.000,0.000992473,94.3166,0.26384,4.1271,1508.90000,114.70000,1045.90000,605.93000],
        [200.000,20.000,0.000992922,102.571,0.29209,4.1274,1515.30000,115.63000,996.40000,609.33000],
        [200.000,25.000,0.000994202,123.211,0.3619,4.1285,1530.10000,117.74000,887.91000,617.44000],
        [200.000,30.000,0.00099569,143.856,0.43057,4.1297,1543.00000,119.55000,797.30000,625.03000],
        [200.000,35.000,0.000997374,164.508,0.49814,4.131,1554.10000,121.09000,720.75000,632.13000],
        [200.000,40.000,0.00099924,185.166,0.56464,4.1325,1563.70000,122.35000,655.47000,638.77000],
        [200.000,45.000,0.00100128,205.833,0.63012,4.1342,1571.80000,123.36000,599.32000,644.99000],
        [200.000,50.000,0.00100348,226.509,0.6946,4.1361,1578.40000,124.14000,550.64000,650.78000],
        [200.000,55.000,0.00100585,247.195,0.75813,4.1384,1583.80000,124.69000,508.17000,656.18000],
        [200.000,60.000,0.00100837,267.893,0.82072,4.1409,1587.90000,125.03000,470.87000,661.19000],
        [200.000,65.000,0.00101103,288.604,0.88243,4.1437,1590.90000,125.17000,437.94000,665.82000],
        [200.000,70.000,0.00101385,309.33,0.94327,4.1468,1592.90000,125.13000,408.73000,670.08000],
        [200.000,75.000,0.0010168,330.073,1.0033,4.1503,1593.80000,124.91000,382.69000,673.98000],
        [200.000,80.000,0.0010199,350.834,1.0625,4.1542,1593.70000,124.52000,359.38000,677.53000],
        [200.000,85.000,0.00102313,371.615,1.1209,4.1584,1592.80000,123.98000,338.43000,680.73000],
        [200.000,90.000,0.00102651,392.419,1.1786,4.163,1591.00000,123.29000,319.53000,683.59000],
        [200.000,95.000,0.00103002,413.246,1.2356,4.168,1588.40000,122.47000,302.43000,686.13000],
        [200.000,100.000,0.00103366,434.1,1.2918,4.1734,1585.00000,121.52000,286.91000,688.34000],
        [200.000,110.000,0.00104137,475.892,1.4024,4.1853,1576.20000,119.28000,259.87000,691.81000],
        [200.000,120.000,0.00104964,517.811,1.5104,4.1989,1564.70000,116.63000,237.20000,694.07000],
        [200.000,130.000,0.00105847,559.877,1.616,4.2144,1550.80000,113.61000,218.02000,695.16000],
        [200.000,140.000,0.0010679,602.107,1.7195,4.232,1534.70000,110.28000,201.63000,695.14000],
        [200.000,150.000,0.00107795,644.524,1.8209,4.2518,1516.50000,106.67000,187.50000,694.06000],
        [200.000,160.000,0.00108865,687.152,1.9205,4.2742,1496.20000,102.82000,175.24000,691.94000],
        [200.000,170.000,0.00110005,730.018,2.0183,4.2996,1474.00000,98.76000,164.51000,689.03000],
        [200.000,180.000,0.00111219,773.155,2.1146,4.3284,1450.00000,94.51600,155.05000,685.34000],
        [200.000,190.000,0.00112515,816.599,2.2094,4.361,1424.00000,90.11200,146.65000,680.63000],
        [200.000,200.000,0.00113899,860.391,2.303,4.3982,1396.20000,85.57100,139.14000,675.00000],
        [200.000,210.000,0.0011538,904.58,2.3954,4.4405,1366.40000,80.91400,132.37000,668.48000],
        [200.000,220.000,0.0011697,949.222,2.4868,4.4889,1334.80000,76.16200,126.23000,661.11000],
        [200.000,230.000,0.00118681,994.382,2.5775,4.5444,1301.20000,71.33600,120.62000,652.89000],
        [200.000,240.000,0.0012053,1040.14,2.6675,4.6084,1265.70000,66.45700,115.45000,643.83000],
        [200.000,250.000,0.00122536,1086.58,2.7572,4.6824,1228.10000,61.54600,110.65000,633.92000],
        [200.000,260.000,0.00124724,1133.83,2.8466,4.7687,1188.50000,56.62200,106.16000,623.15000],
        [200.000,270.000,0.00127126,1182.01,2.9362,4.8701,1146.50000,51.70000,101.91000,611.51000],
        [200.000,280.000,0.00129784,1231.29,3.0261,4.9908,1102.10000,46.79200,97.84900,598.95000],
        [200.000,290.000,0.00132752,1281.91,3.1167,5.1366,1054.80000,41.90700,93.93100,585.42000],
        [200.000,300.000,0.00136109,1334.14,3.2087,5.3168,1004.30000,37.05000,90.09800,570.83000],
        [200.000,310.000,0.00139965,1388.4,3.3025,5.5459,949.79000,32.22600,86.29300,555.06000],
        [200.000,320.000,0.00144494,1445.3,3.3993,5.8491,890.30000,27.42800,82.44300,537.89000],
        [200.000,330.000,0.00149977,1505.79,3.5004,6.274,824.41000,22.65900,78.45000,519.00000],
        [200.000,340.000,0.00156931,1571.52,3.6085,6.9239,751.10000,17.97500,74.15900,497.81000],
        [200.000,350.000,0.00166487,1645.95,3.7288,8.1062,664.96000,13.28000,69.26600,473.33000],
        [200.000,360.000,0.00182472,1740.13,3.8787,11.46,542.74000,8.07160,62.79000,443.88000],
        [200.000,365.746,0.00203865,1827.1,4.0154,23.2,422.20000,4.37190,56.19800,432.42000],
        [200.000,365.746,0.00585828,2411.39,4.9299,45.677,384.50000,1.26180,27.40000,250.80000],
        [200.000,370.000,0.00692374,2526.48,5.1095,18.66,421.11000,1.28060,26.28500,168.42000],
        [200.000,380.000,0.00825779,2659.19,5.3144,10.221,461.33000,1.28860,25.82400,126.74000],
        [200.000,390.000,0.00918976,2747.17,5.4482,7.6925,487.08000,1.29080,25.89900,111.72000],
        [200.000,400.000,0.00994958,2816.84,5.5525,6.3601,507.34000,1.29350,26.13700,103.69000],
        [200.000,410.000,0.0106082,2876.05,5.6398,5.541,524.18000,1.29510,26.44900,98.77600],
        [200.000,420.000,0.0111994,2928.51,5.716,4.982,538.73000,1.29570,26.79900,95.54200],
        [200.000,430.000,0.0117416,2976.18,5.7843,4.5718,551.66000,1.29600,27.17200,93.34100],
        [200.000,440.000,0.0122459,3020.26,5.8466,4.2568,563.37000,1.29590,27.55800,91.83500],
        [200.000,450.000,0.0127202,3061.53,5.9041,4.0074,574.13000,1.29570,27.95300,90.82700],
        [200.000,460.000,0.0131699,3100.57,5.9577,3.8056,584.12000,1.29540,28.35300,90.19200],
        [200.000,470.000,0.0135992,3137.77,6.0081,3.6395,593.47000,1.29500,28.75500,89.84700],
        [200.000,480.000,0.0140113,3173.45,6.0558,3.501,602.28000,1.29450,29.16000,89.73300],
        [200.000,490.000,0.0144085,3207.86,6.1012,3.3841,610.63000,1.29390,29.56500,89.80700],
        [200.000,500.000,0.0147929,3241.19,6.1445,3.2845,618.58000,1.29330,29.97100,90.03900],
        [200.000,510.000,0.0151662,3273.59,6.1862,3.199,626.18000,1.29270,30.37600,90.40400],
        [200.000,520.000,0.0155296,3305.21,6.2263,3.1251,633.46000,1.29200,30.78000,90.88200],
        [200.000,530.000,0.0158842,3336.13,6.265,3.0608,640.47000,1.29120,31.18400,91.45900],
        [200.000,540.000,0.0162309,3366.45,6.3026,3.0046,647.23000,1.29040,31.58600,92.12200],
        [200.000,550.000,0.0165707,3396.24,6.339,2.9552,653.76000,1.28960,31.98700,92.86100],
        [200.000,560.000,0.016904,3425.57,6.3744,2.9116,660.09000,1.28880,32.38700,93.66800],
        [200.000,570.000,0.0172316,3454.49,6.4089,2.8731,666.23000,1.28790,32.78600,94.53400],
        [200.000,580.000,0.0175539,3483.05,6.4426,2.8389,672.20000,1.28700,33.18300,95.45600],
        [200.000,590.000,0.0178714,3511.28,6.4755,2.8084,678.02000,1.28620,33.58000,96.42500],
        [200.000,600.000,0.0181844,3539.23,6.5077,2.7812,683.69000,1.28530,33.97400,97.44000],
        [200.000,650.000,0.0196942,3675.59,6.6596,2.6824,710.26000,1.28080,35.92900,103.05000],
        [200.000,700.000,0.0211327,3808.15,6.7994,2.6251,734.48000,1.27640,37.85100,109.30000],
        [200.000,750.000,0.0225198,3938.52,6.9301,2.593,756.93000,1.27210,39.74500,116.07000],
        //[200.000,800.000,0.0238685,4067.73,7.0534,2.5775,777.99000,1.26790,41.61000,123.14000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_220_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[220.000,0.000,0.000989405,22.0098,0.0004596,4.1209,1437.80000,94.97800,1747.60000,571.53000],
        [220.000,2.000,0.000989454,30.2508,0.03052,4.1201,1447.70000,96.27500,1636.60000,576.02000],
        [220.000,4.000,0.000989558,38.4907,0.060358,4.1198,1457.10000,97.52000,1536.50000,580.34000],
        [220.000,6.000,0.000989715,46.73,0.08998,4.1196,1466.10000,98.71200,1445.90000,584.52000],
        [220.000,8.000,0.000989921,54.9693,0.11939,4.1197,1474.70000,99.85300,1363.50000,588.57000],
        [220.000,10.000,0.000990173,63.2089,0.14859,4.1199,1482.90000,100.94000,1288.40000,592.49000],
        [220.000,12.000,0.000990469,71.4491,0.17759,4.1203,1490.70000,101.98000,1219.70000,596.29000],
        [220.000,14.000,0.000990808,79.69,0.20639,4.1207,1498.20000,102.97000,1156.70000,599.97000],
        [220.000,16.000,0.000991186,87.9318,0.235,4.1211,1505.30000,103.92000,1098.70000,603.56000],
        [220.000,18.000,0.000991604,96.1745,0.2634,4.1216,1512.10000,104.81000,1045.30000,607.04000],
        [220.000,20.000,0.000992058,104.418,0.29162,4.1221,1518.60000,105.66000,995.97000,610.43000],
        [220.000,25.000,0.000993349,125.032,0.36135,4.1235,1533.30000,107.58000,887.78000,618.50000],
        [220.000,30.000,0.000994845,145.654,0.42994,4.125,1546.20000,109.24000,797.36000,626.06000],
        [220.000,35.000,0.000996534,166.282,0.49743,4.1265,1557.40000,110.63000,720.96000,633.15000],
        [220.000,40.000,0.000998403,186.919,0.56386,4.1282,1567.00000,111.79000,655.78000,639.78000],
        [220.000,45.000,0.00100044,207.564,0.62927,4.13,1575.10000,112.72000,599.69000,645.98000],
        [220.000,50.000,0.00100265,228.22,0.69369,4.1321,1581.80000,113.43000,551.07000,651.78000],
        [220.000,55.000,0.00100501,248.885,0.75715,4.1343,1587.20000,113.94000,508.63000,657.17000],
        [220.000,60.000,0.00100752,269.563,0.81969,4.1369,1591.40000,114.25000,471.36000,662.19000],
        [220.000,65.000,0.00101018,290.255,0.88134,4.1398,1594.40000,114.39000,438.45000,666.82000],
        [220.000,70.000,0.00101298,310.962,0.94212,4.1429,1596.40000,114.35000,409.25000,671.09000],
        [220.000,75.000,0.00101593,331.685,1.0021,4.1464,1597.30000,114.16000,383.22000,675.00000],
        [220.000,80.000,0.00101901,352.427,1.0612,4.1503,1597.40000,113.82000,359.91000,678.56000],
        [220.000,85.000,0.00102223,373.188,1.1196,4.1545,1596.50000,113.33000,338.96000,681.78000],
        [220.000,90.000,0.00102559,393.972,1.1772,4.1591,1594.80000,112.72000,320.07000,684.66000],
        [220.000,95.000,0.00102909,414.78,1.2341,4.164,1592.20000,111.98000,302.97000,687.21000],
        [220.000,100.000,0.00103272,435.613,1.2904,4.1693,1589.00000,111.13000,287.44000,689.43000],
        [220.000,110.000,0.00104038,477.363,1.4008,4.1811,1580.30000,109.11000,260.39000,692.94000],
        [220.000,120.000,0.0010486,519.239,1.5087,4.1945,1569.00000,106.71000,237.72000,695.24000],
        [220.000,130.000,0.00105739,561.259,1.6142,4.2097,1555.30000,103.99000,218.52000,696.38000],
        [220.000,140.000,0.00106675,603.44,1.7175,4.2269,1539.40000,100.97000,202.12000,696.41000],
        [220.000,150.000,0.00107673,645.804,1.8189,4.2463,1521.40000,97.71300,188.00000,695.37000],
        [220.000,160.000,0.00108735,688.375,1.9183,4.2683,1501.40000,94.23300,175.73000,693.30000],
        [220.000,170.000,0.00109866,731.179,2.016,4.2931,1479.50000,90.56200,164.99000,690.35000],
        [220.000,180.000,0.00111069,774.247,2.1121,4.3211,1455.70000,86.72500,155.53000,686.78000],
        [220.000,190.000,0.00112353,817.614,2.2068,4.3529,1430.10000,82.74300,147.12000,682.14000],
        [220.000,200.000,0.00113723,861.32,2.3001,4.3891,1402.60000,78.63700,139.61000,676.57000],
        [220.000,210.000,0.00115188,905.412,2.3923,4.4302,1373.30000,74.42600,132.85000,670.13000],
        [220.000,220.000,0.00116758,949.944,2.4836,4.4771,1342.20000,70.12900,126.71000,662.84000],
        [220.000,230.000,0.00118447,994.978,2.574,4.5309,1309.10000,65.76500,121.11000,654.71000],
        [220.000,240.000,0.00120269,1040.59,2.6637,4.5926,1274.10000,61.35300,115.95000,645.75000],
        [220.000,250.000,0.00122242,1086.86,2.753,4.6638,1237.20000,56.91300,111.17000,635.95000],
        [220.000,260.000,0.00124391,1133.9,2.8421,4.7464,1198.20000,52.46100,106.69000,625.31000],
        [220.000,270.000,0.00126744,1181.84,2.9312,4.8432,1157.10000,48.01400,102.46000,613.81000],
        [220.000,280.000,0.0012934,1230.82,3.0205,4.9576,1113.60000,43.58300,98.42900,601.42000],
        [220.000,290.000,0.00132229,1281.06,3.1105,5.0947,1067.50000,39.17600,94.54700,588.10000],
        [220.000,300.000,0.0013548,1332.82,3.2016,5.2623,1018.50000,34.80300,90.76200,573.76000],
        [220.000,310.000,0.0013919,1386.45,3.2944,5.4724,965.96000,30.47100,87.02000,558.31000],
        [220.000,320.000,0.00143507,1442.47,3.3896,5.7448,909.21000,26.18400,83.25800,541.56000],
        [220.000,330.000,0.00148663,1501.67,3.4886,6.1153,846.98000,21.93400,79.39400,523.24000],
        [220.000,340.000,0.00155059,1565.33,3.5933,6.6555,777.89000,17.73800,75.30700,502.92000],
        [220.000,350.000,0.00163487,1635.9,3.7074,7.5429,700.27000,13.63400,70.78800,479.81000],
        [220.000,360.000,0.00176017,1719.47,3.8404,9.4598,602.89000,9.38630,65.32500,452.51000],
        [220.000,370.000,0.00202856,1842.65,4.0333,18.352,452.83000,4.59480,56.68000,421.94000],
        [220.000,373.707,0.00275039,2021.92,4.3109,1163.9,315.24000,1.64230,43.22100,859.00000],
        [220.000,373.707,0.00357662,2164.18,4.5308,1707.2,326.11000,1.35160,35.62400,1010.20000],
        [220.000,380.000,0.00612498,2504.56,5.0556,19.419,420.44000,1.31180,27.88600,183.60000],
        [220.000,390.000,0.00737736,2643.66,5.2671,10.722,460.90000,1.30880,27.06100,137.30000],
        [220.000,400.000,0.00825503,2735.76,5.405,8.0332,487.13000,1.30660,26.97600,119.93000],
        [220.000,410.000,0.00896956,2808.37,5.5121,6.6169,507.74000,1.30640,27.11900,110.58000],
        [220.000,420.000,0.00958798,2869.89,5.6015,5.7489,524.85000,1.30590,27.36500,104.83000],
        [220.000,430.000,0.0101423,2924.25,5.6794,5.1572,539.62000,1.30500,27.66800,101.02000],
        [220.000,440.000,0.0106498,2973.55,5.7491,4.723,552.76000,1.30410,28.00300,98.40500],
        [220.000,450.000,0.0111214,3019.05,5.8124,4.3894,564.66000,1.30310,28.35900,96.58300],
        [220.000,460.000,0.0115644,3061.57,5.8708,4.1251,575.59000,1.30220,28.72800,95.32900],
        [220.000,470.000,0.0119839,3101.72,5.9252,3.9113,585.74000,1.30140,29.10700,94.49900],
        [220.000,480.000,0.012384,3139.92,5.9763,3.7354,595.25000,1.30050,29.49100,93.99600],
        [220.000,490.000,0.0127675,3176.52,6.0246,3.5887,604.20000,1.29970,29.87900,93.75300],
        [220.000,500.000,0.013137,3211.77,6.0704,3.4649,612.68000,1.29880,30.27000,93.72100],
        [220.000,510.000,0.0134943,3245.88,6.1143,3.3595,620.75000,1.29800,30.66300,93.86300],
        [220.000,520.000,0.013841,3279.01,6.1563,3.2689,628.46000,1.29710,31.05600,94.15200],
        [220.000,530.000,0.0141782,3311.3,6.1968,3.1906,635.85000,1.29620,31.45000,94.56700],
        [220.000,540.000,0.014507,3342.86,6.2358,3.1225,642.95000,1.29520,31.84300,95.08900],
        [220.000,550.000,0.0148284,3373.78,6.2736,3.0628,649.79000,1.29430,32.23600,95.70600],
        [220.000,560.000,0.0151431,3404.14,6.3103,3.0104,656.41000,1.29330,32.62900,96.40500],
        [220.000,570.000,0.0154516,3434.01,6.3459,2.964,662.81000,1.29240,33.02100,97.17800],
        [220.000,580.000,0.0157547,3463.44,6.3806,2.923,669.02000,1.29140,33.41300,98.01700],
        [220.000,590.000,0.0160527,3492.48,6.4145,2.8864,675.06000,1.29040,33.80300,98.91300],
        [220.000,600.000,0.0163461,3521.18,6.4475,2.8538,680.94000,1.28940,34.19200,99.86300],
        [220.000,650.000,0.0177555,3660.64,6.6029,2.7351,708.34000,1.28450,36.12400,105.24000],
        [220.000,700.000,0.0190916,3795.49,6.7451,2.6651,733.17000,1.27980,38.02900,111.36000],
        [220.000,750.000,0.0203752,3927.63,6.8776,2.6244,756.09000,1.27530,39.90700,118.07000],
        //[220.000,800.000,0.0216197,4058.25,7.0022,2.6029,777.51000,1.27100,41.76000,125.12000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

fn assert_pt_flash(
    p_bar: f64,
    t_deg_c: f64,
    v_m3_per_kg: f64,
    h_kj_per_kg: f64,
    s_kj_per_kg_k: f64,
    cp_kj_per_kg_k: f64,
    w_m_per_s: f64,
    kappa_dimensionless: f64,
    eta_micropascal_second: f64,
    lambda_milliwatt_per_meter_kelvin: f64,
){
    let p = Pressure::new::<bar>(p_bar);
    let t = ThermodynamicTemperature::new::<degree_celsius>(t_deg_c);
    let h_ref = AvailableEnergy::new::<kilojoule_per_kilogram>(h_kj_per_kg);
    let x = x_ph_flash(p, h_ref);

    // assert h
    let h_test = h_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        h_kj_per_kg,
        h_test.get::<kilojoule_per_kilogram>(),
        max_relative=5e-3
        );

    // assert volume to within 0.1%  (that's the tolerable error for 
    // backward eqn)
    let v_test = v_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        v_m3_per_kg,
        v_test.get::<cubic_meter_per_kilogram>(),
        max_relative=1e-3
        );

    // now entropy 
    let s_test = s_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        s_kj_per_kg_k,
        s_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=5e-4
        );

    // if at/near critical point, skip them tests
    // cp 
    if t_deg_c != 373.707 {
        let cp_test = cp_tp_eqm_two_phase(t, p, x);
        approx::assert_relative_eq!(
            cp_kj_per_kg_k,
            cp_test.get::<kilojoule_per_kilogram_kelvin>(),
            max_relative=1e-3
        );
        // w 
        let w_test = w_tp_eqm_two_phase(t, p, x);
        approx::assert_relative_eq!(
            w_m_per_s,
            w_test.get::<meter_per_second>(),
            max_relative=5e-3
        );

        // kappa
        let kappa_test = kappa_tp_eqm_two_phase(t, p, x);
        approx::assert_relative_eq!(
            kappa_dimensionless,
            kappa_test.get::<ratio>(),
            max_relative=9e-3
        );
        // if not at critical point, assert a tighter volume contorl
        approx::assert_relative_eq!(
            v_m3_per_kg,
            v_test.get::<cubic_meter_per_kilogram>(),
            max_relative=1e-4
        );
    }

    // eta and lambda tbd



}



