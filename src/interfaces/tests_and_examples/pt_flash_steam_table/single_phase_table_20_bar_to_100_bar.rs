use uom::si::available_energy::kilojoule_per_kilogram;
use uom::si::pressure::bar;
use uom::si::f64::*;
use uom::si::ratio::ratio;
use uom::si::specific_heat_capacity::kilojoule_per_kilogram_kelvin;
use uom::si::specific_volume::cubic_meter_per_kilogram;
use uom::si::thermodynamic_temperature::degree_celsius;
use uom::si::velocity::meter_per_second;

use crate::interfaces::functional_programming::{ph_flash_eqm::x_ph_flash, pt_flash_eqm::{cp_tp_eqm_two_phase, h_tp_eqm_two_phase, kappa_tp_eqm_two_phase, s_tp_eqm_two_phase, v_tp_eqm_two_phase, w_tp_eqm_two_phase}};

/// single phase table (see page 201)
///
/// NOTE: ph flash UNABLE to do triple point liquid and vapour accurately.
/// or even close to 0 degc
#[test]
pub fn single_phase_table_2_to_750_degc_20_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[20.000,0.000,0.000999193,1.99229,-0.00002608,4.21,1405.40000,988.40000,1787.50000,557.09000],
        [20.000,2.000,0.000999107,10.4062,0.030665,4.2041,1415.20000,1002.30000,1670.00000,562.05000],
        [20.000,4.000,0.000999088,18.8091,0.061094,4.199,1424.60000,1015.70000,1564.30000,566.81000],
        [20.000,6.000,0.000999132,27.2029,0.091271,4.1948,1433.70000,1028.60000,1469.00000,571.38000],
        [20.000,8.000,0.000999235,35.589,0.12121,4.1913,1442.30000,1040.90000,1382.70000,575.78000],
        [20.000,10.000,0.000999394,43.9685,0.1509,4.1883,1450.60000,1052.70000,1304.20000,580.01000],
        [20.000,12.000,0.000999605,52.3425,0.18038,4.1858,1458.40000,1063.90000,1232.60000,584.10000],
        [20.000,14.000,0.000999866,60.7118,0.20962,4.1836,1466.00000,1074.70000,1167.20000,588.04000],
        [20.000,16.000,0.00100018,69.0772,0.23865,4.1818,1473.10000,1084.90000,1107.20000,591.86000],
        [20.000,18.000,0.00100053,77.4392,0.26747,4.1802,1479.90000,1094.50000,1051.90000,595.55000],
        [20.000,20.000,0.00100093,85.7984,0.29609,4.1789,1486.40000,1103.70000,1001.00000,599.12000],
        [20.000,25.000,0.0010021,106.686,0.36674,4.1764,1501.20000,1124.40000,889.76000,607.59000],
        [20.000,30.000,0.00100352,127.564,0.43618,4.1749,1514.00000,1142.10000,797.19000,615.44000],
        [20.000,35.000,0.00100515,148.437,0.50447,4.1741,1525.00000,1156.90000,719.25000,622.73000],
        [20.000,40.000,0.001007,169.306,0.57166,4.1739,1534.40000,1169.00000,652.97000,629.50000],
        [20.000,45.000,0.00100903,190.177,0.63778,4.1743,1542.20000,1178.50000,596.10000,635.79000],
        [20.000,50.000,0.00101125,211.05,0.70287,4.1752,1548.50000,1185.60000,546.90000,641.62000],
        [20.000,55.000,0.00101365,231.929,0.76699,4.1766,1553.40000,1190.30000,504.06000,647.02000],
        [20.000,60.000,0.00101622,252.817,0.83016,4.1786,1557.10000,1193.00000,466.50000,652.01000],
        [20.000,65.000,0.00101896,273.716,0.89243,4.181,1559.60000,1193.60000,433.39000,656.59000],
        [20.000,70.000,0.00102185,294.628,0.95382,4.184,1561.00000,1192.30000,404.05000,660.78000],
        [20.000,75.000,0.00102491,315.556,1.0144,4.1874,1561.30000,1189.20000,377.93000,664.59000],
        [20.000,80.000,0.00102812,336.503,1.0741,4.1914,1560.60000,1184.40000,354.57000,668.03000],
        [20.000,85.000,0.00103148,357.471,1.1331,4.1958,1559.00000,1178.10000,333.59000,671.11000],
        [20.000,90.000,0.001035,378.462,1.1913,4.2008,1556.50000,1170.30000,314.69000,673.84000],
        [20.000,95.000,0.00103867,399.479,1.2487,4.2063,1553.10000,1161.20000,297.60000,676.24000],
        [20.000,100.000,0.00104249,420.526,1.3055,4.2123,1549.00000,1150.80000,282.10000,678.29000],
        [20.000,110.000,0.00105059,462.715,1.4171,4.2259,1538.40000,1126.40000,255.11000,681.44000],
        [20.000,120.000,0.00105932,505.051,1.5262,4.2418,1525.10000,1097.80000,232.51000,683.33000],
        [20.000,130.000,0.00106869,547.559,1.6329,4.2601,1509.20000,1065.60000,213.39000,684.04000],
        [20.000,140.000,0.00107873,590.263,1.7376,4.2812,1490.80000,1030.10000,197.06000,683.59000],
        [20.000,150.000,0.00108948,633.193,1.8403,4.3053,1470.10000,991.86000,183.00000,682.05000],
        [20.000,160.000,0.00110099,676.382,1.9411,4.333,1447.20000,951.08000,170.78000,679.66000],
        [20.000,170.000,0.00111332,719.867,2.0404,4.3647,1422.00000,908.11000,160.08000,676.39000],
        [20.000,180.000,0.00112654,763.691,2.1382,4.4011,1394.60000,863.22000,150.64000,672.04000],
        [20.000,190.000,0.00114075,807.906,2.2347,4.443,1365.00000,816.67000,142.23000,666.70000],
        [20.000,200.000,0.00115606,852.572,2.3301,4.4914,1333.20000,768.70000,134.70000,660.40000],
        [20.000,210.000,0.0011726,897.76,2.4246,4.5476,1299.00000,719.55000,127.89000,653.16000],
        [20.000,212.385,0.00117675,908.622,2.447,4.5623,1290.60000,707.68000,126.36000,651.29000],
        [20.000,212.385,0.0995805,2798.38,6.3392,3.1904,504.66000,1.27880,16.09100,40.93600],
        [20.000,220.000,0.102167,2821.67,6.3868,2.9487,512.58000,1.28580,16.45400,41.31300],
        [20.000,230.000,0.105394,2850.17,6.444,2.7665,521.47000,1.29010,16.92400,41.87400],
        [20.000,240.000,0.108488,2877.21,6.4972,2.6481,529.47000,1.29200,17.38800,42.49200],
        [20.000,250.000,0.111484,2903.23,6.5474,2.5602,536.96000,1.29310,17.84800,43.15800],
        [20.000,260.000,0.1144,2928.47,6.5952,2.4909,544.07000,1.29380,18.30300,43.86600],
        [20.000,270.000,0.117251,2953.09,6.641,2.4349,550.89000,1.29410,18.75500,44.61200],
        [20.000,280.000,0.120046,2977.21,6.685,2.389,557.44000,1.29430,19.20300,45.39300],
        [20.000,290.000,0.122794,3000.9,6.7274,2.3512,563.78000,1.29420,19.64900,46.20600],
        [20.000,300.000,0.125501,3024.25,6.7685,2.3201,569.91000,1.29400,20.09200,47.04800],
        [20.000,310.000,0.128174,3047.32,6.8084,2.2944,575.87000,1.29370,20.53300,47.91900],
        [20.000,320.000,0.130816,3070.16,6.8472,2.2733,581.67000,1.29320,20.97100,48.81500],
        [20.000,330.000,0.133431,3092.8,6.8851,2.2559,587.33000,1.29260,21.40800,49.73600],
        [20.000,340.000,0.136023,3115.28,6.9221,2.2417,592.86000,1.29200,21.84200,50.68100],
        [20.000,350.000,0.138594,3137.64,6.9582,2.2301,598.27000,1.29130,22.27500,51.64700],
        [20.000,360.000,0.141147,3159.89,6.9937,2.2207,603.57000,1.29050,22.70600,52.63300],
        [20.000,370.000,0.143683,3182.06,7.0284,2.2133,608.77000,1.28970,23.13600,53.63900],
        [20.000,380.000,0.146205,3204.16,7.0625,2.2074,613.88000,1.28880,23.56400,54.66400],
        [20.000,390.000,0.148712,3226.21,7.096,2.203,618.91000,1.28790,23.99100,55.70600],
        [20.000,400.000,0.151208,3248.23,7.129,2.1997,623.85000,1.28690,24.41700,56.76500],
        [20.000,410.000,0.153693,3270.21,7.1614,2.1974,628.72000,1.28600,24.84100,57.84000],
        [20.000,420.000,0.156167,3292.18,7.1933,2.1961,633.52000,1.28500,25.26400,58.93100],
        [20.000,430.000,0.158632,3314.14,7.2248,2.1955,638.25000,1.28400,25.68600,60.03600],
        [20.000,440.000,0.161088,3336.09,7.2558,2.1957,642.92000,1.28300,26.10600,61.15400],
        [20.000,450.000,0.163537,3358.05,7.2863,2.1964,647.52000,1.28190,26.52500,62.28600],
        [20.000,460.000,0.165978,3380.02,7.3165,2.1976,652.08000,1.28090,26.94400,63.43100],
        [20.000,470.000,0.168413,3402.01,7.3463,2.1994,656.57000,1.27990,27.36100,64.58800],
        [20.000,480.000,0.170841,3424.01,7.3757,2.2015,661.02000,1.27880,27.77600,65.75700],
        [20.000,490.000,0.173263,3446.04,7.4048,2.2041,665.41000,1.27770,28.19100,66.93700],
        [20.000,500.000,0.17568,3468.09,7.4335,2.2069,669.76000,1.27670,28.60500,68.12700],
        [20.000,510.000,0.178092,3490.18,7.4619,2.2101,674.06000,1.27560,29.01700,69.32800],
        [20.000,520.000,0.180499,3512.3,7.4899,2.2136,678.32000,1.27460,29.42900,70.53900],
        [20.000,530.000,0.182902,3534.45,7.5177,2.2173,682.54000,1.27350,29.83900,71.75900],
        [20.000,540.000,0.1853,3556.64,7.5451,2.2212,686.71000,1.27250,30.24900,72.98800],
        [20.000,550.000,0.187694,3578.88,7.5723,2.2254,690.85000,1.27140,30.65700,74.22600],
        [20.000,560.000,0.190085,3601.15,7.5992,2.2297,694.95000,1.27040,31.06400,75.47300],
        [20.000,570.000,0.192472,3623.47,7.6258,2.2342,699.01000,1.26930,31.47000,76.72800],
        [20.000,580.000,0.194856,3645.84,7.6522,2.2389,703.04000,1.26830,31.87500,77.99000],
        [20.000,590.000,0.197237,3668.25,7.6783,2.2437,707.03000,1.26720,32.27900,79.26000],
        [20.000,600.000,0.199614,3690.71,7.7042,2.2486,710.99000,1.26620,32.68200,80.53800],
        [20.000,650.000,0.211464,3803.79,7.8301,2.275,730.32000,1.26110,34.68100,87.02500],
        [20.000,700.000,0.22326,3918.24,7.9509,2.3035,748.96000,1.25620,36.65300,93.66000],
        [20.000,750.000,0.235015,4034.16,8.067,2.3333,766.98000,1.25150,38.60000,100.42000],
        //[20.000,800.000,0.246737,4151.59,8.1791,2.3642,784.44000,1.24700,40.52000,107.29000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_750_degc_40_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![

        //[40.000,0.000,0.000998184,4.02062,0.00008726,4.2003,1408.6000,496.9200,1783.2000,558.6000],
        [40.000,2.000,0.000998113,12.4157,0.03071,4.1949,1418.4000,503.9000,1666.3000,563.5100],
        [40.000,4.000,0.000998107,20.8009,0.061075,4.1904,1427.8000,510.6200,1561.3000,568.2200],
        [40.000,6.000,0.000998163,29.1779,0.091192,4.1867,1436.8000,517.0700,1466.5000,572.7500],
        [40.000,8.000,0.000998277,37.5481,0.12107,4.1835,1445.5000,523.2500,1380.6000,577.1000],
        [40.000,10.000,0.000998446,45.9125,0.15071,4.1809,1453.7000,529.1600,1302.4000,581.3000],
        [40.000,12.000,0.000998666,54.272,0.18013,4.1787,1461.6000,534.7900,1231.2000,585.3600],
        [40.000,14.000,0.000998936,62.6275,0.20933,4.1768,1469.1000,540.1700,1166.0000,589.2800],
        [40.000,16.000,0.000999252,70.9796,0.23832,4.1753,1476.3000,545.2800,1106.2000,593.0700],
        [40.000,18.000,0.000999613,79.3288,0.26709,4.1739,1483.1000,550.1300,1051.2000,596.7400],
        [40.000,20.000,0.00100002,87.6755,0.29566,4.1728,1489.6000,554.7200,1000.4000,600.2900],
        [40.000,25.000,0.0010012,108.534,0.36622,4.1708,1504.4000,565.1000,889.5100,608.7100],
        [40.000,30.000,0.00100263,129.385,0.43557,4.1696,1517.2000,573.9700,797.1600,616.5300],
        [40.000,35.000,0.00100427,150.231,0.50378,4.169,1528.2000,581.4000,719.3900,623.7900],
        [40.000,40.000,0.00100611,171.076,0.57088,4.1691,1537.6000,587.4800,653.2300,630.5500],
        [40.000,45.000,0.00100815,191.923,0.63692,4.1696,1545.4000,592.2700,596.4400,636.8300],
        [40.000,50.000,0.00101037,212.773,0.70195,4.1706,1551.8000,595.8400,547.3100,642.6600],
        [40.000,55.000,0.00101276,233.63,0.766,4.1722,1556.8000,598.2800,504.5100,648.0600],
        [40.000,55.000,0.00101276,233.63,0.766,4.1722,1556.8000,598.2800,504.5100,648.0600],
        [40.000,65.000,0.00101806,275.372,0.8913,4.1767,1563.1000,599.9800,433.8900,657.6300],
        [40.000,70.000,0.00102094,296.263,0.95263,4.1796,1564.5000,599.3800,404.5700,661.8200],
        [40.000,75.000,0.00102398,317.169,1.0131,4.1831,1564.9000,597.9000,378.4600,665.6400],
        [40.000,80.000,0.00102718,338.095,1.0728,4.1871,1564.3000,595.5700,355.1000,669.1000],
        [40.000,85.000,0.00103053,359.041,1.1317,4.1915,1562.8000,592.4700,334.1300,672.1900],
        [40.000,90.000,0.00103403,380.01,1.1898,4.1964,1560.3000,588.6400,315.2300,674.9400],
        [40.000,95.000,0.00103768,401.006,1.2473,4.2018,1557.1000,584.1200,298.1400,677.3500],
        [40.000,100.000,0.00104148,422.029,1.304,4.2078,1553.0000,578.9700,282.6400,679.4200],
        [40.000,110.000,0.00104953,464.172,1.4154,4.2212,1542.7000,566.9100,255.6400,682.6000],
        [40.000,110.000,0.00104953,464.172,1.4154,4.2212,1542.7000,566.9100,255.6400,682.6000],
        [40.000,130.000,0.00106751,548.916,1.631,4.2548,1513.9000,536.7600,213.9100,685.2900],
        [40.000,140.000,0.00107748,591.564,1.7355,4.2754,1495.9000,519.1700,197.5800,684.9000],
        [40.000,150.000,0.00108814,634.433,1.838,4.299,1475.5000,500.1700,183.5100,683.4000],
        [40.000,160.000,0.00109956,677.555,1.9388,4.326,1452.9000,479.9200,171.2900,681.0000],
        [40.000,170.000,0.00111177,720.966,2.0378,4.3569,1428.1000,458.5900,160.5800,677.8300],
        [40.000,180.000,0.00112486,764.707,2.1354,4.3923,1401.1000,436.3000,151.1400,673.5500],
        [40.000,190.000,0.00113892,808.829,2.2317,4.433,1372.0000,413.1800,142.7400,668.2800],
        [40.000,200.000,0.00115404,853.387,2.3269,4.4799,1340.6000,389.3500,135.2100,662.0600],
        [40.000,210.000,0.00117037,898.451,2.4212,4.5342,1307.1000,364.9300,128.4100,654.9000],
        [40.000,220.000,0.00118806,944.102,2.5147,4.5975,1271.2000,340.0300,122.2100,646.8200],
        [40.000,230.000,0.00120732,990.438,2.6077,4.6717,1232.9000,314.7600,116.5200,637.8100],
        [40.000,240.000,0.00122842,1037.58,2.7005,4.7595,1192.1000,289.2200,111.2400,627.8500],
        [40.000,250.000,0.00125169,1085.69,2.7933,4.8646,1148.5000,263.4500,106.3000,616.9000],
        [40.000,250.358,0.00125257,1087.43,2.7967,4.8688,1146.9000,262.5300,106.1200,616.5000],
        [40.000,250.358,0.0497766,2800.9,6.0697,4.0217,501.6400,1.2639,17.4430,50.4410],
        [40.000,260.000,0.051777,2837.19,6.1384,3.5536,513.7800,1.2746,17.9360,50.3430],
        [40.000,270.000,0.0536916,2871.2,6.2016,3.2702,524.2600,1.2797,18.4360,50.4590],
        [40.000,280.000,0.0554948,2902.88,6.2594,3.0774,533.5800,1.2826,18.9270,50.7220],
        [40.000,290.000,0.0572145,2932.91,6.3132,2.9332,542.1800,1.2844,19.4090,51.0980],
        [40.000,300.000,0.058868,2961.65,6.3638,2.8199,550.2300,1.2857,19.8850,51.5650],
        [40.000,310.000,0.0604671,2989.38,6.4118,2.7285,557.8500,1.2866,20.3550,52.1070],
        [40.000,320.000,0.0620211,3016.28,6.4575,2.6536,565.1000,1.2872,20.8200,52.7150],
        [40.000,330.000,0.0635367,3042.49,6.5014,2.5915,572.0400,1.2876,21.2800,53.3810],
        [40.000,340.000,0.0650195,3068.14,6.5435,2.5399,578.7100,1.2877,21.7360,54.0970],
        [40.000,350.000,0.066474,3093.32,6.5843,2.4967,585.1400,1.2877,22.1880,54.8590],
        [40.000,360.000,0.067904,3118.1,6.6237,2.4604,591.3500,1.2875,22.6370,55.6630],
        [40.000,370.000,0.0693123,3142.55,6.662,2.4299,597.3800,1.2871,23.0830,56.5050],
        [40.000,380.000,0.0707017,3166.71,6.6993,2.4042,603.2300,1.2867,23.5250,57.3810],
        [40.000,390.000,0.0720743,3190.64,6.7357,2.3825,608.9300,1.2862,23.9650,58.2890],
        [40.000,400.000,0.0734318,3214.37,6.7712,2.3642,614.4900,1.2855,24.4030,59.2270],
        [40.000,410.000,0.0747759,3237.94,6.8059,2.3488,619.9200,1.2849,24.8380,60.1930],
        [40.000,420.000,0.0761079,3261.36,6.84,2.3359,625.2400,1.2841,25.2710,61.1840],
        [40.000,430.000,0.077429,3284.66,6.8734,2.3251,630.4500,1.2833,25.7020,62.1990],
        [40.000,440.000,0.0787401,3307.87,6.9061,2.3162,635.5600,1.2825,26.1300,63.2370],
        [40.000,450.000,0.0800422,3330.99,6.9383,2.3088,640.5800,1.2816,26.5570,64.2950],
        [40.000,460.000,0.081336,3354.05,6.97,2.3027,645.5100,1.2807,26.9820,65.3740],
        [40.000,470.000,0.0826222,3377.05,7.0012,2.2979,650.3600,1.2798,27.4050,66.4710],
        [40.000,480.000,0.0839015,3400.01,7.0318,2.2941,655.1400,1.2789,27.8270,67.5860],
        [40.000,490.000,0.0851742,3422.94,7.0621,2.2913,659.8400,1.2780,28.2470,68.7170],
        [40.000,500.000,0.086441,3445.84,7.0919,2.2892,664.4800,1.2770,28.6660,69.8650],
        [40.000,510.000,0.0877022,3468.72,7.1213,2.2879,669.0600,1.2760,29.0820,71.0270],
        [40.000,520.000,0.0889583,3491.6,7.1503,2.2872,673.5800,1.2751,29.4980,72.2030],
        [40.000,530.000,0.0902096,3514.47,7.179,2.2871,678.0400,1.2741,29.9120,73.3930],
        [40.000,540.000,0.0914564,3537.34,7.2073,2.2875,682.4400,1.2731,30.3240,74.5960],
        [40.000,550.000,0.092699,3560.22,7.2353,2.2883,686.8000,1.2721,30.7360,75.8110],
        [40.000,560.000,0.0939376,3583.11,7.2629,2.2896,691.1000,1.2711,31.1450,77.0370],
        [40.000,570.000,0.0951726,3606.01,7.2902,2.2913,695.3600,1.2701,31.5540,78.2740],
        [40.000,580.000,0.0964041,3628.93,7.3172,2.2933,699.5800,1.2692,31.9610,79.5220],
        [40.000,590.000,0.0976323,3651.88,7.344,2.2956,703.7500,1.2682,32.3670,80.7800],
        [40.000,600.000,0.0988574,3674.85,7.3704,2.2982,707.8700,1.2672,32.7720,82.0470],
        [40.000,650.000,0.104943,3790.15,7.4989,2.3149,727.9400,1.2624,34.7770,88.5130],
        [40.000,700.000,0.110973,3906.41,7.6215,2.336,747.1700,1.2577,36.7520,95.1620],
        [40.000,750.000,0.116961,4023.8,7.7391,2.3601,765.6800,1.2531,38.6990,101.9600],
        //[40.000,800.000,0.122915,4142.46,7.8523,2.3865,783.5500,1.2487,40.6180,108.8800],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_750_degc_60_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[60.000,0.000,0.000997183,6.04286,0.0001856,4.1908,1411.80000,333.11000,1778.90000,560.09000],
        [60.000,2.000,0.000997126,14.4195,0.030741,4.186,1421.60000,337.78000,1662.80000,564.95000],
        [60.000,4.000,0.000997133,22.7873,0.061042,4.182,1431.00000,342.27000,1558.30000,569.61000],
        [60.000,6.000,0.000997201,31.1478,0.0911,4.1787,1440.00000,346.58000,1464.00000,574.10000],
        [60.000,8.000,0.000997326,39.5024,0.12092,4.1759,1448.70000,350.71000,1378.50000,578.42000],
        [60.000,10.000,0.000997504,47.8519,0.15051,4.1737,1456.90000,354.65000,1300.70000,582.59000],
        [60.000,12.000,0.000997733,56.1973,0.17988,4.1718,1464.80000,358.42000,1229.80000,586.61000],
        [60.000,14.000,0.000998011,64.5391,0.20904,4.1702,1472.30000,362.01000,1164.90000,590.50000],
        [60.000,16.000,0.000998335,72.8781,0.23798,4.1689,1479.50000,365.42000,1105.30000,594.27000],
        [60.000,18.000,0.000998702,81.2147,0.26671,4.1678,1486.30000,368.66000,1050.40000,597.91000],
        [60.000,20.000,0.000999112,89.5493,0.29524,4.1668,1492.80000,371.73000,999.86000,601.45000],
        [60.000,25.000,0.00100031,110.379,0.36569,4.1652,1507.60000,378.67000,889.26000,609.83000],
        [60.000,30.000,0.00100174,131.203,0.43496,4.1643,1520.40000,384.60000,797.14000,617.61000],
        [60.000,35.000,0.00100339,152.024,0.50308,4.1641,1531.50000,389.58000,719.54000,624.86000],
        [60.000,40.000,0.00100524,172.844,0.5701,4.1643,1540.90000,393.65000,653.49000,631.60000],
        [60.000,45.000,0.00100727,193.667,0.63607,4.165,1548.70000,396.87000,596.79000,637.87000],
        [60.000,50.000,0.00100949,214.495,0.70103,4.1661,1555.10000,399.28000,547.72000,643.69000],
        [60.000,55.000,0.00101188,235.329,0.76501,4.1678,1560.20000,400.93000,504.96000,649.09000],
        [60.000,60.000,0.00101444,256.173,0.82805,4.1698,1564.00000,401.87000,467.46000,654.07000],
        [60.000,65.000,0.00101716,277.028,0.89018,4.1724,1566.60000,402.13000,434.40000,658.66000],
        [60.000,70.000,0.00102004,297.898,0.95145,4.1754,1568.10000,401.76000,405.09000,662.87000],
        [60.000,75.000,0.00102307,318.783,1.0119,4.1788,1568.50000,400.81000,378.98000,666.70000],
        [60.000,80.000,0.00102625,339.687,1.0715,4.1828,1568.00000,399.29000,355.64000,670.16000],
        [60.000,85.000,0.00102958,360.612,1.1303,4.1872,1566.50000,397.26000,334.67000,673.27000],
        [60.000,90.000,0.00103307,381.559,1.1884,4.1921,1564.20000,394.74000,315.77000,676.04000],
        [60.000,95.000,0.0010367,402.533,1.2458,4.1974,1561.00000,391.77000,298.68000,678.46000],
        [60.000,100.000,0.00104048,423.535,1.3024,4.2033,1557.10000,388.37000,283.17000,680.55000],
        [60.000,110.000,0.00104849,465.632,1.4138,4.2165,1547.00000,380.41000,256.17000,683.77000],
        [60.000,120.000,0.0010571,507.871,1.5226,4.2318,1534.10000,371.05000,233.56000,685.75000],
        [60.000,130.000,0.00106635,550.276,1.6291,4.2495,1518.70000,360.47000,214.43000,686.54000],
        [60.000,140.000,0.00107624,592.869,1.7335,4.2697,1500.90000,348.83000,198.09000,686.19000],
        [60.000,150.000,0.00108682,635.679,1.8358,4.2927,1480.80000,336.25000,184.01000,684.75000],
        [60.000,160.000,0.00109814,678.735,1.9364,4.3191,1458.50000,322.85000,171.79000,682.26000],
        [60.000,170.000,0.00111024,722.073,2.0353,4.3492,1434.10000,308.72000,161.08000,679.26000],
        [60.000,180.000,0.00112321,765.733,2.1327,4.3837,1407.50000,293.96000,151.64000,675.05000],
        [60.000,190.000,0.00113711,809.763,2.2289,4.4232,1378.80000,278.65000,143.24000,669.85000],
        [60.000,200.000,0.00115205,854.217,2.3238,4.4687,1348.00000,262.87000,135.71000,663.71000],
        [60.000,210.000,0.00116817,899.16,2.4178,4.5213,1314.90000,246.69000,128.92000,656.64000],
        [60.000,220.000,0.00118561,944.671,2.511,4.5823,1279.70000,230.19000,122.73000,648.65000],
        [60.000,230.000,0.00120456,990.841,2.6037,4.6537,1242.00000,213.45000,117.05000,639.75000],
        [60.000,240.000,0.00122528,1037.79,2.6961,4.7378,1202.00000,196.52000,111.79000,629.91000],
        [60.000,250.000,0.00124808,1085.65,2.7885,4.8379,1159.30000,179.46000,106.86000,619.12000],
        [60.000,260.000,0.00127338,1134.61,2.8812,4.9589,1113.50000,162.29000,102.21000,607.32000],
        [60.000,270.000,0.00130177,1184.92,2.9747,5.1082,1064.20000,145.00000,97.74400,594.46000],
        [60.000,275.586,0.00131927,1213.73,3.0274,5.208,1034.80000,135.28000,95.31000,586.78000],
        [60.000,275.586,0.0324487,2784.56,5.8901,4.8768,494.01000,1.25350,18.44000,59.06500],
        [60.000,280.000,0.0331998,2805.25,5.9276,4.516,501.07000,1.26040,18.67700,58.55300],
        [60.000,290.000,0.0347631,2847.5,6.0033,3.9812,514.56000,1.26940,19.20200,57.84100],
        [60.000,300.000,0.0361911,2885.49,6.0702,3.6378,526.04000,1.27430,19.71300,57.51500],
        [60.000,310.000,0.037523,2920.58,6.1309,3.3929,536.29000,1.27750,20.21300,57.44200],
        [60.000,320.000,0.0387819,2953.55,6.187,3.2078,545.69000,1.27970,20.70500,57.55200],
        [60.000,330.000,0.0399833,2984.87,6.2393,3.0626,554.43000,1.28130,21.18800,57.80400],
        [60.000,340.000,0.0411378,3014.89,6.2887,2.9459,562.64000,1.28250,21.66500,58.17100],
        [60.000,350.000,0.0422535,3043.86,6.3356,2.8504,570.41000,1.28340,22.13500,58.63300],
        [60.000,360.000,0.0433364,3071.96,6.3803,2.7714,577.79000,1.28390,22.60100,59.17800],
        [60.000,370.000,0.0443912,3099.33,6.4232,2.7054,584.85000,1.28420,23.06100,59.79300],
        [60.000,380.000,0.045422,3126.1,6.4645,2.6499,591.62000,1.28430,23.51700,60.47000],
        [60.000,390.000,0.0464317,3152.36,6.5044,2.603,598.14000,1.28420,23.96900,61.20200],
        [60.000,400.000,0.047423,3178.18,6.5431,2.5632,604.44000,1.28400,24.41700,61.98400],
        [60.000,410.000,0.048398,3203.64,6.5806,2.5293,610.54000,1.28370,24.86200,62.81000],
        [60.000,420.000,0.0493586,3228.79,6.6171,2.5004,616.47000,1.28320,25.30400,63.67700],
        [60.000,430.000,0.0503063,3253.66,6.6528,2.4757,622.23000,1.28270,25.74300,64.58100],
        [60.000,440.000,0.0512425,3278.31,6.6876,2.4545,627.84000,1.28210,26.17900,65.51900],
        [60.000,450.000,0.0521683,3302.76,6.7216,2.4364,633.32000,1.28140,26.61200,66.48900],
        [60.000,460.000,0.0530847,3327.05,6.755,2.4209,638.68000,1.28070,27.04300,67.48700],
        [60.000,470.000,0.0539925,3351.19,6.7877,2.4077,643.93000,1.27990,27.47200,68.51300],
        [60.000,480.000,0.0548925,3375.21,6.8198,2.3964,649.07000,1.27910,27.89800,69.56300],
        [60.000,490.000,0.0557854,3399.12,6.8513,2.3868,654.12000,1.27830,28.32300,70.63700],
        [60.000,500.000,0.0566717,3422.95,6.8824,2.3787,659.07000,1.27750,28.74500,71.73300],
        [60.000,510.000,0.0575519,3446.7,6.9129,2.3719,663.95000,1.27660,29.16500,72.84900],
        [60.000,520.000,0.0584266,3470.39,6.9429,2.3663,668.74000,1.27570,29.58400,73.98400],
        [60.000,530.000,0.059296,3494.03,6.9726,2.3616,673.46000,1.27480,30.00100,75.13800],
        [60.000,540.000,0.0601607,3517.63,7.0018,2.3579,678.11000,1.27390,30.41600,76.30800],
        [60.000,550.000,0.0610209,3541.19,7.0306,2.355,682.70000,1.27300,30.83000,77.49500],
        [60.000,560.000,0.0618769,3564.73,7.059,2.3528,687.22000,1.27210,31.24200,78.69600],
        [60.000,570.000,0.062729,3588.25,7.087,2.3512,691.69000,1.27120,31.65200,79.91200],
        [60.000,580.000,0.0635775,3611.76,7.1148,2.3503,696.09000,1.27020,32.06100,81.14100],
        [60.000,590.000,0.0644225,3635.26,7.1421,2.3498,700.45000,1.26930,32.46800,82.38300],
        [60.000,600.000,0.0652644,3658.76,7.1692,2.3499,704.75000,1.26840,32.87400,83.63700],
        [60.000,650.000,0.0694316,3776.36,7.3002,2.3559,725.58000,1.26380,34.88300,90.06800],
        [60.000,700.000,0.0735419,3894.47,7.4248,2.3692,745.42000,1.25930,36.85900,96.71900],
        [60.000,750.000,0.0776087,4013.37,7.5439,2.3874,764.42000,1.25490,38.80500,103.54700],
        //[60.000,800.000,0.0816416,4133.27,7.6583,2.4092,782.69000,1.25060,40.72100,110.51200],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_750_degc_80_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[80.000,0.000,0.000996188,8.05907,0.0002693,4.1814,1414.9000,251.2200,1774.7000,561.5600],
        [80.000,2.000,0.000996145,16.4176,0.030758,4.1772,1424.8000,254.7300,1659.3000,566.3700],
        [80.000,4.000,0.000996165,24.7683,0.060998,4.1737,1434.2000,258.1000,1555.4000,571.0000],
        [80.000,6.000,0.000996245,33.1127,0.090998,4.1708,1443.2000,261.3400,1461.5000,575.4400],
        [80.000,8.000,0.00099638,41.4519,0.12076,4.1685,1451.9000,264.4400,1376.5000,579.7300],
        [80.000,10.000,0.000996568,49.7868,0.15031,4.1665,1460.1000,267.4100,1299.1000,583.8600],
        [80.000,12.000,0.000996806,58.1182,0.17963,4.1649,1468.0000,270.2400,1228.4000,587.8500],
        [80.000,14.000,0.000997092,66.4467,0.20873,4.1636,1475.5000,272.9400,1163.7000,591.7200],
        [80.000,16.000,0.000997423,74.7728,0.23763,4.1625,1482.7000,275.5000,1104.4000,595.4600],
        [80.000,18.000,0.000997797,83.097,0.26632,4.1617,1489.5000,277.9400,1049.7000,599.0800],
        [80.000,20.000,0.000998213,91.4196,0.2948,4.1609,1496.0000,280.2400,999.3100,602.6000],
        [80.000,25.000,0.000999424,112.221,0.36516,4.1597,1510.7000,285.4600,889.0300,610.9400],
        [80.000,30.000,0.00100086,133.018,0.43434,4.1592,1523.6000,289.9200,797.1400,618.6900],
        [80.000,35.000,0.00100252,153.814,0.50238,4.1591,1534.7000,293.6700,719.6900,625.9100],
        [80.000,40.000,0.00100437,174.61,0.56932,4.1596,1544.1000,296.7400,653.7600,632.6400],
        [80.000,45.000,0.0010064,195.41,0.63522,4.1604,1552.0000,299.1700,597.1400,638.9000],
        [80.000,50.000,0.00100862,216.215,0.70011,4.1617,1558.5000,301.0000,548.1300,644.7200],
        [80.000,55.000,0.00101101,237.028,0.76402,4.1634,1563.6000,302.2600,505.4100,650.1100],
        [80.000,60.000,0.00101356,257.85,0.82699,4.1656,1567.4000,302.9900,467.9500,655.1000],
        [80.000,65.000,0.00101627,278.684,0.88906,4.1681,1570.1000,303.2100,434.9000,659.7000],
        [80.000,70.000,0.00101913,299.532,0.95027,4.1712,1571.6000,302.9600,405.6100,663.9100],
        [80.000,75.000,0.00102215,320.396,1.0106,4.1746,1572.2000,302.2600,379.5100,667.7500],
        [80.000,80.000,0.00102532,341.279,1.0702,4.1786,1571.7000,301.1500,356.1700,671.2300],
        [80.000,85.000,0.00102864,362.183,1.129,4.1829,1570.3000,299.6600,335.2100,674.3500],
        [80.000,90.000,0.00103211,383.109,1.187,4.1878,1568.1000,297.7900,316.3100,677.1300],
        [80.000,95.000,0.00103572,404.061,1.2443,4.1931,1565.0000,295.5900,299.2200,679.5600],
        [80.000,100.000,0.00103948,425.041,1.3009,4.1989,1561.1000,293.0700,283.7100,681.6700],
        [80.000,110.000,0.00104745,467.093,1.4121,4.2119,1551.2000,287.1500,256.7100,684.9300],
        [80.000,120.000,0.00105601,509.285,1.5208,4.2269,1538.5000,280.1900,234.0900,686.9500],
        [80.000,130.000,0.00106519,551.639,1.6272,4.2442,1523.4000,272.3200,214.9500,687.7800],
        [80.000,140.000,0.00107502,594.178,1.7314,4.264,1505.8000,263.6500,198.6000,687.4800],
        [80.000,150.000,0.00108552,636.929,1.8337,4.2866,1486.0000,254.2900,184.5200,686.1000],
        [80.000,160.000,0.00109674,679.921,1.9341,4.3123,1464.1000,244.3000,172.2900,683.6600],
        [80.000,170.000,0.00110874,723.187,2.0328,4.3417,1440.0000,233.7800,161.5800,680.6900],
        [80.000,180.000,0.00112157,766.768,2.1301,4.3752,1413.8000,222.7800,152.1300,676.5400],
        [80.000,190.000,0.00113533,810.708,2.226,4.4137,1385.6000,211.3700,143.7300,671.4100],
        [80.000,200.000,0.0011501,855.061,2.3207,4.4578,1355.2000,199.6100,136.2100,665.3500],
        [80.000,210.000,0.00116601,899.887,2.4145,4.5087,1322.7000,187.5500,129.4200,658.3600],
        [80.000,220.000,0.0011832,945.262,2.5074,4.5677,1288.0000,175.2500,123.2500,650.4700],
        [80.000,230.000,0.00120186,991.273,2.5998,4.6363,1251.0000,162.7700,117.5800,641.6700],
        [80.000,240.000,0.00122222,1038.03,2.6918,4.7169,1211.6000,150.1500,112.3300,631.9500],
        [80.000,250.000,0.00124457,1085.66,2.7837,4.8125,1169.8000,137.4300,107.4300,621.3000],
        [80.000,260.000,0.0012693,1134.34,2.8759,4.9272,1125.0000,124.6500,102.8000,609.6700],
        [80.000,270.000,0.00129694,1184.29,2.9687,5.0674,1077.0000,111.8000,98.3760,597.0100],
        [80.000,280.000,0.00132823,1235.81,3.0627,5.2431,1024.9000,98.8650,94.0900,583.2300],
        [80.000,290.000,0.00136429,1289.33,3.1586,5.4713,967.7200,85.8030,89.8660,568.1800],
        [80.000,295.009,0.00138466,1317.08,3.2077,5.614,936.7300,79.2120,87.7450,560.0900],
        [80.000,295.009,0.0235275,2758.61,5.7448,5.8831,484.0700,1.2450,19.3260,68.0520],
        [80.000,300.000,0.0242802,2786.38,5.7935,5.287,493.5600,1.2541,19.5960,66.7090],
        [80.000,310.000,0.0256318,2835.27,5.8781,4.5559,509.1100,1.2640,20.1250,65.0070],
        [80.000,320.000,0.0268425,2878.35,5.9514,4.0905,522.1600,1.2697,20.6400,64.0290],
        [80.000,330.000,0.0279551,2917.53,6.0169,3.762,533.6900,1.2736,21.1450,63.4890],
        [80.000,340.000,0.0289946,2953.87,6.0766,3.5176,544.1200,1.2764,21.6390,63.2470],
        [80.000,350.000,0.0299776,2988.06,6.1319,3.3288,553.7100,1.2785,22.1260,63.2230],
        [80.000,360.000,0.0309152,3020.57,6.1837,3.1789,562.6400,1.2800,22.6050,63.3700],
        [80.000,370.000,0.0318155,3051.73,6.2325,3.0573,571.0200,1.2811,23.0780,63.6520],
        [80.000,380.000,0.0326848,3081.79,6.2789,2.9572,578.9400,1.2818,23.5460,64.0480],
        [80.000,390.000,0.0335276,3110.93,6.3232,2.8738,586.4600,1.2823,24.0080,64.5390],
        [80.000,400.000,0.0343477,3139.31,6.3657,2.8037,593.6500,1.2825,24.4650,65.1110],
        [80.000,410.000,0.0351482,3167.04,6.4066,2.7444,600.5400,1.2826,24.9180,65.7550],
        [80.000,420.000,0.0359315,3194.23,6.4461,2.6939,607.1700,1.2825,25.3670,66.4620],
        [80.000,430.000,0.0366996,3220.95,6.4843,2.6507,613.5600,1.2822,25.8120,67.2250],
        [80.000,440.000,0.0374543,3247.26,6.5215,2.6136,619.7500,1.2819,26.2540,68.0390],
        [80.000,450.000,0.038197,3273.23,6.5577,2.5817,625.7500,1.2814,26.6930,68.8980],
        [80.000,460.000,0.038929,3298.91,6.5929,2.5541,631.5900,1.2809,27.1280,69.7980],
        [80.000,470.000,0.0396513,3324.33,6.6274,2.5303,637.2700,1.2803,27.5610,70.7360],
        [80.000,480.000,0.0403649,3349.53,6.6611,2.5097,642.8200,1.2796,27.9920,71.7080],
        [80.000,490.000,0.0410706,3374.53,6.694,2.4919,648.2400,1.2789,28.4190,72.7130],
        [80.000,500.000,0.0417691,3399.37,6.7264,2.4765,653.5400,1.2782,28.8450,73.7460],
        [80.000,510.000,0.0424609,3424.07,6.7581,2.4631,658.7300,1.2774,29.2680,74.8070],
        [80.000,520.000,0.0431467,3448.64,6.7893,2.4516,663.8200,1.2766,29.6890,75.8930],
        [80.000,530.000,0.0438269,3473.11,6.8199,2.4416,668.8200,1.2758,30.1080,77.0030],
        [80.000,540.000,0.0445019,3497.48,6.8501,2.4331,673.7300,1.2750,30.5250,78.1350],
        [80.000,550.000,0.0451721,3521.77,6.8798,2.4258,678.5600,1.2741,30.9400,79.2870],
        [80.000,560.000,0.0458379,3546.0,6.9091,2.4196,683.3100,1.2733,31.3530,80.4580],
        [80.000,570.000,0.0464996,3570.17,6.9379,2.4144,687.9900,1.2724,31.7640,81.6470],
        [80.000,580.000,0.0471574,3594.29,6.9663,2.4101,692.6000,1.2715,32.1740,82.8530],
        [80.000,590.000,0.0478117,3618.37,6.9944,2.4066,697.1500,1.2707,32.5820,84.0750],
        [80.000,600.000,0.0484625,3642.42,7.0221,2.4038,701.6400,1.2698,32.9890,85.3120],
        [80.000,650.000,0.0516732,3762.42,7.1557,2.3983,723.2500,1.2654,34.9990,91.6920],
        [80.000,700.000,0.0548251,3882.42,7.2823,2.4032,743.7000,1.2610,36.9740,98.3330],
        [80.000,750.000,0.0579325,4002.86,7.403,2.4152,763.2000,1.2568,38.9180,105.1800],
        //[80.000,800.000,0.0610054,4124.02,7.5186,2.4322,781.8800,1.2526,40.8310,112.1900],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_100_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[100.000,0.000,0.0009952,10.0693,0.0003384,4.1723,1418.20000,202.09000,1770.60000,563.03000],
        [100.000,2.000,0.000995171,18.41,0.030762,4.1686,1428.00000,204.90000,1655.80000,567.79000],
        [100.000,4.000,0.000995203,26.744,0.060942,4.1655,1437.40000,207.61000,1552.50000,572.37000],
        [100.000,6.000,0.000995294,35.0726,0.090884,4.1631,1446.40000,210.21000,1459.10000,576.77000],
        [100.000,8.000,0.00099544,43.3967,0.1206,4.1611,1455.10000,212.69000,1374.50000,581.02000],
        [100.000,10.000,0.000995638,51.7173,0.15009,4.1595,1463.30000,215.07000,1297.40000,585.12000],
        [100.000,12.000,0.000995884,60.0349,0.17936,4.1582,1471.20000,217.34000,1227.10000,589.09000],
        [100.000,14.000,0.000996178,68.3503,0.20842,4.1572,1478.70000,219.50000,1162.60000,592.92000],
        [100.000,16.000,0.000996516,76.6637,0.23727,4.1563,1485.90000,221.56000,1103.50000,596.64000],
        [100.000,18.000,0.000996897,84.9757,0.26592,4.1557,1492.70000,223.51000,1049.00000,600.24000],
        [100.000,20.000,0.000997318,93.2865,0.29437,4.1551,1499.20000,225.36000,998.78000,603.74000],
        [100.000,25.000,0.000998541,114.06,0.36463,4.1543,1514.00000,229.54000,888.81000,612.04000],
        [100.000,30.000,0.000999989,134.831,0.43372,4.1541,1526.80000,233.12000,797.14000,619.76000],
        [100.000,35.000,0.00100165,155.601,0.50168,4.1543,1537.90000,236.13000,719.85000,626.96000],
        [100.000,40.000,0.0010035,176.374,0.56855,4.1549,1547.40000,238.60000,654.03000,633.67000],
        [100.000,45.000,0.00100554,197.151,0.63437,4.1559,1555.30000,240.56000,597.49000,639.92000],
        [100.000,50.000,0.00100775,217.934,0.69919,4.1573,1561.80000,242.04000,548.54000,645.74000],
        [100.000,55.000,0.00101013,238.725,0.76303,4.1591,1566.90000,243.06000,505.86000,651.13000],
        [100.000,60.000,0.00101268,259.526,0.82594,4.1613,1570.80000,243.66000,468.43000,656.13000],
        [100.000,65.000,0.00101538,280.339,0.88795,4.1639,1573.60000,243.86000,435.41000,660.73000],
        [100.000,70.000,0.00101824,301.166,0.94909,4.167,1575.20000,243.67000,406.13000,664.95000],
        [100.000,75.000,0.00102125,322.009,1.0094,4.1705,1575.80000,243.14000,380.04000,668.80000],
        [100.000,80.000,0.00102441,342.871,1.0689,4.1744,1575.40000,242.27000,356.71000,672.29000],
        [100.000,85.000,0.00102771,363.754,1.1276,4.1787,1574.10000,241.09000,335.75000,675.42000],
        [100.000,90.000,0.00103116,384.659,1.1856,4.1835,1571.90000,239.62000,316.85000,678.21000],
        [100.000,95.000,0.00103475,405.59,1.2428,4.1888,1568.90000,237.88000,299.76000,680.67000],
        [100.000,100.000,0.0010385,426.548,1.2994,4.1945,1565.10000,235.89000,284.25000,682.79000],
        [100.000,110.000,0.00104641,468.555,1.4105,4.2073,1555.40000,231.20000,257.24000,686.08000],
        [100.000,120.000,0.00105493,510.701,1.519,4.2221,1543.00000,225.68000,234.61000,688.14000],
        [100.000,130.000,0.00106405,553.005,1.6253,4.2391,1528.00000,219.43000,215.46000,689.02000],
        [100.000,140.000,0.0010738,595.491,1.7294,4.2585,1510.70000,212.54000,199.11000,688.77000],
        [100.000,150.000,0.00108422,638.184,1.8315,4.2806,1491.20000,205.10000,185.02000,687.44000],
        [100.000,160.000,0.00109535,681.112,1.9318,4.3057,1469.60000,197.16000,172.79000,685.06000],
        [100.000,170.000,0.00110724,724.309,2.0304,4.3343,1445.80000,188.80000,162.07000,682.10000],
        [100.000,180.000,0.00111996,767.812,2.1274,4.367,1420.10000,180.06000,152.62000,678.03000],
        [100.000,190.000,0.00113357,811.665,2.2232,4.4044,1392.20000,170.99000,144.23000,672.97000],
        [100.000,200.000,0.00114818,855.918,2.3177,4.4472,1362.30000,161.64000,136.71000,666.98000],
        [100.000,210.000,0.00116389,900.631,2.4112,4.4965,1330.30000,152.05000,129.92000,660.08000],
        [100.000,220.000,0.00118085,945.874,2.5039,4.5535,1296.10000,142.27000,123.76000,652.28000],
        [100.000,230.000,0.00119922,991.731,2.5959,4.6196,1259.80000,132.34000,118.10000,643.58000],
        [100.000,240.000,0.00121923,1038.3,2.6876,4.697,1221.10000,122.30000,112.87000,633.98000],
        [100.000,250.000,0.00124116,1085.72,2.7791,4.7883,1180.00000,112.19000,107.99000,623.46000],
        [100.000,260.000,0.00126534,1134.13,2.8708,4.8972,1136.30000,102.03000,103.38000,611.99000],
        [100.000,270.000,0.00129228,1183.74,2.9629,5.0293,1089.40000,91.84000,98.99500,599.52000],
        [100.000,280.000,0.00132264,1234.82,3.0561,5.1931,1038.90000,81.60500,94.75500,585.97000],
        [100.000,290.000,0.00135739,1287.75,3.151,5.4023,983.78000,71.30000,90.59600,571.21000],
        [100.000,300.000,0.00139804,1343.1,3.2484,5.6816,922.76000,60.90500,86.43400,555.07000],
        [100.000,310.000,0.0014471,1401.77,3.3498,6.0782,854.92000,50.50700,82.15600,537.19000],
        [100.000,310.999,0.00145262,1407.87,3.3603,6.1275,847.74000,49.47400,81.71600,535.29000],
        [100.000,310.999,0.0180336,2725.47,5.6159,7.1472,472.44000,1.23770,20.19400,78.33800],
        [100.000,320.000,0.0192716,2782.66,5.7131,5.7468,491.71000,1.25460,20.66400,74.14800],
        [100.000,330.000,0.0204462,2835.67,5.8017,4.9228,508.20000,1.26320,21.17700,71.58000],
        [100.000,340.000,0.0214897,2882.06,5.878,4.3885,522.16000,1.26880,21.68200,70.04000],
        [100.000,350.000,0.0224422,2923.96,5.9458,4.0118,534.45000,1.27280,22.17700,69.10400],
        [100.000,360.000,0.0233274,2962.61,6.0073,3.7324,545.52000,1.27570,22.66500,68.57000],
        [100.000,370.000,0.0241605,2998.82,6.0641,3.5174,555.64000,1.27790,23.14600,68.32300],
        [100.000,380.000,0.0249522,3033.11,6.117,3.3471,565.02000,1.27940,23.62100,68.29300],
        [100.000,390.000,0.0257099,3065.87,6.1668,3.2092,573.79000,1.28060,24.08900,68.43400],
        [100.000,400.000,0.0264393,3097.38,6.2139,3.0958,582.04000,1.28130,24.55300,68.71500],
        [100.000,410.000,0.0271447,3127.85,6.2589,3.0013,589.86000,1.28180,25.01100,69.11100],
        [100.000,420.000,0.0278294,3157.45,6.3019,2.9217,597.31000,1.28200,25.46500,69.60600],
        [100.000,430.000,0.0284963,3186.32,6.3432,2.8542,604.44000,1.28210,25.91400,70.18600],
        [100.000,440.000,0.0291475,3214.57,6.3831,2.7965,611.28000,1.28200,26.36000,70.84000],
        [100.000,450.000,0.029785,3242.28,6.4217,2.747,617.87000,1.28170,26.80200,71.56000],
        [100.000,460.000,0.0304102,3269.53,6.4591,2.7043,624.24000,1.28140,27.24100,72.33800],
        [100.000,470.000,0.0310246,3296.38,6.4955,2.6674,630.41000,1.28100,27.67600,73.16700],
        [100.000,480.000,0.0316292,3322.89,6.531,2.6354,636.39000,1.28040,28.10900,74.04400],
        [100.000,490.000,0.032225,3349.11,6.5655,2.6076,642.21000,1.27990,28.53900,74.96400],
        [100.000,500.000,0.0328129,3375.06,6.5993,2.5833,647.89000,1.27920,28.96600,75.92200],
        [100.000,510.000,0.0333935,3400.78,6.6324,2.5622,653.42000,1.27860,29.39100,76.91600],
        [100.000,520.000,0.0339675,3426.31,6.6648,2.5437,658.83000,1.27790,29.81300,77.94300],
        [100.000,530.000,0.0345355,3451.67,6.6965,2.5275,664.12000,1.27710,30.23300,79.00000],
        [100.000,540.000,0.0350979,3476.87,6.7277,2.5134,669.31000,1.27640,30.65100,80.08500],
        [100.000,550.000,0.0356552,3501.94,6.7584,2.5011,674.39000,1.27560,31.06700,81.19500],
        [100.000,560.000,0.0362078,3526.9,6.7885,2.4904,679.39000,1.27480,31.48000,82.33000],
        [100.000,570.000,0.0367561,3551.75,6.8182,2.4811,684.29000,1.27400,31.89200,83.48700],
        [100.000,580.000,0.0373002,3576.52,6.8474,2.473,689.11000,1.27310,32.30200,84.66500],
        [100.000,590.000,0.0378406,3601.22,6.8761,2.466,693.86000,1.27230,32.71100,85.86200],
        [100.000,600.000,0.0383775,3625.84,6.9045,2.46,698.54000,1.27150,33.11700,87.07700],
        [100.000,650.000,0.0410163,3748.32,7.0409,2.442,720.95000,1.26720,35.12600,93.38700],
        [100.000,700.000,0.0435944,3870.27,7.1696,2.438,742.03000,1.26300,37.09800,100.00000],
        [100.000,750.000,0.0461269,3992.28,7.2918,2.4435,762.03000,1.25890,39.03800,106.87000],
        //[100.000,800.000,0.0486242,4114.73,7.4087,2.4555,781.12000,1.25480,40.94700,113.90000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

fn assert_pt_flash(
    p_bar: f64,
    t_deg_c: f64,
    v_m3_per_kg: f64,
    h_kj_per_kg: f64,
    s_kj_per_kg_k: f64,
    cp_kj_per_kg_k: f64,
    w_m_per_s: f64,
    kappa_dimensionless: f64,
    eta_micropascal_second: f64,
    lambda_milliwatt_per_meter_kelvin: f64,
){
    let p = Pressure::new::<bar>(p_bar);
    let t = ThermodynamicTemperature::new::<degree_celsius>(t_deg_c);
    let h_ref = AvailableEnergy::new::<kilojoule_per_kilogram>(h_kj_per_kg);
    let x = x_ph_flash(p, h_ref);

    // assert h
    let h_test = h_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        h_kj_per_kg,
        h_test.get::<kilojoule_per_kilogram>(),
        max_relative=1e-4
        );

    // assert volume to within 0.01%  (that's the tolerable error for 
    // backward eqn)
    let v_test = v_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        v_m3_per_kg,
        v_test.get::<cubic_meter_per_kilogram>(),
        max_relative=1e-4
        );

    // now entropy 
    let s_test = s_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        s_kj_per_kg_k,
        s_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=1e-3
        );

    // cp 
    let cp_test = cp_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        cp_kj_per_kg_k,
        cp_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=1e-3
        );
    // w 
    let w_test = w_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        w_m_per_s,
        w_test.get::<meter_per_second>(),
        max_relative=1e-4
        );

    // kappa
    let kappa_test = kappa_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        kappa_dimensionless,
        kappa_test.get::<ratio>(),
        max_relative=9e-3
        );

    // eta and lambda tbd



}



