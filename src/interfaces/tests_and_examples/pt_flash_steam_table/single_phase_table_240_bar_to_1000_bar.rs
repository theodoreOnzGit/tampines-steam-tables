use uom::si::dynamic_viscosity::micropascal_second;
use uom::si::{available_energy::kilojoule_per_kilogram, temperature_interval};
use uom::si::pressure::bar;
use uom::si::f64::*;
use uom::si::ratio::ratio;
use uom::si::specific_heat_capacity::kilojoule_per_kilogram_kelvin;
use uom::si::specific_volume::cubic_meter_per_kilogram;
use uom::si::thermodynamic_temperature::degree_celsius;
use uom::si::velocity::meter_per_second;

use crate::dynamic_viscosity::{mu_tp_eqm_single_phase, mu_tp_eqm_two_phase};
use crate::{interfaces::functional_programming::{ph_flash_eqm::x_ph_flash, pt_flash_eqm::{cp_tp_eqm_two_phase, h_tp_eqm_two_phase, kappa_tp_eqm_two_phase, s_tp_eqm_two_phase, v_tp_eqm_two_phase, w_tp_eqm_two_phase}}, region_4_vap_liq_equilibrium::sat_temp_4};

#[test]
pub fn single_phase_table_0_to_750_degc_240_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        [240.000,0.000,0.000988461,23.9804,0.0004328,4.1129,1441.20000,87.55200,1744.10000,572.90000],
        [240.000,2.000,0.000988522,32.2058,0.030436,4.1126,1451.00000,88.74300,1633.70000,577.34000],
        [240.000,4.000,0.000988638,40.431,0.060222,4.1126,1460.40000,89.88500,1534.10000,581.63000],
        [240.000,6.000,0.000988805,48.6565,0.089794,4.1128,1469.40000,90.98000,1443.80000,585.78000],
        [240.000,8.000,0.00098902,56.8825,0.11916,4.1132,1478.00000,92.02700,1361.80000,589.79000],
        [240.000,10.000,0.000989281,65.1095,0.14832,4.1137,1486.20000,93.02800,1287.00000,593.68000],
        [240.000,12.000,0.000989585,73.3375,0.17727,4.1143,1494.00000,93.98200,1218.50000,597.46000],
        [240.000,14.000,0.000989931,81.5667,0.20603,4.1149,1501.50000,94.89100,1155.80000,601.12000],
        [240.000,16.000,0.000990316,89.7972,0.23459,4.1156,1508.60000,95.75600,1098.00000,604.68000],
        [240.000,18.000,0.000990739,98.029,0.26296,4.1162,1515.40000,96.57700,1044.80000,608.14000],
        [240.000,20.000,0.000991199,106.262,0.29115,4.1169,1521.80000,97.35600,995.57000,611.52000],
        [240.000,25.000,0.0009925,126.851,0.36079,4.1186,1536.60000,99.12200,887.65000,619.56000],
        [240.000,30.000,0.000994005,147.449,0.4293,4.1204,1549.50000,100.64000,797.43000,627.09000],
        [240.000,35.000,0.000995698,168.055,0.49672,4.1221,1560.70000,101.93000,721.17000,634.16000],
        [240.000,40.000,0.00099757,188.67,0.56308,4.1239,1570.30000,102.99000,656.09000,640.78000],
        [240.000,45.000,0.00099961,209.294,0.62842,4.1259,1578.40000,103.84000,600.07000,646.98000],
        [240.000,50.000,0.00100181,229.929,0.69278,4.128,1585.10000,104.50000,551.50000,652.77000],
        [240.000,55.000,0.00100417,250.575,0.75618,4.1304,1590.60000,104.97000,509.10000,658.17000],
        [240.000,60.000,0.00100668,271.233,0.81865,4.133,1594.80000,105.27000,471.86000,663.18000],
        [240.000,65.000,0.00100933,291.905,0.88024,4.1359,1597.90000,105.40000,438.97000,667.83000],
        [240.000,70.000,0.00101213,312.593,0.94097,4.1391,1599.90000,105.38000,409.77000,672.10000],
        [240.000,75.000,0.00101506,333.297,1.0009,4.1426,1600.90000,105.21000,383.75000,676.03000],
        [240.000,80.000,0.00101813,354.019,1.06,4.1464,1601.00000,104.90000,360.44000,679.60000],
        [240.000,85.000,0.00102134,374.762,1.1183,4.1506,1600.20000,104.46000,339.50000,682.83000],
        [240.000,90.000,0.00102469,395.526,1.1759,4.1551,1598.50000,103.91000,320.60000,685.72000],
        [240.000,95.000,0.00102817,416.314,1.2327,4.16,1596.10000,103.24000,303.50000,688.29000],
        [240.000,100.000,0.00103178,437.127,1.2889,4.1653,1592.90000,102.47000,287.97000,690.53000],
        [240.000,110.000,0.00103941,478.836,1.3992,4.1769,1584.40000,100.63000,260.91000,694.08000],
        [240.000,120.000,0.00104758,520.669,1.507,4.1901,1573.30000,98.44700,238.23000,696.41000],
        [240.000,130.000,0.00105631,562.643,1.6124,4.205,1559.80000,95.96500,219.03000,697.59000],
        [240.000,140.000,0.00106562,604.776,1.7156,4.2219,1544.00000,93.22000,202.62000,697.66000],
        [240.000,150.000,0.00107552,647.089,1.8168,4.2409,1526.30000,90.24700,188.49000,696.67000],
        [240.000,160.000,0.00108606,689.603,1.9161,4.2624,1506.50000,87.07500,176.21000,694.66000],
        [240.000,170.000,0.00109728,732.346,2.0137,4.2866,1484.90000,83.72800,165.47000,691.66000],
        [240.000,180.000,0.00110922,775.346,2.1096,4.314,1461.40000,80.22800,156.00000,688.22000],
        [240.000,190.000,0.00112193,818.638,2.2041,4.345,1436.10000,76.59700,147.60000,683.64000],
        [240.000,200.000,0.00113549,862.26,2.2973,4.3802,1409.00000,72.85300,140.08000,678.14000],
        [240.000,210.000,0.00114998,906.258,2.3893,4.4202,1380.10000,69.01300,133.32000,671.78000],
        [240.000,220.000,0.0011655,950.682,2.4803,4.4657,1349.40000,65.09400,127.19000,664.56000],
        [240.000,230.000,0.00118217,995.593,2.5705,4.5177,1316.80000,61.11500,121.60000,656.52000],
        [240.000,240.000,0.00120013,1041.06,2.66,4.5773,1282.40000,57.09200,116.45000,647.65000],
        [240.000,250.000,0.00121955,1087.17,2.749,4.6458,1246.00000,53.04300,111.67000,637.96000],
        [240.000,260.000,0.00124066,1134.01,2.8376,4.7252,1207.70000,48.98400,107.21000,627.45000],
        [240.000,270.000,0.00126373,1181.72,2.9263,4.8176,1167.40000,44.93100,103.00000,616.09000],
        [240.000,280.000,0.00128911,1230.42,3.0151,4.9262,1124.80000,40.89600,98.99900,603.87000],
        [240.000,290.000,0.00131725,1280.31,3.1045,5.0555,1079.90000,36.88700,95.15000,590.73000],
        [240.000,300.000,0.00134878,1331.62,3.1948,5.212,1032.20000,32.91300,91.40800,576.64000],
        [240.000,310.000,0.00138457,1384.67,3.2866,5.4056,981.37000,28.98300,87.72300,561.47000],
        [240.000,320.000,0.00142586,1439.91,3.3805,5.6524,926.94000,25.10800,84.03900,545.10000],
        [240.000,330.000,0.00147461,1497.99,3.4776,5.9796,868.05000,21.29100,80.28400,527.29000],
        [240.000,340.000,0.001534,1559.93,3.5794,6.4387,803.19000,17.52300,76.36400,507.71000],
        [240.000,350.000,0.00160989,1627.56,3.6888,7.1423,730.87000,13.82500,72.12400,485.74000],
        [240.000,360.000,0.00171529,1704.72,3.8116,8.4459,647.89000,10.19700,67.25300,460.32000],
        [240.000,370.000,0.00189103,1802.54,3.9649,11.773,538.24000,6.38330,60.86800,429.53000],
        [240.000,380.000,0.00261206,2025.16,4.3076,67.846,355.44000,2.01530,45.48600,429.81000],
        [240.000,390.000,0.00561344,2500.75,5.032,18.2,426.49000,1.35010,29.36200,189.95000],
        [240.000,400.000,0.00673124,2637.37,5.2366,10.804,463.97000,1.33250,28.30000,145.67000],
        [240.000,410.000,0.00754038,2730.75,5.3744,8.182,489.68000,1.32500,28.07200,127.21000],
        [240.000,420.000,0.00820459,2804.86,5.4821,6.7651,510.09000,1.32140,28.12300,116.99000],
        [240.000,430.000,0.00878146,2867.81,5.5723,5.8859,527.11000,1.31830,28.30400,110.61000],
        [240.000,440.000,0.00929927,2923.48,5.6509,5.2815,541.87000,1.31560,28.55700,106.33000],
        [240.000,450.000,0.00977372,2973.96,5.7212,4.8354,555.03000,1.31330,28.85300,103.36000],
        [240.000,460.000,0.0102146,3020.53,5.7852,4.4912,566.99000,1.31130,29.17700,101.26000],
        [240.000,470.000,0.0106287,3064.02,5.8441,4.2179,577.99000,1.30970,29.51900,99.79200],
        [240.000,480.000,0.0110207,3105.06,5.899,3.9963,588.23000,1.30820,29.87500,98.78700],
        [240.000,490.000,0.0113944,3144.08,5.9504,3.8138,597.81000,1.30680,30.24000,98.14100],
        [240.000,500.000,0.0117526,3181.43,5.9991,3.6614,606.84000,1.30560,30.61100,97.78000],
        [240.000,510.000,0.0120975,3217.39,6.0453,3.5328,615.40000,1.30440,30.98600,97.64900],
        [240.000,520.000,0.0124309,3252.15,6.0894,3.4232,623.54000,1.30320,31.36500,97.70900],
        [240.000,530.000,0.0127542,3285.9,6.1317,3.329,631.32000,1.30210,31.74500,97.92800],
        [240.000,540.000,0.0130686,3318.78,6.1723,3.2474,638.77000,1.30090,32.12700,98.28300],
        [240.000,550.000,0.0133751,3350.89,6.2116,3.1764,645.93000,1.29980,32.51000,98.75500],
        [240.000,560.000,0.0136745,3382.33,6.2496,3.1141,652.83000,1.29860,32.89400,99.32800],
        [240.000,570.000,0.0139675,3413.19,6.2864,3.0593,659.50000,1.29750,33.27700,99.99100],
        [240.000,580.000,0.0142547,3443.54,6.3222,3.0107,665.95000,1.29630,33.66100,100.73000],
        [240.000,590.000,0.0145367,3473.43,6.357,2.9676,672.21000,1.29520,34.04400,101.54000],
        [240.000,600.000,0.0148139,3502.91,6.391,2.9292,678.29000,1.29400,34.42700,102.42000],
        [240.000,650.000,0.0161403,3645.56,6.5499,2.7892,706.51000,1.28860,36.33100,107.53000],
        [240.000,700.000,0.0173913,3782.76,6.6946,2.706,731.93000,1.28350,38.21500,113.49000],
        [240.000,750.000,0.0185887,3916.71,6.8289,2.6564,755.31000,1.27880,40.07600,120.12000],
        [240.000,800.000,0.0197464,4048.76,6.9549,2.6286,777.08000,1.27420,41.91500,127.14000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_260_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[260.000,0.000,0.000987523,25.9455,0.0003931,4.1051,1444.50000,81.27100,1740.60000,574.26000],
        [260.000,2.000,0.000987597,34.1558,0.030341,4.1052,1454.30000,82.37200,1630.80000,578.66000],
        [260.000,4.000,0.000987724,42.3666,0.060074,4.1056,1463.70000,83.42800,1531.70000,582.91000],
        [260.000,6.000,0.000987901,50.5784,0.089597,4.1062,1472.70000,84.44000,1441.80000,587.02000],
        [260.000,8.000,0.000988125,58.7914,0.11891,4.1069,1481.30000,85.40800,1360.10000,591.00000],
        [260.000,10.000,0.000988395,67.0059,0.14803,4.1076,1489.50000,86.33200,1285.60000,594.87000],
        [260.000,12.000,0.000988707,75.222,0.17694,4.1084,1497.30000,87.21400,1217.40000,598.61000],
        [260.000,14.000,0.000989059,83.4397,0.20566,4.1093,1504.80000,88.05400,1154.90000,602.26000],
        [260.000,16.000,0.000989451,91.6591,0.23419,4.1101,1511.90000,88.85300,1097.30000,605.80000],
        [260.000,18.000,0.00098988,99.8802,0.26252,4.111,1518.70000,89.61200,1044.30000,609.24000],
        [260.000,20.000,0.000990345,108.103,0.29067,4.1118,1525.10000,90.33200,995.19000,612.60000],
        [260.000,25.000,0.000991657,128.667,0.36022,4.1138,1539.80000,91.96400,887.54000,620.61000],
        [260.000,30.000,0.000993169,149.241,0.42866,4.1158,1552.70000,93.36900,797.51000,628.12000],
        [260.000,35.000,0.000994867,169.825,0.496,4.1178,1563.90000,94.55800,721.38000,635.16000],
        [260.000,40.000,0.000996742,190.419,0.5623,4.1197,1573.60000,95.54400,656.40000,641.77000],
        [260.000,45.000,0.000998783,211.023,0.62757,4.1218,1581.70000,96.33800,600.46000,647.96000],
        [260.000,50.000,0.00100098,231.637,0.69186,4.124,1588.50000,96.95000,551.94000,653.75000],
        [260.000,55.000,0.00100334,252.263,0.7552,4.1265,1593.90000,97.39100,509.57000,659.15000],
        [260.000,60.000,0.00100584,272.902,0.81762,4.1291,1598.20000,97.67100,472.35000,664.18000],
        [260.000,65.000,0.00100849,293.555,0.87916,4.1321,1601.40000,97.79800,439.48000,668.83000],
        [260.000,70.000,0.00101127,314.223,0.93983,4.1353,1603.40000,97.78200,410.30000,673.11000],
        [260.000,75.000,0.0010142,334.908,0.99967,4.1388,1604.50000,97.63200,384.28000,677.05000],
        [260.000,80.000,0.00101726,355.612,1.0587,4.1426,1604.70000,97.35500,360.98000,680.63000],
        [260.000,85.000,0.00102046,376.335,1.117,4.1468,1603.90000,96.96000,340.03000,683.87000],
        [260.000,90.000,0.00102379,397.08,1.1745,4.1513,1602.30000,96.45300,321.14000,686.78000],
        [260.000,95.000,0.00102725,417.848,1.2313,4.1561,1599.90000,95.84300,304.03000,689.36000],
        [260.000,100.000,0.00103084,438.641,1.2874,4.1613,1596.80000,95.13600,288.50000,691.62000],
        [260.000,110.000,0.00103843,480.31,1.3976,4.1727,1588.50000,93.45400,261.44000,695.20000],
        [260.000,120.000,0.00104656,522.101,1.5053,4.1857,1577.50000,91.45400,238.75000,697.58000],
        [260.000,130.000,0.00105524,564.03,1.6106,4.2004,1564.20000,89.17700,219.53000,698.80000],
        [260.000,140.000,0.00106449,606.116,1.7137,4.217,1548.70000,86.65900,203.12000,698.92000],
        [260.000,150.000,0.00107433,648.377,1.8148,4.2356,1531.10000,83.92900,188.97000,697.97000],
        [260.000,160.000,0.00108479,690.836,1.914,4.2566,1511.60000,81.01600,176.69000,696.01000],
        [260.000,170.000,0.00109592,733.518,2.0114,4.2803,1490.30000,77.94200,165.94000,693.07000],
        [260.000,180.000,0.00110775,776.452,2.1072,4.307,1467.10000,74.72800,156.47000,689.65000],
        [260.000,190.000,0.00112035,819.67,2.2015,4.3373,1442.10000,71.39300,148.07000,685.13000],
        [260.000,200.000,0.00113378,863.21,2.2945,4.3715,1415.30000,67.95400,140.55000,679.70000],
        [260.000,210.000,0.00114812,907.116,2.3863,4.4104,1386.80000,64.42700,133.79000,673.41000],
        [260.000,220.000,0.00116346,951.435,2.4771,4.4546,1356.50000,60.82900,127.67000,666.28000],
        [260.000,230.000,0.00117991,996.227,2.5671,4.5049,1324.40000,57.17400,122.08000,658.32000],
        [260.000,240.000,0.00119762,1041.56,2.6563,4.5625,1290.40000,53.47900,116.94000,649.54000],
        [260.000,250.000,0.00121675,1087.51,2.7449,4.6286,1254.70000,49.76100,112.17000,639.96000],
        [260.000,260.000,0.0012375,1134.16,2.8333,4.7048,1217.00000,46.03400,107.73000,629.56000],
        [260.000,270.000,0.00126012,1181.64,2.9215,4.7932,1177.40000,42.31400,103.54000,618.34000],
        [260.000,280.000,0.00128495,1230.08,3.0099,4.8966,1135.80000,38.61200,99.55800,606.27000],
        [260.000,290.000,0.0013124,1279.64,3.0987,5.0188,1091.90000,34.93800,95.74000,593.33000],
        [260.000,300.000,0.00134302,1330.53,3.1882,5.1654,1045.40000,31.29800,92.03700,579.45000],
        [260.000,310.000,0.0013776,1383.05,3.2791,5.3447,996.13000,27.70400,88.40400,564.56000],
        [260.000,320.000,0.00141722,1437.58,3.3718,5.5697,943.68000,24.16800,84.78800,548.54000],
        [260.000,330.000,0.00146353,1494.67,3.4672,5.8618,887.58000,20.70300,81.12900,531.19000],
        [260.000,340.000,0.00151912,1555.16,3.5667,6.2589,826.76000,17.30600,77.34700,512.24000],
        [260.000,350.000,0.00158845,1620.44,3.6723,6.8365,759.34000,13.96100,73.32600,491.22000],
        [260.000,360.000,0.00168051,1693.16,3.788,7.805,684.72000,10.73000,68.85400,467.32000],
        [260.000,370.000,0.00181755,1779.58,3.9234,9.746,593.74000,7.45980,63.46500,439.03000],
        [260.000,380.000,0.00208694,1901.05,4.1107,16.212,474.65000,4.15200,55.60300,404.95000],
        [260.000,390.000,0.00355176,2242.7,4.629,47.316,379.01000,1.55560,36.83600,331.22000],
        [260.000,400.000,0.00528668,2510.55,5.0304,16.237,436.89000,1.38860,30.65300,190.95000],
        [260.000,410.000,0.0062564,2639.46,5.2206,10.554,469.97000,1.35780,29.49500,151.85000],
        [260.000,420.000,0.00699044,2731.76,5.3548,8.1627,494.42000,1.34500,29.15900,133.44000],
        [260.000,430.000,0.00760205,2806.08,5.4612,6.8141,514.15000,1.33740,29.12900,122.82000],
        [260.000,440.000,0.00813711,2869.65,5.551,5.9567,530.78000,1.33160,29.24900,116.03000],
        [260.000,450.000,0.00861924,2926.06,5.6296,5.3574,545.33000,1.32700,29.45400,111.42000],
        [260.000,460.000,0.00906196,2977.3,5.7,4.9105,558.38000,1.32330,29.71200,108.17000],
        [260.000,470.000,0.0094739,3024.6,5.764,4.5635,570.28000,1.32030,30.00400,105.84000],
        [260.000,480.000,0.00986106,3068.8,5.8231,4.2866,581.27000,1.31780,30.32000,104.19000],
        [260.000,490.000,0.0102278,3110.51,5.8781,4.0614,591.50000,1.31570,30.65200,103.04000],
        [260.000,500.000,0.0105776,3150.16,5.9298,3.8754,601.10000,1.31380,30.99600,102.27000],
        [260.000,510.000,0.0109128,3188.11,5.9785,3.7198,610.16000,1.31210,31.34900,101.80000],
        [260.000,520.000,0.0112356,3224.64,6.0249,3.5883,618.74000,1.31050,31.70900,101.58000],
        [260.000,530.000,0.0115477,3259.95,6.0691,3.4761,626.91000,1.30900,32.07300,101.57000],
        [260.000,540.000,0.0118502,3294.21,6.1115,3.3796,634.71000,1.30750,32.44000,101.72000],
        [260.000,550.000,0.0121444,3327.58,6.1523,3.2959,642.19000,1.30610,32.81000,102.02000],
        [260.000,560.000,0.0124312,3360.17,6.1917,3.2229,649.38000,1.30470,33.18200,102.45000],
        [260.000,570.000,0.0127112,3392.07,6.2297,3.1587,656.30000,1.30330,33.55500,102.98000],
        [260.000,580.000,0.0129853,3423.37,6.2666,3.1021,662.99000,1.30190,33.92900,103.61000],
        [260.000,590.000,0.0132538,3454.13,6.3025,3.052,669.47000,1.30060,34.30400,104.32000],
        [260.000,600.000,0.0135174,3484.42,6.3374,3.0073,675.75000,1.29930,34.67900,105.11000],
        [260.000,650.000,0.014774,3630.36,6.5,2.8447,704.78000,1.29310,36.55100,109.91000],
        [260.000,700.000,0.0159531,3769.97,6.6473,2.7476,730.78000,1.28750,38.41100,115.69000],
        [260.000,750.000,0.0170777,3905.75,6.7833,2.6888,754.59000,1.28240,40.25300,122.24000],
        [260.000,800.000,0.018162,4039.25,6.9107,2.6545,776.71000,1.27760,42.07500,129.21000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_280_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[280.000,0.000,0.000986591,27.9053,0.0003407,4.0974,1447.90000,75.89100,1737.20000,575.60000],
        [280.000,2.000,0.000986677,36.1007,0.030234,4.098,1457.70000,76.91500,1628.00000,579.97000],
        [280.000,4.000,0.000986815,44.2973,0.059917,4.0987,1467.10000,77.89600,1529.30000,584.18000],
        [280.000,6.000,0.000987002,52.4957,0.089391,4.0996,1476.10000,78.83700,1439.90000,588.26000],
        [280.000,8.000,0.000987236,60.696,0.11866,4.1006,1484.60000,79.73600,1358.50000,592.21000],
        [280.000,10.000,0.000987514,68.8983,0.14773,4.1017,1492.80000,80.59500,1284.30000,596.04000],
        [280.000,12.000,0.000987834,77.1026,0.17661,4.1027,1500.60000,81.41500,1216.40000,599.76000],
        [280.000,14.000,0.000988193,85.3091,0.20529,4.1037,1508.10000,82.19600,1154.00000,603.38000],
        [280.000,16.000,0.000988591,93.5176,0.23377,4.1048,1515.20000,82.93800,1096.70000,606.90000],
        [280.000,18.000,0.000989026,101.728,0.26207,4.1058,1521.90000,83.64400,1043.80000,610.33000],
        [280.000,20.000,0.000989496,109.941,0.29018,4.1068,1528.40000,84.31300,994.82000,613.67000],
        [280.000,25.000,0.000990818,130.48,0.35966,4.1091,1543.10000,85.83100,887.44000,621.65000],
        [280.000,30.000,0.000992338,151.032,0.42801,4.1113,1556.00000,87.13800,797.60000,629.13000],
        [280.000,35.000,0.000994041,171.594,0.49529,4.1135,1567.20000,88.24600,721.61000,636.16000],
        [280.000,40.000,0.000995918,192.166,0.56151,4.1156,1576.80000,89.16500,656.72000,642.76000],
        [280.000,45.000,0.00099796,212.749,0.62672,4.1178,1585.00000,89.90600,600.85000,648.95000],
        [280.000,50.000,0.00100016,233.344,0.69095,4.1201,1591.80000,90.47900,552.37000,654.74000],
        [280.000,55.000,0.00100251,253.951,0.75423,4.1226,1597.30000,90.89400,510.04000,660.14000],
        [280.000,60.000,0.00100501,274.57,0.81659,4.1253,1601.60000,91.15900,472.85000,665.16000],
        [280.000,65.000,0.00100765,295.204,0.87807,4.1283,1604.80000,91.28300,439.99000,669.82000],
        [280.000,70.000,0.00101043,315.853,0.93869,4.1315,1607.00000,91.27400,410.82000,674.12000],
        [280.000,75.000,0.00101334,336.52,0.99848,4.135,1608.10000,91.14000,384.81000,678.06000],
        [280.000,80.000,0.00101639,357.204,1.0575,4.1388,1608.30000,90.88900,361.51000,681.66000],
        [280.000,85.000,0.00101958,377.909,1.1157,4.143,1607.60000,90.52800,340.57000,684.91000],
        [280.000,90.000,0.00102289,398.634,1.1732,4.1474,1606.10000,90.06400,321.67000,687.84000],
        [280.000,95.000,0.00102634,419.383,1.2299,4.1522,1603.80000,89.50400,304.56000,690.43000],
        [280.000,100.000,0.00102992,440.157,1.2859,4.1573,1600.70000,88.85300,289.03000,692.71000],
        [280.000,110.000,0.00103747,481.785,1.396,4.1686,1592.50000,87.30400,261.96000,696.33000],
        [280.000,120.000,0.00104555,523.534,1.5036,4.1814,1581.70000,85.46000,239.26000,698.74000],
        [280.000,130.000,0.00105418,565.42,1.6088,4.1959,1568.60000,83.35900,220.04000,700.01000],
        [280.000,140.000,0.00106337,607.458,1.7118,4.2121,1553.30000,81.03400,203.61000,700.17000],
        [280.000,150.000,0.00107314,649.668,1.8128,4.2304,1536.00000,78.51300,189.46000,699.27000],
        [280.000,160.000,0.00108353,692.073,1.9118,4.2509,1516.70000,75.82100,177.17000,697.36000],
        [280.000,170.000,0.00109457,734.696,2.0091,4.2741,1495.60000,72.98100,166.42000,694.47000],
        [280.000,180.000,0.00110631,777.564,2.1047,4.3002,1472.60000,70.01100,156.94000,691.06000],
        [280.000,190.000,0.00111879,820.71,2.1989,4.3297,1448.00000,66.92900,148.53000,686.62000],
        [280.000,200.000,0.00113209,864.17,2.2918,4.363,1421.60000,63.75100,141.02000,681.26000],
        [280.000,210.000,0.00114628,907.986,2.3834,4.4008,1393.40000,60.49200,134.26000,675.04000],
        [280.000,220.000,0.00116144,952.204,2.474,4.4437,1363.50000,57.16700,128.14000,667.98000],
        [280.000,230.000,0.0011777,996.88,2.5637,4.4925,1331.80000,53.79000,122.55000,660.10000],
        [280.000,240.000,0.00119516,1042.08,2.6526,4.5482,1298.40000,50.37600,117.42000,651.42000],
        [280.000,250.000,0.001214,1087.87,2.741,4.612,1263.20000,46.94100,112.67000,641.94000],
        [280.000,260.000,0.0012344,1134.35,2.829,4.6852,1226.10000,43.49800,108.24000,631.66000],
        [280.000,270.000,0.00125661,1181.61,2.9168,4.7699,1187.30000,40.06100,104.06000,620.57000],
        [280.000,280.000,0.00128092,1229.79,3.0047,4.8684,1146.40000,36.64400,100.11000,608.65000],
        [280.000,290.000,0.00130771,1279.04,3.0929,4.9842,1103.50000,33.25500,96.31800,595.88000],
        [280.000,300.000,0.0013375,1329.55,3.1818,5.1219,1058.20000,29.90200,92.65200,582.21000],
        [280.000,310.000,0.00137097,1381.57,3.2718,5.2887,1010.30000,26.59200,89.06500,567.58000],
        [280.000,320.000,0.00140908,1435.45,3.3634,5.4951,959.59000,23.33900,85.51000,551.88000],
        [280.000,330.000,0.00145324,1491.66,3.4574,5.7582,905.78000,20.16300,81.93400,534.95000],
        [280.000,340.000,0.00150559,1550.9,3.5548,6.1067,848.38000,17.07300,78.26900,516.55000],
        [280.000,350.000,0.00156965,1614.25,3.6573,6.5932,785.84000,14.05100,74.42400,496.33000],
        [280.000,360.000,0.00165196,1683.64,3.7677,7.3526,716.33000,11.09300,70.24700,473.68000],
        [280.000,370.000,0.00176645,1763.1,3.8922,8.6798,636.68000,8.19560,65.45300,447.49000],
        [280.000,380.000,0.00195213,1862.42,4.0454,11.672,541.56000,5.36580,59.35500,415.81000],
        [280.000,390.000,0.00239786,2022.34,4.2882,23.482,428.02000,2.72870,49.48800,378.18000],
        [280.000,400.000,0.00385452,2334.42,4.7552,27.31,409.44000,1.55330,35.66900,272.72000],
        [280.000,410.000,0.00507063,2529.06,5.0424,14.334,449.43000,1.42270,31.77400,189.73000],
        [280.000,420.000,0.00590405,2648.46,5.216,10.103,478.15000,1.38300,30.62300,156.26000],
        [280.000,430.000,0.00656344,2738.07,5.3444,8.0188,500.89000,1.36520,30.21700,138.67000],
        [280.000,440.000,0.00712296,2811.6,5.4483,6.7824,519.63000,1.35380,30.12200,128.05000],
        [280.000,450.000,0.00761715,2875.11,5.5367,5.97,535.67000,1.34540,30.19000,121.08000],
        [280.000,460.000,0.00806487,2931.77,5.6145,5.39,549.86000,1.33890,30.35100,116.25000],
        [280.000,470.000,0.00847736,2983.38,5.6845,4.9518,562.68000,1.33390,30.57200,112.80000],
        [280.000,480.000,0.00886205,3031.12,5.7483,4.6086,574.44000,1.32980,30.83400,110.31000],
        [280.000,490.000,0.00922415,3075.78,5.8072,4.333,585.34000,1.32660,31.12300,108.51000],
        [280.000,500.000,0.00956757,3117.94,5.8621,4.1079,595.51000,1.32380,31.43200,107.23000],
        [280.000,510.000,0.00989528,3158.06,5.9136,3.9213,605.06000,1.32130,31.75600,106.36000],
        [280.000,520.000,0.0102096,3196.47,5.9624,3.7649,614.09000,1.31910,32.09100,105.81000],
        [280.000,530.000,0.0105124,3233.44,6.0087,3.6324,622.65000,1.31710,32.43400,105.51000],
        [280.000,540.000,0.0108052,3269.18,6.0529,3.5191,630.80000,1.31520,32.78400,105.43000],
        [280.000,550.000,0.0110891,3303.87,6.0953,3.4214,638.60000,1.31340,33.13800,105.53000],
        [280.000,560.000,0.0113653,3337.65,6.1361,3.3366,646.07000,1.31160,33.49600,105.78000],
        [280.000,570.000,0.0116344,3370.64,6.1755,3.2624,653.25000,1.31000,33.85600,106.17000],
        [280.000,580.000,0.0118973,3402.93,6.2136,3.1971,660.17000,1.30830,34.21900,106.67000],
        [280.000,590.000,0.0121545,3434.61,6.2505,3.1393,666.86000,1.30670,34.58300,107.26000],
        [280.000,600.000,0.0124065,3465.74,6.2863,3.088,673.34000,1.30520,34.94800,107.95000],
        [280.000,650.000,0.0136035,3615.07,6.4527,2.9016,703.15000,1.29800,36.78300,112.39000],
        [280.000,700.000,0.0147212,3757.13,6.6026,2.79,729.71000,1.29180,38.61500,117.96000],
        [280.000,750.000,0.0157832,3894.78,6.7405,2.7216,753.95000,1.28630,40.43600,124.40000],
        [280.000,800.000,0.0168046,4029.74,6.8693,2.6808,776.40000,1.28110,42.24100,131.33000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_300_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[300.000,0.000,0.000985665,29.8599,0.0002758,4.0899,1451.30000,71.23000,1733.90000,576.94000],
        [300.000,2.000,0.000985763,38.0406,0.030116,4.0909,1461.10000,72.18700,1625.20000,581.26000],
        [300.000,4.000,0.000985912,46.2234,0.059748,4.092,1470.50000,73.10400,1527.00000,585.43000],
        [300.000,6.000,0.000986109,54.4086,0.089176,4.0932,1479.40000,73.98300,1438.00000,589.48000],
        [300.000,8.000,0.000986352,62.5964,0.1184,4.0945,1488.00000,74.82300,1357.00000,593.40000],
        [300.000,10.000,0.000986638,70.7866,0.14743,4.0958,1496.10000,75.62600,1283.00000,597.21000],
        [300.000,12.000,0.000986965,78.9794,0.17626,4.097,1503.90000,76.39100,1215.40000,600.91000],
        [300.000,14.000,0.000987332,87.1748,0.2049,4.0983,1511.40000,77.12000,1153.20000,604.50000],
        [300.000,16.000,0.000987736,95.3726,0.23335,4.0995,1518.50000,77.81400,1096.00000,608.00000],
        [300.000,18.000,0.000988176,103.573,0.26161,4.1007,1525.20000,78.47300,1043.30000,611.41000],
        [300.000,20.000,0.000988652,111.775,0.28969,4.1018,1531.70000,79.09800,994.47000,614.74000],
        [300.000,25.000,0.000989984,132.291,0.35908,4.1044,1546.40000,80.51700,887.35000,622.68000],
        [300.000,30.000,0.000991511,152.819,0.42737,4.1069,1559.30000,81.73900,797.69000,630.15000],
        [300.000,35.000,0.00099322,173.36,0.49457,4.1092,1570.50000,82.77600,721.84000,637.16000],
        [300.000,40.000,0.000995099,193.911,0.56073,4.1115,1580.10000,83.63700,657.04000,643.75000],
        [300.000,45.000,0.000997141,214.475,0.62588,4.1138,1588.30000,84.33300,601.24000,649.93000],
        [300.000,50.000,0.000999339,235.05,0.69004,4.1162,1595.10000,84.87300,552.81000,655.71000],
        [300.000,55.000,0.00100169,255.637,0.75326,4.1188,1600.70000,85.26400,510.51000,661.12000],
        [300.000,60.000,0.00100418,276.238,0.81557,4.1215,1605.10000,85.51600,473.34000,666.15000],
        [300.000,65.000,0.00100681,296.853,0.87699,4.1245,1608.30000,85.63700,440.50000,670.81000],
        [300.000,70.000,0.00100958,317.483,0.93755,4.1278,1610.50000,85.63400,411.34000,675.12000],
        [300.000,75.000,0.00101249,338.131,0.99729,4.1313,1611.70000,85.51500,385.34000,679.07000],
        [300.000,80.000,0.00101553,358.797,1.0562,4.1351,1611.90000,85.28600,362.04000,682.68000],
        [300.000,85.000,0.0010187,379.482,1.1144,4.1392,1611.30000,84.95500,341.10000,685.95000],
        [300.000,90.000,0.001022,400.189,1.1718,4.1436,1609.90000,84.52800,322.20000,688.89000],
        [300.000,95.000,0.00102544,420.919,1.2285,4.1484,1607.60000,84.01000,305.09000,691.50000],
        [300.000,100.000,0.001029,441.673,1.2845,4.1534,1604.60000,83.40900,289.56000,693.79000],
        [300.000,110.000,0.00103651,483.262,1.3945,4.1646,1596.60000,81.97500,262.48000,697.45000],
        [300.000,120.000,0.00104455,524.97,1.5019,4.1772,1586.00000,80.26600,239.77000,699.90000],
        [300.000,130.000,0.00105313,566.811,1.607,4.1914,1573.00000,78.31600,220.54000,701.21000],
        [300.000,140.000,0.00106226,608.803,1.7099,4.2073,1557.90000,76.15800,204.10000,701.41000],
        [300.000,150.000,0.00107197,650.964,1.8107,4.2252,1540.70000,73.81700,189.94000,700.56000],
        [300.000,160.000,0.00108228,693.315,1.9097,4.2453,1521.70000,71.31700,177.65000,698.70000],
        [300.000,170.000,0.00109324,735.879,2.0068,4.268,1500.80000,68.67900,166.89000,695.86000],
        [300.000,180.000,0.00110488,778.683,2.1023,4.2935,1478.20000,65.92000,157.41000,692.48000],
        [300.000,190.000,0.00111725,821.759,2.1964,4.3222,1453.80000,63.05700,149.00000,688.10000],
        [300.000,200.000,0.00113043,865.14,2.289,4.3547,1427.70000,60.10500,141.49000,682.81000],
        [300.000,210.000,0.00114447,908.867,2.3805,4.3915,1399.90000,57.07800,134.73000,676.65000],
        [300.000,220.000,0.00115946,952.986,2.4709,4.4332,1370.40000,53.98900,128.61000,669.67000],
        [300.000,230.000,0.00117552,997.55,2.5603,4.4805,1339.20000,50.85200,123.03000,661.87000],
        [300.000,240.000,0.00119275,1042.62,2.649,4.5344,1306.20000,47.68200,117.90000,653.28000],
        [300.000,250.000,0.00121131,1088.26,2.7371,4.5959,1271.50000,44.49000,113.16000,643.90000],
        [300.000,260.000,0.00123138,1134.57,2.8248,4.6664,1235.10000,41.29300,108.74000,633.73000],
        [300.000,270.000,0.00125319,1181.63,2.9122,4.7476,1196.90000,38.10200,104.58000,622.77000],
        [300.000,280.000,0.001277,1229.56,2.9997,4.8417,1156.80000,34.93000,100.65000,611.00000],
        [300.000,290.000,0.00130318,1278.51,3.0874,4.9516,1114.80000,31.78800,96.88500,598.40000],
        [300.000,300.000,0.00133219,1328.66,3.1756,5.0814,1070.60000,28.68100,93.25200,584.93000],
        [300.000,310.000,0.00136464,1380.23,3.2648,5.237,1024.10000,25.61600,89.70800,570.54000],
        [300.000,320.000,0.00140138,1433.51,3.3554,5.4272,974.84000,22.60400,86.20800,555.13000],
        [300.000,330.000,0.00144362,1488.93,3.4481,5.6659,922.91000,19.66700,82.70500,538.58000],
        [300.000,340.000,0.00149319,1547.07,3.5437,5.9753,868.21000,16.82700,79.14100,520.68000],
        [300.000,350.000,0.0015529,1608.8,3.6435,6.3935,809.96000,14.08200,75.44000,501.15000],
        [300.000,360.000,0.00162769,1675.57,3.7498,7.011,744.31000,11.34500,71.49200,479.54000],
        [300.000,370.000,0.00172705,1750.19,3.8667,7.9986,672.42000,8.72690,67.10500,455.01000],
        [300.000,380.000,0.00187297,1838.26,4.0026,9.8342,590.65000,6.20870,61.90000,426.10000],
        [300.000,390.000,0.0021331,1955.23,4.1802,14.344,497.30000,3.86460,54.94300,390.64000],
        [300.000,400.000,0.00279641,2152.37,4.475,25.797,419.63000,2.09900,44.20300,339.93000],
        [300.000,410.000,0.00398397,2395.84,4.8342,19.685,432.54000,1.56540,35.62000,244.78000],
        [300.000,420.000,0.00492092,2552.87,5.0625,12.73,462.80000,1.45090,32.76200,187.87000],
        [300.000,430.000,0.00563824,2662.82,5.2201,9.5627,487.80000,1.40670,31.67400,159.41000],
        [300.000,440.000,0.00622812,2748.86,5.3416,7.7964,508.64000,1.38470,31.23200,143.07000],
        [300.000,450.000,0.00673815,2820.91,5.4419,6.6908,526.23000,1.36990,31.09100,132.73000],
        [300.000,460.000,0.00719339,2883.84,5.5284,5.937,541.56000,1.35910,31.11500,125.74000],
        [300.000,470.000,0.00760843,2940.32,5.6049,5.3861,555.31000,1.35100,31.23800,120.82000],
        [300.000,480.000,0.0079924,2991.99,5.674,4.9638,567.83000,1.34470,31.42600,117.25000],
        [300.000,490.000,0.00835153,3039.89,5.7372,4.6297,579.37000,1.33980,31.65900,114.65000],
        [300.000,500.000,0.0086903,3084.79,5.7956,4.3597,590.11000,1.33570,31.92400,112.74000],
        [300.000,510.000,0.00901209,3127.24,5.8502,4.1378,600.16000,1.33220,32.21100,111.37000],
        [300.000,520.000,0.00931954,3167.67,5.9015,3.9532,609.62000,1.32920,32.51500,110.41000],
        [300.000,530.000,0.00961471,3206.41,5.95,3.7979,618.57000,1.32650,32.83200,109.78000],
        [300.000,540.000,0.00989926,3243.71,5.9962,3.666,627.07000,1.32410,33.16000,109.42000],
        [300.000,550.000,0.0101745,3279.79,6.0403,3.5529,635.17000,1.32170,33.49400,109.29000],
        [300.000,560.000,0.0104416,3314.82,6.0826,3.4552,642.92000,1.31960,33.83500,109.34000],
        [300.000,570.000,0.0107014,3348.94,6.1233,3.3701,650.36000,1.31750,34.18100,109.55000],
        [300.000,580.000,0.0109547,3382.25,6.1626,3.2955,657.51000,1.31550,34.53000,109.90000],
        [300.000,590.000,0.0112021,3414.87,6.2006,3.2296,664.40000,1.31350,34.88200,110.37000],
        [300.000,600.000,0.0114442,3446.87,6.2374,3.1713,671.07000,1.31170,35.23600,110.94000],
        [300.000,650.000,0.0125897,3599.68,6.4077,2.9598,701.63000,1.30340,37.02700,114.98000],
        [300.000,700.000,0.0136542,3744.24,6.5602,2.8331,728.73000,1.29640,38.82900,120.30000],
        [300.000,750.000,0.0146621,3883.78,6.7,2.7549,753.38000,1.29040,40.62600,126.63000],
        [300.000,800.000,0.0156288,4020.23,6.8303,2.7072,776.14000,1.28480,42.41200,133.49000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_400_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[400.000,0.000,0.000981126,39.5556,-0.0002298,4.0544,1468.5000,54.9460,1718.4000,583.4300],
        [400.000,2.000,0.00098128,47.6674,0.029359,4.0573,1478.2000,55.6680,1612.3000,587.5500],
        [400.000,4.000,0.000981481,55.7849,0.058755,4.0602,1487.5000,56.3590,1516.4000,591.5500],
        [400.000,6.000,0.000981726,63.908,0.087959,4.0629,1496.4000,57.0200,1429.2000,595.4400],
        [400.000,8.000,0.000982012,72.0363,0.11697,4.0655,1504.9000,57.6520,1349.8000,599.2200],
        [400.000,10.000,0.000982338,80.1697,0.1458,4.0679,1513.0000,58.2560,1277.2000,602.9000],
        [400.000,12.000,0.000982701,88.3079,0.17444,4.0702,1520.7000,58.8310,1210.7000,606.4800],
        [400.000,14.000,0.000983101,96.4505,0.2029,4.0724,1528.1000,59.3790,1149.5000,609.9800],
        [400.000,16.000,0.000983535,104.597,0.23117,4.0744,1535.1000,59.9010,1093.2000,613.3800],
        [400.000,18.000,0.000984002,112.748,0.25926,4.0763,1541.8000,60.3970,1041.2000,616.7100],
        [400.000,20.000,0.000984502,120.902,0.28717,4.0781,1548.2000,60.8680,993.0000,619.9600],
        [400.000,25.000,0.000985884,141.303,0.35618,4.0821,1562.9000,61.9380,887.1200,627.7600],
        [400.000,30.000,0.000987447,161.723,0.4241,4.0857,1575.7000,62.8620,798.3400,635.1100],
        [400.000,35.000,0.00098918,182.159,0.49096,4.0888,1587.0000,63.6500,723.1000,642.0600],
        [400.000,40.000,0.000991072,202.611,0.5568,4.0918,1596.7000,64.3080,658.7500,648.6000],
        [400.000,45.000,0.000993117,223.077,0.62164,4.0946,1605.0000,64.8430,603.2600,654.7600],
        [400.000,50.000,0.000995309,243.557,0.68551,4.0974,1611.9000,65.2630,555.0600,660.5400],
        [400.000,55.000,0.000997641,264.051,0.74844,4.1003,1617.6000,65.5730,512.9200,665.9600],
        [400.000,60.000,0.00100011,284.56,0.81047,4.1033,1622.2000,65.7800,475.8500,671.0100],
        [400.000,65.000,0.00100271,305.084,0.87162,4.1064,1625.6000,65.8890,443.0900,675.7100],
        [400.000,70.000,0.00100545,325.624,0.93191,4.1097,1628.1000,65.9060,413.9700,680.0700],
        [400.000,75.000,0.00100831,346.181,0.99139,4.1132,1629.5000,65.8360,387.9900,684.0800],
        [400.000,80.000,0.0010113,366.757,1.0501,4.117,1630.1000,65.6850,364.7100,687.7500],
        [400.000,85.000,0.00101441,387.351,1.108,4.121,1629.7000,65.4570,343.7700,691.0900],
        [400.000,90.000,0.00101765,407.967,1.1651,4.1252,1628.6000,65.1570,324.8600,694.1000],
        [400.000,95.000,0.00102101,428.604,1.2216,4.1298,1626.7000,64.7900,307.7400,696.7900],
        [400.000,100.000,0.00102449,449.265,1.2773,4.1346,1624.0000,64.3590,292.1800,699.1700],
        [400.000,110.000,0.00103183,490.662,1.3868,4.145,1616.7000,63.3250,265.0600,703.0000],
        [400.000,120.000,0.00103966,532.169,1.4937,4.1567,1606.8000,62.0850,242.3000,705.6500],
        [400.000,130.000,0.001048,573.8,1.5983,4.1697,1594.7000,60.6640,223.0300,707.1600],
        [400.000,140.000,0.00105685,615.569,1.7006,4.1843,1580.5000,59.0870,206.5500,707.5800],
        [400.000,150.000,0.00106625,657.491,1.8009,4.2005,1564.3000,57.3730,192.3500,706.9600],
        [400.000,160.000,0.00107622,699.585,1.8992,4.2186,1546.3000,55.5400,180.0100,705.3400],
        [400.000,170.000,0.00108677,741.871,1.9957,4.2389,1526.5000,53.6050,169.2200,702.7600],
        [400.000,180.000,0.00109796,784.371,2.0906,4.2616,1505.1000,51.5800,159.7200,699.2800],
        [400.000,190.000,0.00110982,827.113,2.1839,4.2871,1482.1000,49.4780,151.2900,695.4000],
        [400.000,200.000,0.00112241,870.124,2.2758,4.3158,1457.4000,47.3110,143.7700,690.4300],
        [400.000,210.000,0.00113577,913.44,2.3663,4.348,1431.2000,45.0880,137.0100,684.6100],
        [400.000,220.000,0.00114999,957.098,2.4558,4.3843,1403.5000,42.8210,130.9000,677.9900],
        [400.000,230.000,0.00116514,1001.14,2.5442,4.4252,1374.2000,40.5190,125.3400,670.5800],
        [400.000,240.000,0.00118132,1045.62,2.6317,4.4713,1343.4000,38.1930,120.2400,662.4100],
        [400.000,250.000,0.00119864,1090.59,2.7185,4.5234,1311.1000,35.8520,115.5400,653.5000],
        [400.000,260.000,0.00121724,1136.11,2.8047,4.5824,1277.3000,33.5060,111.1700,643.8500],
        [400.000,270.000,0.00123729,1182.26,2.8905,4.6493,1242.0000,31.1670,107.0900,633.4600],
        [400.000,280.000,0.00125898,1229.13,2.976,4.7254,1205.2000,28.8450,103.2300,622.3500],
        [400.000,290.000,0.00128255,1276.8,3.0614,4.8123,1167.0000,26.5480,99.5780,610.4900],
        [400.000,300.000,0.00130831,1325.41,3.1469,4.912,1127.4000,24.2870,96.0770,597.8900],
        [400.000,310.000,0.00133664,1375.1,3.2329,5.0272,1086.2000,22.0680,92.6990,584.5100],
        [400.000,320.000,0.00136803,1426.02,3.3195,5.1615,1043.4000,19.8950,89.4090,570.3300],
        [400.000,330.000,0.00140314,1478.41,3.407,5.3198,998.6900,17.7710,86.1750,555.2900],
        [400.000,340.000,0.00144284,1532.52,3.496,5.5097,951.9900,15.7030,82.9620,539.3100],
        [400.000,350.000,0.0014884,1588.74,3.587,5.7424,903.6200,13.7150,79.7320,522.2600],
        [400.000,360.000,0.00154152,1647.62,3.6807,6.044,853.4500,11.8130,76.4450,504.0000],
        [400.000,370.000,0.00160475,1709.93,3.7783,6.4342,800.7700,9.9896,73.0540,484.3300],
        [400.000,380.000,0.00168216,1776.72,3.8814,6.9509,745.7500,8.2653,69.4930,462.8800],
        [400.000,390.000,0.00178035,1849.61,3.9921,7.6679,688.5200,6.6568,65.6770,439.1800],
        [400.000,400.000,0.00191069,1931.13,4.1141,8.7012,630.1400,5.1954,61.4970,412.5200],
        [400.000,410.000,0.00209341,2025.18,4.2527,10.192,573.7600,3.9314,56.8290,381.9500],
        [400.000,420.000,0.00236117,2136.3,4.4142,12.045,526.6100,2.9362,51.6630,346.3500],
        [400.000,430.000,0.00274238,2263.84,4.5969,13.205,499.0800,2.2707,46.4840,305.3200],
        [400.000,440.000,0.00320965,2394.03,4.7807,12.554,493.6600,1.8982,42.2730,263.1800],
        [400.000,450.000,0.00369271,2511.77,4.9447,10.95,501.5000,1.7027,39.4440,227.6000],
        [400.000,460.000,0.00414901,2613.32,5.0842,9.3909,514.6600,1.5960,37.6870,201.0100],
        [400.000,470.000,0.00456732,2700.69,5.2026,8.1475,528.9500,1.5315,36.6170,181.8900],
        [400.000,480.000,0.00494969,2777.18,5.3048,7.1892,542.9200,1.4888,35.9720,168.0600],
        [400.000,490.000,0.0053004,2845.2,5.3946,6.4475,556.2500,1.4594,35.6010,157.9400],
        [400.000,500.000,0.0056249,2906.69,5.4746,5.8745,568.8300,1.4381,35.4110,150.4100],
        [400.000,510.000,0.0059279,2963.09,5.5471,5.4221,580.6700,1.4220,35.3450,144.7200],
        [400.000,520.000,0.00621295,3015.42,5.6135,5.0563,591.8100,1.4093,35.3670,140.3700],
        [400.000,530.000,0.0064828,3064.43,5.6749,4.7551,602.3000,1.3990,35.4540,137.0200],
        [400.000,540.000,0.00673966,3110.69,5.7322,4.5044,612.2100,1.3903,35.5890,134.4500],
        [400.000,550.000,0.00698531,3154.65,5.7859,4.2938,621.6000,1.3828,35.7620,132.4800],
        [400.000,560.000,0.00722123,3196.67,5.8366,4.1156,630.5100,1.3763,35.9640,131.0000],
        [400.000,570.000,0.00744864,3237.05,5.8848,3.9634,638.9900,1.3704,36.1890,129.9100],
        [400.000,580.000,0.00766855,3276.01,5.9308,3.8324,647.0900,1.3651,36.4320,129.1400],
        [400.000,590.000,0.00788179,3313.75,5.9747,3.7188,654.8500,1.3602,36.6910,128.6500],
        [400.000,600.000,0.00808906,3350.43,6.017,3.6194,662.3100,1.3557,36.9620,128.3900],
        [400.000,650.000,0.00905378,3521.76,6.2079,3.2666,695.9800,1.3375,38.4390,129.5300],
        [400.000,700.000,0.00993098,3679.42,6.3743,3.057,725.3600,1.3245,40.0320,133.1600],
        [400.000,750.000,0.0107484,3828.75,6.5239,2.9259,751.7600,1.3145,41.6760,138.6200],
        [400.000,800.000,0.0115229,3972.81,6.6614,2.8428,775.8300,1.3059,43.3430,144.9600],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_500_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[500.000,0.000,0.00097673,49.1286,-0.001021,4.0225,1485.90000,45.21200,1704.70000,589.62000],
        [500.000,2.000,0.000976937,57.1781,0.028341,4.027,1495.60000,45.79100,1601.00000,593.57000],
        [500.000,4.000,0.000977186,65.2365,0.057522,4.0313,1504.80000,46.34500,1507.00000,597.41000],
        [500.000,6.000,0.000977475,73.3031,0.086523,4.0353,1513.60000,46.87500,1421.60000,601.15000],
        [500.000,8.000,0.000977801,81.3773,0.11534,4.039,1522.00000,47.38100,1343.60000,604.80000],
        [500.000,10.000,0.000978164,89.4588,0.14399,4.0424,1530.00000,47.86400,1272.20000,608.36000],
        [500.000,12.000,0.000978561,97.5468,0.17245,4.0456,1537.70000,48.32400,1206.70000,611.84000],
        [500.000,14.000,0.000978991,105.641,0.20074,4.0486,1545.00000,48.76300,1146.50000,615.25000],
        [500.000,16.000,0.000979453,113.741,0.22885,4.0513,1551.90000,49.18100,1090.90000,618.57000],
        [500.000,18.000,0.000979945,121.846,0.25678,4.0538,1558.60000,49.57800,1039.60000,621.83000],
        [500.000,20.000,0.000980468,129.956,0.28454,4.0562,1564.90000,49.95600,991.97000,625.01000],
        [500.000,25.000,0.000981897,150.25,0.35319,4.0614,1579.50000,50.81500,887.21000,632.68000],
        [500.000,30.000,0.000983494,170.569,0.42077,4.0659,1592.30000,51.55900,799.22000,639.94000],
        [500.000,35.000,0.000985249,190.908,0.48732,4.0698,1603.50000,52.19600,724.54000,646.82000],
        [500.000,40.000,0.000987154,211.266,0.55285,4.0733,1613.30000,52.73100,660.58000,653.33000],
        [500.000,45.000,0.000989203,231.64,0.6174,4.0765,1621.60000,53.16900,605.37000,659.47000],
        [500.000,50.000,0.000991389,252.031,0.68099,4.0797,1628.70000,53.51600,557.37000,665.26000],
        [500.000,55.000,0.000993708,272.437,0.74366,4.0828,1634.60000,53.77600,515.37000,670.70000],
        [500.000,60.000,0.000996157,292.859,0.80542,4.086,1639.30000,53.95500,478.40000,675.78000],
        [500.000,65.000,0.000998732,313.297,0.86631,4.0892,1643.00000,54.05600,445.69000,680.53000],
        [500.000,70.000,0.00100143,333.751,0.92636,4.0926,1645.60000,54.08400,416.61000,684.93000],
        [500.000,75.000,0.00100425,354.223,0.98558,4.0961,1647.30000,54.04300,390.65000,689.00000],
        [500.000,80.000,0.00100719,374.713,1.044,4.0998,1648.10000,53.93600,367.37000,692.73000],
        [500.000,85.000,0.00101025,395.221,1.1017,4.1037,1648.00000,53.76900,346.43000,696.14000],
        [500.000,90.000,0.00101343,415.75,1.1586,4.1078,1647.20000,53.54400,327.51000,699.23000],
        [500.000,95.000,0.00101672,436.3,1.2148,4.1121,1645.50000,53.26600,310.37000,702.00000],
        [500.000,100.000,0.00102013,456.872,1.2703,4.1167,1643.20000,52.93700,294.80000,704.46000],
        [500.000,110.000,0.0010273,498.087,1.3793,4.1265,1636.50000,52.14000,267.62000,708.47000],
        [500.000,120.000,0.00103494,539.405,1.4858,4.1374,1627.40000,51.17800,244.82000,711.31000],
        [500.000,130.000,0.00104306,580.838,1.5898,4.1494,1616.00000,50.07100,225.49000,713.02000],
        [500.000,140.000,0.00105167,622.397,1.6917,4.1627,1602.50000,48.84000,208.96000,713.65000],
        [500.000,150.000,0.00106078,664.096,1.7914,4.1774,1587.20000,47.49800,194.71000,713.25000],
        [500.000,160.000,0.00107043,705.951,1.8891,4.1938,1570.10000,46.06300,182.34000,711.86000],
        [500.000,170.000,0.00108062,747.979,1.9851,4.2121,1551.40000,44.54400,171.52000,709.53000],
        [500.000,180.000,0.0010914,790.199,2.0793,4.2324,1531.00000,42.95500,161.99000,706.30000],
        [500.000,190.000,0.0011028,832.635,2.1719,4.2551,1509.10000,41.30400,153.54000,702.51000],
        [500.000,200.000,0.00111486,875.311,2.2631,4.2806,1485.80000,39.60200,146.00000,697.88000],
        [500.000,210.000,0.00112763,918.256,2.3529,4.309,1460.90000,37.85600,139.23000,692.38000],
        [500.000,220.000,0.00114116,961.503,2.4415,4.3409,1434.70000,36.07400,133.12000,686.09000],
        [500.000,230.000,0.00115553,1005.09,2.529,4.3766,1407.00000,34.26600,127.57000,679.04000],
        [500.000,240.000,0.0011708,1049.05,2.6155,4.4165,1378.00000,32.43900,122.49000,671.26000],
        [500.000,250.000,0.00118708,1093.43,2.7012,4.4613,1347.70000,30.60100,117.81000,662.76000],
        [500.000,260.000,0.00120446,1138.29,2.7861,4.5115,1316.00000,28.75900,113.48000,653.57000],
        [500.000,270.000,0.00122307,1183.68,2.8704,4.5678,1283.10000,26.92300,109.45000,643.69000],
        [500.000,280.000,0.00124305,1229.67,2.9543,4.631,1249.00000,25.10000,105.66000,633.14000],
        [500.000,290.000,0.00126459,1276.33,3.0379,4.702,1213.70000,23.29800,102.08000,621.91000],
        [500.000,300.000,0.00128789,1323.74,3.1214,4.7819,1177.30000,21.52600,98.67100,610.02000],
        [500.000,310.000,0.00131322,1372.0,3.2049,4.8719,1139.90000,19.79000,95.40600,597.44000],
        [500.000,320.000,0.00134088,1421.22,3.2885,4.9736,1101.50000,18.09700,92.25400,584.19000],
        [500.000,330.000,0.00137128,1471.52,3.3726,5.0889,1062.10000,16.45300,89.18900,570.23000],
        [500.000,340.000,0.00140492,1523.05,3.4574,5.22,1021.70000,14.85900,86.18700,555.54000],
        [500.000,350.000,0.00144244,1575.98,3.543,5.37,980.05000,13.31800,83.22100,540.08000],
        [500.000,360.000,0.00148475,1630.63,3.63,5.562,936.04000,11.80200,80.26400,523.79000],
        [500.000,370.000,0.00153293,1687.35,3.7189,5.7866,891.79000,10.37600,77.29600,506.59000],
        [500.000,380.000,0.00158849,1746.51,3.8101,6.0531,846.77000,9.02780,74.29100,488.37000],
        [500.000,390.000,0.00165351,1808.6,3.9045,6.3776,801.09000,7.76230,71.22400,469.01000],
        [500.000,400.000,0.00173089,1874.31,4.0028,6.7781,755.14000,6.58890,68.06800,448.33000],
        [500.000,410.000,0.00182467,1944.47,4.1063,7.2713,709.70000,5.52070,64.80000,426.12000],
        [500.000,420.000,0.00194037,2020.07,4.2161,7.8636,666.13000,4.57370,61.40600,402.17000],
        [500.000,430.000,0.00208504,2101.99,4.3334,8.5275,626.51000,3.76510,57.90400,376.31000],
        [500.000,440.000,0.00226604,2190.53,4.4585,9.1599,593.57000,3.10960,54.37100,348.62000],
        [500.000,450.000,0.00248744,2284.44,4.5892,9.5672,569.96000,2.61200,50.97100,319.72000],
        [500.000,460.000,0.00274521,2380.52,4.7212,9.5776,556.72000,2.25800,47.92800,290.98000],
        [500.000,470.000,0.00302709,2474.69,4.8488,9.2032,552.52000,2.01700,45.40700,264.27000],
        [500.000,480.000,0.00331861,2563.86,4.968,8.6087,554.76000,1.85470,43.44800,241.00000],
        [500.000,490.000,0.00360858,2646.56,5.077,7.8969,560.89000,1.74360,41.98500,221.51000],
        [500.000,500.000,0.00388941,2722.52,5.1759,7.309,568.92000,1.66440,40.92400,205.98000],
        [500.000,510.000,0.00415994,2792.7,5.2661,6.7313,578.20000,1.60730,40.16300,193.40000],
        [500.000,520.000,0.00441748,2857.36,5.3482,6.2131,588.07000,1.56570,39.63300,183.36000],
        [500.000,530.000,0.00466236,2917.25,5.4232,5.7787,598.00000,1.53400,39.27600,175.39000],
        [500.000,540.000,0.00489567,2973.16,5.4924,5.4136,607.73000,1.50880,39.05100,169.04000],
        [500.000,550.000,0.00511848,3025.7,5.5566,5.1031,617.16000,1.48830,38.92500,163.96000],
        [500.000,560.000,0.00533183,3075.37,5.6166,4.8372,626.25000,1.47110,38.87600,159.88000],
        [500.000,570.000,0.00553667,3122.57,5.6729,4.6091,634.99000,1.45650,38.88900,156.62000],
        [500.000,580.000,0.0057339,3167.66,5.7261,4.4131,643.38000,1.44380,38.95100,154.02000],
        [500.000,590.000,0.00592433,3210.92,5.7765,4.244,651.44000,1.43270,39.05200,151.97000],
        [500.000,600.000,0.00610867,3252.61,5.8245,4.0973,659.20000,1.42270,39.18500,150.36000],
        [500.000,650.000,0.00695746,3443.48,6.0372,3.5873,694.26000,1.38560,40.16800,146.95000],
        [500.000,700.000,0.00771757,3614.76,6.218,3.2881,724.96000,1.36200,41.45200,147.95000],
        [500.000,750.000,0.00841745,3774.13,6.3777,3.1008,752.51000,1.34550,42.88300,152.05000],
        [500.000,800.000,0.00907413,3925.96,6.5226,2.9813,777.37000,1.33190,44.39100,157.54000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_600_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[600.000,0.000,0.000972471,58.5861,-0.002077,3.9937,1503.7000,38.7500,1692.8000,595.5300],
        [600.000,2.000,0.000972727,66.5794,0.02708,3.9996,1513.2000,39.2330,1591.2000,599.3100],
        [600.000,4.000,0.000973021,74.5842,0.056067,4.0051,1522.3000,39.6950,1499.0000,603.0100],
        [600.000,6.000,0.00097335,82.5995,0.084884,4.0102,1531.0000,40.1360,1415.0000,606.6200],
        [600.000,8.000,0.000973714,90.6246,0.11353,4.0148,1539.3000,40.5570,1338.3000,610.1600],
        [600.000,10.000,0.000974111,98.6586,0.142,4.0191,1547.2000,40.9590,1268.1000,613.6200],
        [600.000,12.000,0.000974539,106.701,0.17031,4.023,1554.8000,41.3430,1203.5000,617.0100],
        [600.000,14.000,0.000974998,114.751,0.19844,4.0267,1562.0000,41.7080,1144.1000,620.3200],
        [600.000,16.000,0.000975486,122.807,0.2264,4.03,1568.9000,42.0560,1089.2000,623.5800],
        [600.000,18.000,0.000976002,130.87,0.25419,4.0331,1575.5000,42.3870,1038.4000,626.7700],
        [600.000,20.000,0.000976545,138.939,0.28181,4.0359,1581.8000,42.7020,991.3700,629.8900],
        [600.000,25.000,0.000978019,159.135,0.35012,4.0422,1596.2000,43.4190,887.6200,637.4400],
        [600.000,30.000,0.000979648,179.359,0.41739,4.0474,1609.0000,44.0430,800.3400,644.6300],
        [600.000,35.000,0.000981425,199.608,0.48364,4.0519,1620.2000,44.5780,726.1600,651.4600],
        [600.000,40.000,0.000983342,219.877,0.54889,4.0559,1630.0000,45.0290,662.5500,657.9400],
        [600.000,45.000,0.000985394,240.166,0.61316,4.0595,1638.4000,45.4020,607.5900,664.0800],
        [600.000,50.000,0.000987575,260.472,0.67649,4.063,1645.6000,45.6990,559.7600,669.8800],
        [600.000,55.000,0.000989883,280.795,0.7389,4.0663,1651.6000,45.9250,517.8800,675.3400],
        [600.000,60.000,0.000992312,301.135,0.80042,4.0696,1656.4000,46.0840,480.9800,680.4600],
        [600.000,65.000,0.000994862,321.491,0.86107,4.0729,1660.3000,46.1790,448.3300,685.2500],
        [600.000,70.000,0.000997528,341.864,0.92087,4.0763,1663.1000,46.2130,419.2800,689.7100],
        [600.000,75.000,0.00100031,362.255,0.97987,4.0798,1665.0000,46.1900,393.3200,693.8400],
        [600.000,80.000,0.00100321,382.663,1.0381,4.0835,1666.0000,46.1130,370.0400,697.6400],
        [600.000,85.000,0.00100621,403.09,1.0955,4.0873,1666.2000,45.9850,349.0900,701.1200],
        [600.000,90.000,0.00100933,423.536,1.1522,4.0913,1665.6000,45.8090,330.1500,704.2800],
        [600.000,95.000,0.00101256,444.003,1.2082,4.0954,1664.2000,45.5890,312.9900,707.1300],
        [600.000,100.000,0.00101591,464.49,1.2634,4.0997,1662.2000,45.3260,297.4000,709.6800],
        [600.000,110.000,0.00102292,505.533,1.372,4.109,1656.1000,44.6860,270.1700,713.8700],
        [600.000,120.000,0.00103039,546.672,1.478,4.1191,1647.6000,43.9070,247.3100,716.8900],
        [600.000,130.000,0.0010383,587.918,1.5816,4.1302,1636.9000,43.0080,227.9200,718.7900],
        [600.000,140.000,0.00104668,629.28,1.6829,4.1424,1624.2000,42.0050,211.3400,719.6300],
        [600.000,150.000,0.00105553,670.77,1.7822,4.1558,1609.6000,40.9100,197.0500,719.4500],
        [600.000,160.000,0.00106488,712.401,1.8794,4.1707,1593.4000,39.7370,184.6300,718.2900],
        [600.000,170.000,0.00107475,754.189,1.9748,4.1872,1575.5000,38.4940,173.7700,716.1900],
        [600.000,180.000,0.00108516,796.15,2.0684,4.2055,1556.2000,37.1930,164.2100,713.2000],
        [600.000,190.000,0.00109614,838.305,2.1604,4.2258,1535.3000,35.8400,155.7400,709.3600],
        [600.000,200.000,0.00110773,880.675,2.2509,4.2485,1513.1000,34.4450,148.1800,705.1600],
        [600.000,210.000,0.00111996,923.284,2.34,4.2738,1489.4000,33.0130,141.4000,699.9800],
        [600.000,220.000,0.00113289,966.161,2.4279,4.302,1464.5000,31.5520,135.2900,694.0000],
        [600.000,230.000,0.00114657,1009.33,2.5145,4.3334,1438.2000,30.0680,129.7300,687.2900],
        [600.000,240.000,0.00116107,1052.84,2.6002,4.3684,1410.8000,28.5690,124.6600,679.8600],
        [600.000,250.000,0.00117644,1096.72,2.6848,4.4073,1382.1000,27.0610,120.0000,671.7500],
        [600.000,260.000,0.00119279,1141.0,2.7687,4.4507,1352.2000,25.5500,115.7000,662.9700],
        [600.000,270.000,0.00121019,1185.75,2.8518,4.4988,1321.3000,24.0430,111.7000,653.5400],
        [600.000,280.000,0.00122878,1231.0,2.9344,4.5523,1289.3000,22.5480,108.0000,643.4800],
        [600.000,290.000,0.00124867,1276.81,3.0165,4.6117,1256.4000,21.0700,104.4000,632.7900],
        [600.000,300.000,0.00127003,1323.25,3.0982,4.6775,1222.6000,19.6160,101.1000,621.4900],
        [600.000,310.000,0.00129303,1370.38,3.1797,4.7504,1188.0000,18.1920,97.9060,609.5900],
        [600.000,320.000,0.00131791,1418.28,3.2612,4.8309,1152.7000,16.8040,94.8520,597.0800],
        [600.000,330.000,0.00134492,1467.03,3.3427,4.9198,1116.8000,15.4560,91.9030,583.9600],
        [600.000,340.000,0.00137438,1516.71,3.4244,5.0175,1080.4000,14.1540,89.0390,570.2400],
        [600.000,350.000,0.00140668,1567.41,3.5064,5.1244,1043.5000,12.9010,86.2390,555.9000],
        [600.000,360.000,0.0014423,1619.3,3.589,5.2592,1004.8000,11.6660,83.4860,540.9600],
        [600.000,370.000,0.00148191,1672.64,3.6726,5.4109,965.6200,10.4870,80.7590,525.3300],
        [600.000,380.000,0.00152621,1727.58,3.7573,5.58,926.2600,9.3691,78.0450,509.0200],
        [600.000,390.000,0.00157615,1784.32,3.8435,5.7733,886.7800,8.3153,75.3330,491.9800],
        [600.000,400.000,0.00163294,1843.15,3.9316,5.9975,847.3800,7.3289,72.6090,474.1700],
        [600.000,410.000,0.00169811,1904.39,4.0219,6.2571,808.4500,6.4149,69.8650,455.5400],
        [600.000,420.000,0.00177352,1968.41,4.1149,6.5524,770.5300,5.5794,67.0950,436.0300],
        [600.000,430.000,0.00186141,2035.54,4.2111,6.8777,734.3500,4.8286,64.3040,415.6100],
        [600.000,440.000,0.00196432,2106.01,4.3106,7.217,700.8700,4.1678,61.5090,394.3100],
        [600.000,450.000,0.00208469,2179.82,4.4134,7.5398,671.1800,3.6015,58.7410,372.2200],
        [600.000,460.000,0.00222434,2256.6,4.5188,7.7999,646.4100,3.1309,56.0570,349.6200],
        [600.000,470.000,0.00238359,2335.44,4.6256,7.9454,627.4200,2.7526,53.5270,326.9700],
        [600.000,480.000,0.00256059,2415.0,4.7319,7.9414,614.4800,2.4577,51.2270,304.9100],
        [600.000,490.000,0.00275152,2493.77,4.8358,7.7888,607.1700,2.2330,49.2150,284.1400],
        [600.000,500.000,0.00295158,2570.4,4.9356,7.522,604.5300,2.0636,47.5140,265.2200],
        [600.000,510.000,0.00315612,2643.99,5.0302,7.1881,605.4400,1.9357,46.1160,248.4800],
        [600.000,520.000,0.00336069,2713.9,5.1189,6.7994,608.6800,1.8374,44.9980,233.9800],
        [600.000,530.000,0.00356327,2780.22,5.202,6.4533,613.8500,1.7625,44.1140,221.7000],
        [600.000,540.000,0.00376176,2842.9,5.2796,6.0859,620.1700,1.7040,43.4290,211.2800],
        [600.000,550.000,0.00395482,2902.06,5.3519,5.7534,627.1300,1.6574,42.9080,202.5800],
        [600.000,560.000,0.00414208,2958.09,5.4195,5.4575,634.3700,1.6192,42.5200,195.3300],
        [600.000,570.000,0.00432345,3011.32,5.483,5.1919,641.7300,1.5875,42.2410,189.3000],
        [600.000,580.000,0.00449897,3062.02,5.5428,4.9539,649.1000,1.5609,42.0510,184.3000],
        [600.000,590.000,0.00466889,3110.48,5.5993,4.7424,656.4300,1.5382,41.9330,180.1600],
        [600.000,600.000,0.00483355,3156.95,5.6528,4.5557,663.6400,1.5186,41.8760,176.7400],
        [600.000,650.000,0.00559084,3366.76,5.8867,3.9007,697.4800,1.4502,42.1890,167.1500],
        [600.000,700.000,0.00626511,3551.39,6.0815,3.5151,728.1600,1.4105,43.0690,164.6100],
        [600.000,750.000,0.00688181,3720.64,6.2512,3.273,756.1100,1.3846,44.2290,166.8300],
        [600.000,800.000,0.00745681,3880.15,6.4034,3.1193,781.1600,1.3639,45.5410,171.1300],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_700_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[700.000,0.000,0.000968343,67.9346,-0.003378,3.9678,1521.60000,34.15500,1682.50000,601.17000],
        [700.000,2.000,0.000968644,75.8774,0.025594,3.9749,1531.00000,34.56900,1582.80000,604.81000],
        [700.000,4.000,0.00096898,83.8338,0.054406,3.9814,1540.00000,34.96400,1492.20000,608.37000],
        [700.000,6.000,0.000969347,91.8027,0.083056,3.9874,1548.60000,35.34100,1409.60000,611.87000],
        [700.000,8.000,0.000969746,99.783,0.11154,3.9928,1556.80000,35.70200,1334.00000,615.30000],
        [700.000,10.000,0.000970175,107.774,0.13986,3.9978,1564.60000,36.04500,1264.70000,618.67000],
        [700.000,12.000,0.000970632,115.774,0.16802,4.0024,1572.10000,36.37300,1201.00000,621.97000],
        [700.000,14.000,0.000971117,123.783,0.19601,4.0066,1579.20000,36.68600,1142.30000,625.22000],
        [700.000,16.000,0.000971629,131.8,0.22383,4.0104,1586.00000,36.98300,1088.00000,628.40000],
        [700.000,18.000,0.000972167,139.824,0.25149,4.0139,1592.50000,37.26700,1037.80000,631.54000],
        [700.000,20.000,0.00097273,147.856,0.27898,4.0172,1598.70000,37.53600,991.20000,634.61000],
        [700.000,25.000,0.000974245,167.96,0.34698,4.0242,1613.00000,38.15100,888.35000,642.06000],
        [700.000,30.000,0.000975905,188.096,0.41395,4.0301,1625.70000,38.68800,801.69000,649.18000],
        [700.000,35.000,0.000977702,208.259,0.47992,4.0351,1636.90000,39.14900,727.95000,655.98000],
        [700.000,40.000,0.00097963,228.446,0.54491,4.0395,1646.70000,39.54100,664.66000,662.44000],
        [700.000,45.000,0.000981686,248.654,0.60893,4.0435,1655.10000,39.86500,609.91000,668.58000],
        [700.000,50.000,0.000983863,268.881,0.67201,4.0472,1662.40000,40.12600,562.23000,674.40000],
        [700.000,55.000,0.00098616,289.125,0.73418,4.0507,1668.50000,40.32700,520.44000,679.89000],
        [700.000,60.000,0.000988572,309.387,0.79546,4.0541,1673.50000,40.47100,483.61000,685.05000],
        [700.000,65.000,0.000991097,329.666,0.85588,4.0575,1677.50000,40.56000,450.99000,689.89000],
        [700.000,70.000,0.000993734,349.962,0.91546,4.0609,1680.50000,40.59800,421.95000,694.40000],
        [700.000,75.000,0.00099648,370.275,0.97423,4.0644,1682.60000,40.58600,396.00000,698.59000],
        [700.000,80.000,0.000999335,390.606,1.0322,4.068,1683.80000,40.52900,372.72000,702.46000],
        [700.000,85.000,0.0010023,410.955,1.0894,4.0717,1684.20000,40.42900,351.75000,706.02000],
        [700.000,90.000,0.00100536,431.323,1.1459,4.0755,1683.80000,40.28700,332.79000,709.26000],
        [700.000,95.000,0.00100854,451.711,1.2017,4.0795,1682.70000,40.10700,315.61000,712.19000],
        [700.000,100.000,0.00101181,472.118,1.2567,4.0836,1680.90000,39.89200,299.98000,714.82000],
        [700.000,110.000,0.00101869,512.997,1.3648,4.0923,1675.30000,39.36100,272.70000,719.18000],
        [700.000,120.000,0.00102598,553.967,1.4704,4.1018,1667.40000,38.71200,249.78000,722.39000],
        [700.000,130.000,0.00103371,595.035,1.5735,4.112,1657.30000,37.95900,230.34000,724.49000],
        [700.000,140.000,0.00104188,636.211,1.6744,4.1233,1645.30000,37.11700,213.70000,725.52000],
        [700.000,150.000,0.00105049,677.504,1.7732,4.1355,1631.50000,36.19700,199.36000,725.55000],
        [700.000,160.000,0.00105957,718.926,1.8699,4.1491,1616.00000,35.21000,186.90000,724.61000],
        [700.000,170.000,0.00106913,760.49,1.9648,4.164,1599.00000,34.16300,176.00000,722.74000],
        [700.000,180.000,0.0010792,802.211,2.0579,4.1805,1580.50000,33.06600,166.40000,719.99000],
        [700.000,190.000,0.00108981,844.106,2.1493,4.1988,1560.60000,31.92600,157.90000,716.40000],
        [700.000,200.000,0.00110097,886.194,2.2392,4.2191,1539.40000,30.74800,150.32000,712.23000],
        [700.000,210.000,0.00111273,928.496,2.3277,4.2417,1516.90000,29.53900,143.52000,707.40000],
        [700.000,220.000,0.00112512,971.037,2.4149,4.2668,1493.10000,28.30500,137.39000,701.73000],
        [700.000,230.000,0.00113819,1013.84,2.5008,4.2947,1468.10000,27.05200,131.84000,695.33000],
        [700.000,240.000,0.00115199,1056.94,2.5856,4.3256,1442.00000,25.78500,126.77000,688.23000],
        [700.000,250.000,0.00116659,1100.36,2.6694,4.3598,1414.70000,24.50900,122.12000,680.47000],
        [700.000,260.000,0.00118204,1144.15,2.7523,4.3976,1386.40000,23.23100,117.83000,672.07000],
        [700.000,270.000,0.00119842,1188.33,2.8344,4.4393,1357.20000,21.95700,113.86000,663.05000],
        [700.000,280.000,0.00121583,1232.95,2.9158,4.4853,1327.00000,20.69200,110.14000,653.42000],
        [700.000,290.000,0.00123436,1278.05,2.9966,4.5358,1296.10000,19.44200,106.66000,643.21000],
        [700.000,300.000,0.00125413,1323.68,3.0769,4.5912,1264.40000,18.21200,103.37000,632.43000],
        [700.000,310.000,0.00127529,1369.89,3.1569,4.6516,1232.20000,17.00700,100.25000,621.09000],
        [700.000,320.000,0.00129798,1416.73,3.2365,4.7174,1199.40000,15.83200,97.26500,609.21000],
        [700.000,330.000,0.00132241,1464.26,3.316,4.7885,1166.20000,14.69100,94.39900,596.79000],
        [700.000,340.000,0.00134877,1512.52,3.3953,4.8648,1132.60000,13.58700,91.63300,583.84000],
        [700.000,350.000,0.00137734,1561.57,3.4747,4.9456,1098.80000,12.52300,88.94700,570.37000],
        [700.000,360.000,0.00140839,1611.49,3.5541,5.0456,1064.40000,11.49200,86.32900,556.40000],
        [700.000,370.000,0.00144236,1662.5,3.6341,5.1581,1028.90000,10.48500,83.75800,541.91000],
        [700.000,380.000,0.00147965,1714.68,3.7146,5.2776,993.30000,9.52590,81.22600,526.89000],
        [700.000,390.000,0.00152079,1768.09,3.7957,5.4083,957.83000,8.61800,78.72400,511.36000],
        [700.000,400.000,0.00156639,1822.89,3.8778,5.5547,922.59000,7.76290,76.24400,495.31000],
        [700.000,410.000,0.00161722,1879.25,3.9609,5.7192,887.84000,6.96310,73.77800,478.73000],
        [700.000,420.000,0.00167415,1937.34,4.0453,5.9017,853.87000,6.22140,71.32400,461.62000],
        [700.000,430.000,0.00173821,1997.33,4.1312,6.099,821.07000,5.54070,68.88300,444.00000],
        [700.000,440.000,0.00181047,2059.35,4.2188,6.3049,789.90000,4.92330,66.46000,425.88000],
        [700.000,450.000,0.00189208,2123.43,4.308,6.5096,760.87000,4.37100,64.07000,407.32000],
        [700.000,460.000,0.00198407,2189.49,4.3987,6.699,734.52000,3.88460,61.73100,388.43000],
        [700.000,470.000,0.00208719,2257.3,4.4906,6.8558,711.40000,3.46390,59.47100,369.39000],
        [700.000,480.000,0.00220176,2326.43,4.583,6.9619,691.97000,3.10680,57.32100,350.42000],
        [700.000,490.000,0.00232737,2396.31,4.6752,7.0021,676.51000,2.80920,55.31600,331.81000],
        [700.000,500.000,0.00246294,2466.23,4.7662,6.9693,665.04000,2.56530,53.48500,313.90000],
        [700.000,510.000,0.00260674,2535.47,4.8552,6.867,657.31000,2.36780,51.84900,297.02000],
        [700.000,520.000,0.0027567,2603.38,4.9413,6.7073,652.87000,2.20880,50.41800,281.41000],
        [700.000,530.000,0.00291072,2669.48,5.0242,6.507,651.17000,2.08110,49.18900,267.24000],
        [700.000,540.000,0.00306666,2733.39,5.1032,6.2797,652.00000,1.98030,48.15200,254.58000],
        [700.000,550.000,0.00322318,2795.01,5.1786,6.0369,654.19000,1.89680,47.28700,243.39000],
        [700.000,560.000,0.00337846,2854.09,5.2499,5.7814,657.60000,1.82860,46.58000,233.63000],
        [700.000,570.000,0.00353176,2910.72,5.3175,5.5472,661.76000,1.77140,46.00700,225.19000],
        [700.000,580.000,0.00368255,2965.08,5.3816,5.3277,666.47000,1.72310,45.55000,217.92000],
        [700.000,590.000,0.00383038,3017.31,5.4424,5.119,671.62000,1.68230,45.19200,211.67000],
        [700.000,600.000,0.00397492,3067.51,5.5003,4.9233,677.13000,1.64780,44.91900,206.33000],
        [700.000,650.000,0.00464832,3293.57,5.7522,4.1825,706.51000,1.53410,44.44700,189.70000],
        [700.000,700.000,0.00525194,3490.45,5.96,3.7267,735.57000,1.47170,44.84900,182.87000],
        [700.000,750.000,0.00580362,3668.96,6.139,3.4357,762.99000,1.43300,45.68900,182.78000],
        [700.000,800.000,0.00631671,3835.81,6.2982,3.2526,787.58000,1.40280,46.77400,185.60000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_800_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[800.000,0.000,0.000964341,77.1804,-0.004907,3.9446,1539.6000,30.7240,1673.7000,606.5500],
        [800.000,2.000,0.000964684,85.0779,0.0239,3.9527,1548.9000,31.0860,1575.7000,610.0600],
        [800.000,4.000,0.000965058,92.9907,0.052555,3.96,1557.8000,31.4310,1486.5000,613.5100],
        [800.000,6.000,0.00096546,100.918,0.081053,3.9667,1566.2000,31.7600,1405.1000,616.9000],
        [800.000,8.000,0.000965892,108.857,0.10939,3.9728,1574.3000,32.0740,1330.6000,620.2300],
        [800.000,10.000,0.00096635,116.809,0.13758,3.9784,1582.0000,32.3740,1262.2000,623.5200],
        [800.000,12.000,0.000966834,124.77,0.1656,3.9835,1589.4000,32.6590,1199.2000,626.7500],
        [800.000,14.000,0.000967344,132.742,0.19345,3.9881,1596.4000,32.9320,1141.1000,629.9300],
        [800.000,16.000,0.000967879,140.723,0.22115,3.9923,1603.1000,33.1920,1087.4000,633.0600],
        [800.000,18.000,0.000968437,148.711,0.24868,3.9962,1609.6000,33.4390,1037.7000,636.1400],
        [800.000,20.000,0.000969019,156.707,0.27605,3.9998,1615.7000,33.6740,991.4500,639.1700],
        [800.000,25.000,0.000970572,176.726,0.34377,4.0076,1629.9000,34.2120,889.3900,646.5400],
        [800.000,30.000,0.00097226,196.781,0.41047,4.014,1642.4000,34.6820,803.2800,653.6100],
        [800.000,35.000,0.000974076,216.865,0.47618,4.0194,1653.6000,35.0880,729.9200,660.3800],
        [800.000,40.000,0.000976016,236.974,0.54092,4.0242,1663.3000,35.4340,666.8900,666.8400],
        [800.000,45.000,0.000978074,257.106,0.60469,4.0284,1671.8000,35.7210,612.3300,672.9800],
        [800.000,50.000,0.000980249,277.257,0.66754,4.0322,1679.1000,35.9540,564.7700,678.8200],
        [800.000,55.000,0.000982535,297.427,0.72948,4.0359,1685.3000,36.1350,523.0600,684.3500],
        [800.000,60.000,0.000984931,317.616,0.79054,4.0394,1690.4000,36.2660,486.2800,689.5500],
        [800.000,65.000,0.000987434,337.821,0.85074,4.0428,1694.5000,36.3500,453.6800,694.4400],
        [800.000,70.000,0.000990043,358.044,0.9101,4.0463,1697.7000,36.3890,424.6500,699.0200],
        [800.000,75.000,0.000992756,378.284,0.96866,4.0497,1699.9000,36.3860,398.7000,703.2700],
        [800.000,80.000,0.000995572,398.542,1.0264,4.0533,1701.3000,36.3430,375.4000,707.2100],
        [800.000,85.000,0.000998489,418.817,1.0834,4.0569,1701.9000,36.2620,354.4100,710.8400],
        [800.000,90.000,0.00100151,439.11,1.1397,4.0605,1701.7000,36.1450,335.4300,714.1600],
        [800.000,95.000,0.00100463,459.422,1.1953,4.0643,1700.8000,35.9940,318.2200,717.1700],
        [800.000,100.000,0.00100785,479.754,1.2501,4.0683,1699.3000,35.8120,302.5700,719.8800],
        [800.000,110.000,0.00101459,520.477,1.3578,4.0765,1694.2000,35.3620,275.2200,724.4200],
        [800.000,120.000,0.00102173,561.286,1.463,4.0853,1686.7000,34.8080,252.2400,727.8100],
        [800.000,130.000,0.00102928,602.186,1.5657,4.0948,1677.2000,34.1640,232.7300,730.1000],
        [800.000,140.000,0.00103724,643.185,1.6661,4.1052,1665.8000,33.4410,216.0400,731.3400],
        [800.000,150.000,0.00104564,684.292,1.7645,4.1164,1652.7000,32.6510,201.6400,731.5600],
        [800.000,160.000,0.00105447,725.517,1.8607,4.1287,1637.9000,31.8020,189.1300,730.8300],
        [800.000,170.000,0.00106375,766.871,1.9551,4.1423,1621.6000,30.9010,178.1900,729.1900],
        [800.000,180.000,0.00107351,808.368,2.0477,4.1572,1604.0000,29.9570,168.5500,726.6700],
        [800.000,190.000,0.00108377,850.022,2.1387,4.1738,1585.0000,28.9750,160.0200,723.3100],
        [800.000,200.000,0.00109454,891.849,2.228,4.1921,1564.7000,27.9600,152.4100,719.1600],
        [800.000,210.000,0.00110587,933.87,2.3159,4.2124,1543.2000,26.9180,145.6000,714.6500],
        [800.000,220.000,0.00111778,976.104,2.4024,4.2348,1520.5000,25.8540,139.4600,709.2900],
        [800.000,230.000,0.00113031,1018.57,2.4877,4.2597,1496.7000,24.7730,133.8900,703.1900],
        [800.000,240.000,0.0011435,1061.31,2.5718,4.2872,1471.8000,23.6790,128.8200,696.4000],
        [800.000,250.000,0.0011574,1104.33,2.6548,4.3174,1445.8000,22.5770,124.1700,688.9700],
        [800.000,260.000,0.00117207,1147.67,2.7368,4.3508,1419.0000,21.4730,119.9000,680.9100],
        [800.000,270.000,0.00118757,1191.35,2.818,4.3873,1391.2000,20.3710,115.9300,672.2600],
        [800.000,280.000,0.00120397,1235.42,2.8984,4.4273,1362.6000,19.2770,112.2500,663.0300],
        [800.000,290.000,0.00122135,1279.91,2.9781,4.4708,1333.4000,18.1950,108.7900,653.2500],
        [800.000,300.000,0.00123981,1324.85,3.0572,4.5181,1303.5000,17.1310,105.5400,642.9300],
        [800.000,310.000,0.00125944,1370.29,3.1358,4.5692,1273.2000,16.0880,102.4600,632.0800],
        [800.000,320.000,0.00128038,1416.25,3.214,4.6241,1242.5000,15.0710,99.5310,620.7300],
        [800.000,330.000,0.00130275,1462.78,3.2918,4.6825,1211.5000,14.0830,96.7280,608.9000],
        [800.000,340.000,0.00132672,1509.91,3.3693,4.744,1180.3000,13.1260,94.0330,596.5800],
        [800.000,350.000,0.00135245,1557.67,3.4465,4.8076,1149.0000,12.2030,91.4300,583.8100],
        [800.000,360.000,0.00138016,1606.1,3.5236,4.8842,1117.3000,11.3050,88.9060,570.6100],
        [800.000,370.000,0.0014101,1655.38,3.6008,4.9727,1084.6000,10.4280,86.4450,556.9900],
        [800.000,380.000,0.00144256,1705.56,3.6783,5.0634,1051.8000,9.5864,84.0370,542.9400],
        [800.000,390.000,0.00147784,1756.67,3.7559,5.1586,1019.2000,8.7860,81.6750,528.4900],
        [800.000,400.000,0.00151632,1808.76,3.8339,5.2623,986.8500,8.0282,79.3510,513.6600],
        [800.000,410.000,0.00155843,1861.95,3.9123,5.3768,954.9600,7.3147,77.0610,498.4600],
        [800.000,420.000,0.00160468,1916.33,3.9913,5.5024,923.7600,6.6472,74.7990,482.9100],
        [800.000,430.000,0.00165561,1972.03,4.0711,5.6371,893.4900,6.0274,72.5650,467.0100],
        [800.000,440.000,0.00171181,2029.1,4.1517,5.7774,864.4400,5.4566,70.3620,450.8100],
        [800.000,450.000,0.00177388,2087.58,4.2331,5.9181,836.9100,4.9356,68.1960,434.3500],
        [800.000,460.000,0.0018424,2147.44,4.3153,6.0528,811.1900,4.4645,66.0760,417.7000],
        [800.000,470.000,0.00191784,2208.59,4.3982,6.1737,787.5900,4.0430,64.0170,400.9400],
        [800.000,480.000,0.00200054,2270.84,4.4814,6.2727,766.4000,3.6701,62.0330,384.2100],
        [800.000,490.000,0.00209065,2333.94,4.5646,6.342,747.8600,3.3440,60.1430,367.6600],
        [800.000,500.000,0.00218803,2397.56,4.6474,6.3749,732.1200,3.0622,58.3650,351.4400],
        [800.000,510.000,0.00229222,2461.31,4.7294,6.3679,719.2700,2.8212,56.7130,335.7500],
        [800.000,520.000,0.00240251,2524.78,4.8099,6.3205,709.2400,2.6172,55.2020,320.7600],
        [800.000,530.000,0.00251797,2587.59,4.8886,6.2361,701.8600,2.4454,53.8390,306.6300],
        [800.000,540.000,0.0026375,2649.4,4.9651,6.1206,696.8600,2.3015,52.6250,293.4900],
        [800.000,550.000,0.00276004,2709.93,5.0391,5.9817,693.9500,2.1810,51.5570,281.4100],
        [800.000,560.000,0.00288461,2768.96,5.1103,5.8423,692.8900,2.0804,50.6300,270.4500],
        [800.000,570.000,0.00301014,2826.43,5.1789,5.6505,693.2900,1.9960,49.8330,260.5100],
        [800.000,580.000,0.00313543,2882.02,5.2445,5.4708,694.7900,1.9245,49.1590,251.6900],
        [800.000,590.000,0.00326009,2935.89,5.3072,5.3034,696.9600,1.8625,48.5930,243.9000],
        [800.000,600.000,0.00338369,2988.09,5.3674,5.1372,699.8100,1.8092,48.1230,237.0300],
        [800.000,650.000,0.003975,3225.67,5.6321,4.4081,721.8000,1.6384,46.8630,213.7700],
        [800.000,700.000,0.00451614,3432.92,5.8509,3.9135,747.6300,1.5471,46.7470,202.3500],
        [800.000,750.000,0.00501331,3619.74,6.0382,3.5834,773.3100,1.4911,47.2370,199.6500],
        [800.000,800.000,0.00547622,3793.32,6.2039,3.3765,796.7700,1.4491,48.0710,200.7500],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_1000_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[1000.000,0.000,0.000956687,95.386,-0.008582,3.9057,1575.5000,25.9470,1660.6000,616.6000],
        [1000.000,2.000,0.000957105,103.207,0.019946,3.915,1584.6000,26.2350,1565.3000,619.8900],
        [1000.000,4.000,0.000957548,111.046,0.048331,3.9235,1593.2000,26.5090,1478.5000,623.1300],
        [1000.000,6.000,0.000958014,118.9,0.076571,3.9312,1601.4000,26.7700,1399.1000,626.3500],
        [1000.000,8.000,0.000958503,126.77,0.10466,3.9382,1609.3000,27.0200,1326.2000,629.5300],
        [1000.000,10.000,0.000959015,134.653,0.1326,3.9446,1616.8000,27.2570,1259.3000,632.6700],
        [1000.000,12.000,0.000959548,142.548,0.16038,3.9503,1624.0000,27.4840,1197.5000,635.7800],
        [1000.000,14.000,0.000960102,150.454,0.18801,3.9556,1630.8000,27.7000,1140.5000,638.8500],
        [1000.000,16.000,0.000960677,158.37,0.21549,3.9604,1637.3000,27.9060,1087.7000,641.8900],
        [1000.000,18.000,0.000961273,166.295,0.2428,3.9649,1643.6000,28.1030,1038.7000,644.8900],
        [1000.000,20.000,0.000961888,174.229,0.26996,3.9689,1649.6000,28.2900,993.1400,647.8600],
        [1000.000,25.000,0.00096351,194.096,0.33716,3.9777,1663.4000,28.7180,892.3600,655.1000],
        [1000.000,30.000,0.000965249,214.003,0.40337,3.9849,1675.8000,29.0940,807.1300,662.1000],
        [1000.000,35.000,0.000967101,233.943,0.46861,3.9909,1686.8000,29.4190,734.3700,668.8400],
        [1000.000,40.000,0.000969061,253.911,0.53289,3.9961,1696.4000,29.6980,671.7500,675.3100],
        [1000.000,45.000,0.000971126,273.903,0.59623,4.0007,1704.9000,29.9320,617.4600,681.4900],
        [1000.000,50.000,0.000973294,293.917,0.65864,4.0048,1712.2000,30.1220,570.0700,687.3900],
        [1000.000,55.000,0.000975562,313.95,0.72016,4.0086,1718.5000,30.2720,528.4700,693.0000],
        [1000.000,60.000,0.000977929,334.003,0.78081,4.0122,1723.7000,30.3830,491.7400,698.3100],
        [1000.000,65.000,0.000980392,354.072,0.84061,4.0157,1728.0000,30.4560,459.1600,703.3100],
        [1000.000,70.000,0.00098295,374.16,0.89957,4.0191,1731.3000,30.4940,430.1200,708.0100],
        [1000.000,75.000,0.000985603,394.264,0.95774,4.0225,1733.8000,30.4980,404.1400,712.4000],
        [1000.000,80.000,0.000988348,414.385,1.0151,4.0259,1735.4000,30.4710,380.7900,716.4900],
        [1000.000,85.000,0.000991185,434.523,1.0717,4.0293,1736.2000,30.4130,359.7500,720.2700],
        [1000.000,90.000,0.000994115,454.678,1.1276,4.0327,1736.3000,30.3270,340.7100,723.7500],
        [1000.000,95.000,0.000997135,474.85,1.1828,4.0362,1735.7000,30.2140,323.4300,726.9200],
        [1000.000,100.000,0.00100025,495.04,1.2373,4.0397,1734.4000,30.0750,307.7100,729.8000],
        [1000.000,110.000,0.00100674,535.473,1.3442,4.0471,1730.0000,29.7300,280.2300,734.6900],
        [1000.000,120.000,0.00101361,575.982,1.4486,4.0548,1723.4000,29.3020,257.1100,738.4400],
        [1000.000,130.000,0.00102084,616.571,1.5505,4.063,1714.7000,28.8030,237.4800,741.1100],
        [1000.000,140.000,0.00102844,657.245,1.6502,4.0718,1704.3000,28.2420,220.6600,742.7300],
        [1000.000,150.000,0.00103643,698.01,1.7477,4.0813,1692.1000,27.6270,206.1500,743.3500],
        [1000.000,160.000,0.00104482,738.873,1.8431,4.0916,1678.5000,26.9660,193.5400,743.0300],
        [1000.000,170.000,0.00105361,779.845,1.9366,4.1028,1663.6000,26.2660,182.5000,741.8000],
        [1000.000,180.000,0.00106282,820.934,2.0283,4.1152,1647.3000,25.5320,172.7800,739.7200],
        [1000.000,190.000,0.00107246,862.152,2.1183,4.1288,1629.8000,24.7680,164.1800,736.8200],
        [1000.000,200.000,0.00108256,903.513,2.2066,4.1437,1611.2000,23.9790,156.5100,733.1400],
        [1000.000,210.000,0.00109313,945.032,2.2935,4.1603,1591.5000,23.1690,149.6400,728.7200],
        [1000.000,220.000,0.00110421,986.725,2.3789,4.1785,1570.7000,22.3420,143.4600,723.9200],
        [1000.000,230.000,0.00111581,1028.61,2.463,4.1987,1548.9000,21.5010,137.8700,718.4200],
        [1000.000,240.000,0.00112796,1070.7,2.5458,4.2207,1526.2000,20.6490,132.7800,712.2100],
        [1000.000,250.000,0.00114071,1113.03,2.6275,4.2449,1502.5000,19.7910,128.1200,705.3700],
        [1000.000,260.000,0.00115408,1155.61,2.7081,4.2714,1478.1000,18.9300,123.8500,697.9400],
        [1000.000,270.000,0.00116813,1198.47,2.7878,4.3001,1452.8000,18.0690,119.9000,689.9400],
        [1000.000,280.000,0.00118289,1241.62,2.8665,4.3311,1426.9000,17.2120,116.2300,681.4100],
        [1000.000,290.000,0.00119843,1285.1,2.9444,4.3646,1400.4000,16.3640,112.8100,672.3600],
        [1000.000,300.000,0.0012148,1328.92,3.0215,4.4003,1373.4000,15.5270,109.6100,662.8200],
        [1000.000,310.000,0.00123207,1373.11,3.098,4.4382,1346.1000,14.7070,106.5900,652.8100],
        [1000.000,320.000,0.00125031,1417.69,3.1738,4.4781,1318.5000,13.9040,103.7300,642.3600],
        [1000.000,330.000,0.00126961,1462.68,3.249,4.5197,1290.8000,13.1240,101.0100,631.4700],
        [1000.000,340.000,0.00129006,1508.09,3.3236,4.5622,1263.0000,12.3660,98.4090,620.1800],
        [1000.000,350.000,0.00131176,1553.92,3.3978,4.6048,1235.2000,11.6320,95.9150,608.5000],
        [1000.000,360.000,0.00133481,1600.21,3.4715,4.6541,1207.4000,10.9220,93.5130,596.4700],
        [1000.000,370.000,0.00135934,1647.05,3.5449,4.7144,1179.3000,10.2320,91.1910,584.1100],
        [1000.000,380.000,0.00138548,1694.5,3.6181,4.7739,1150.7000,9.5566,88.9400,571.4500],
        [1000.000,390.000,0.00141337,1742.53,3.691,4.832,1121.9000,8.9058,86.7510,558.5200],
        [1000.000,400.000,0.00144317,1791.14,3.7638,4.8917,1093.3000,8.2826,84.6190,545.3300],
        [1000.000,410.000,0.00147508,1840.37,3.8364,4.9557,1065.0000,7.6892,82.5370,531.9300],
        [1000.000,420.000,0.00150929,1890.27,3.9089,5.0253,1037.2000,7.1273,80.5000,518.3300],
        [1000.000,430.000,0.00154605,1940.9,3.9814,5.1001,1010.0000,6.5981,78.5050,504.5600],
        [1000.000,440.000,0.00158559,1992.29,4.054,5.1784,983.7000,6.1028,76.5500,490.6300],
        [1000.000,450.000,0.00162815,2044.47,4.1267,5.2581,958.4300,5.6419,74.6370,476.6000],
        [1000.000,460.000,0.00167397,2097.44,4.1994,5.3363,934.3700,5.2154,72.7660,462.5000],
        [1000.000,470.000,0.00172324,2151.18,4.2722,5.4102,911.6600,4.8230,70.9450,448.3800],
        [1000.000,480.000,0.00177614,2205.62,4.345,5.4766,890.4200,4.4639,69.1770,434.3000],
        [1000.000,490.000,0.00183278,2260.68,4.4176,5.5326,870.7500,4.1369,67.4710,420.3400],
        [1000.000,500.000,0.00189324,2316.23,4.4899,5.5757,852.7300,3.8407,65.8330,406.5600],
        [1000.000,510.000,0.0019575,2372.14,4.5618,5.6038,836.4200,3.5740,64.2720,393.0500],
        [1000.000,520.000,0.00202548,2428.25,4.633,5.6155,821.8700,3.3348,62.7940,379.8800],
        [1000.000,530.000,0.00209703,2484.39,4.7033,5.6101,809.0700,3.1215,61.4040,367.1400],
        [1000.000,540.000,0.00217192,2540.4,4.7726,5.5877,798.0300,2.9322,60.1080,354.8900],
        [1000.000,550.000,0.00224984,2596.09,4.8407,5.549,788.6900,2.7647,58.9080,343.2000],
        [1000.000,560.000,0.00233047,2651.33,4.9074,5.4954,780.9700,2.6172,57.8060,332.1200],
        [1000.000,570.000,0.00241341,2705.96,4.9726,5.4288,774.8000,2.4874,56.8000,321.6900],
        [1000.000,580.000,0.00249829,2759.87,5.0361,5.3512,770.0500,2.3735,55.8890,311.9400],
        [1000.000,590.000,0.00258472,2812.94,5.098,5.2687,769.6900,2.2920,55.0700,302.8800],
        [1000.000,600.000,0.00267226,2865.07,5.158,5.1706,766.5300,2.1988,54.3390,294.5100],
        [1000.000,650.000,0.00311448,3110.6,5.4316,4.6275,767.3100,1.8904,51.8250,262.5600],
        [1000.000,700.000,0.00354616,3330.76,5.664,4.191,784.0800,1.7336,50.7110,242.8900],
        [1000.000,750.000,0.00395319,3530.68,5.8644,3.8235,801.5000,1.6250,50.4780,234.8400],
        [1000.000,800.000,0.00433551,3715.19,6.0405,3.5762,821.0000,1.5547,50.7810,232.2400],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

fn assert_pt_flash(
    p_bar: f64,
    t_deg_c: f64,
    v_m3_per_kg: f64,
    h_kj_per_kg: f64,
    s_kj_per_kg_k: f64,
    cp_kj_per_kg_k: f64,
    w_m_per_s: f64,
    kappa_dimensionless: f64,
    eta_micropascal_second: f64,
    lambda_milliwatt_per_meter_kelvin: f64,
){
    let p = Pressure::new::<bar>(p_bar);
    let t = ThermodynamicTemperature::new::<degree_celsius>(t_deg_c);
    let h_ref = AvailableEnergy::new::<kilojoule_per_kilogram>(h_kj_per_kg);
    // check if t is less than or equal to tsat 
    
    let t_sat = sat_temp_4(p);
    let fifty_kelvin = TemperatureInterval::new::<temperature_interval::kelvin>(50.0);
    
    let x: f64;
    
    if t > t_sat + fifty_kelvin {
        x = 1.0;
    } else {
        x = x_ph_flash(p, h_ref);
    };


    // assert h
    let h_test = h_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        h_kj_per_kg,
        h_test.get::<kilojoule_per_kilogram>(),
        max_relative=5e-3
        );

    // assert volume to within 0.01%  (that's the tolerable error for 
    // backward eqn)
    let v_test = v_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        v_m3_per_kg,
        v_test.get::<cubic_meter_per_kilogram>(),
        max_relative=1e-3
        );

    // now entropy 
    let s_test = s_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        s_kj_per_kg_k,
        s_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=5e-4
        );

    // cp 
    let cp_test = cp_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        cp_kj_per_kg_k,
        cp_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=5e-3
        );
    // w 
    let w_test = w_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        w_m_per_s,
        w_test.get::<meter_per_second>(),
        max_relative=5e-3
        );

    // kappa
    let kappa_test = kappa_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        kappa_dimensionless,
        kappa_test.get::<ratio>(),
        max_relative=9e-3
        );

    // lambda tbd
    //
    let eta_micropascal_second_test = mu_tp_eqm_two_phase(t, p, x)
        .get::<micropascal_second>();
    approx::assert_relative_eq!(
        eta_micropascal_second,
        eta_micropascal_second_test,
        max_relative=2e-2
        );




}




