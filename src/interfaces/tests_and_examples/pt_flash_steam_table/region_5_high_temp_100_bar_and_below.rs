use uom::si::{available_energy::kilojoule_per_kilogram, temperature_interval};
use uom::si::pressure::bar;
use uom::si::f64::*;
use uom::si::ratio::ratio;
use uom::si::specific_heat_capacity::kilojoule_per_kilogram_kelvin;
use uom::si::specific_volume::cubic_meter_per_kilogram;
use uom::si::thermodynamic_temperature::degree_celsius;

use crate::{interfaces::functional_programming::{ph_flash_eqm::x_ph_flash, pt_flash_eqm::{cp_tp_eqm_two_phase, h_tp_eqm_two_phase, kappa_tp_eqm_two_phase, s_tp_eqm_two_phase, v_tp_eqm_two_phase}}, region_4_vap_liq_equilibrium::sat_temp_4};

#[test]
pub fn single_phase_table_0_00611_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,0.006112127,810.333,4160.66,11.921,2.3423,1.2454],
        [820.0,0.006112127,825.435,4207.69,11.964,2.3573,1.2435],
        [840.0,0.006112127,840.538,4254.97,12.007,2.3707,1.2417],
        [860.0,0.006112127,855.64,4302.52,12.05,2.3841,1.2401],
        [880.0,0.006112127,870.742,4350.33,12.091,2.3975,1.2384],
        [900.0,0.006112127,885.844,4398.42,12.133,2.4109,1.2368],
        [920.0,0.006112127,900.946,4446.77,12.174,2.4243,1.2351],
        [940.0,0.006112127,916.048,4495.39,12.214,2.4376,1.2336],
        [960.0,0.006112127,931.15,4544.27,12.254,2.4508,1.232],
        [980.0,0.006112127,946.252,4593.42,12.294,2.4639,1.2305],
        [1000.0,0.006112127,961.354,4642.82,12.333,2.4769,1.229],
        [1020.0,0.006112127,976.456,4692.49,12.371,2.4898,1.2275],
        [1040.0,0.006112127,991.558,4742.42,12.41,2.5025,1.2261],
        [1060.0,0.006112127,1006.66,4792.59,12.448,2.5152,1.2247],
        [1080.0,0.006112127,1021.76,4843.02,12.485,2.5276,1.2234],
        [1100.0,0.006112127,1036.86,4893.7,12.522,2.54,1.2221],
        [1120.0,0.006112127,1051.97,4944.62,12.559,2.5521,1.2208],
        [1140.0,0.006112127,1067.07,4995.78,12.596,2.5641,1.2195],
        [1160.0,0.006112127,1082.17,5047.18,12.632,2.5759,1.2183],
        [1180.0,0.006112127,1097.27,5098.82,12.668,2.5876,1.2171],
        [1200.0,0.006112127,1112.37,5150.68,12.703,2.5991,1.2159],
        [1220.0,0.006112127,1127.48,5202.78,12.738,2.6104,1.2148],
        [1240.0,0.006112127,1142.58,5255.1,12.773,2.6215,1.2137],
        [1260.0,0.006112127,1157.68,5307.64,12.807,2.6325,1.2126],
        [1280.0,0.006112127,1172.78,5360.4,12.842,2.6432,1.2115],
        [1300.0,0.006112127,1187.88,5413.37,12.876,2.6538,1.2105],
        [1320.0,0.006112127,1202.99,5466.55,12.909,2.6642,1.2095],
        [1340.0,0.006112127,1218.09,5519.93,12.942,2.6745,1.2086],
        [1360.0,0.006112127,1233.19,5573.52,12.975,2.6845,1.2076],
        [1380.0,0.006112127,1248.29,5627.31,13.008,2.6944,1.2067],
        [1400.0,0.006112127,1263.39,5681.3,13.041,2.7041,1.2058],
        [1420.0,0.006112127,1278.5,5735.48,13.073,2.7136,1.2049],
        [1440.0,0.006112127,1293.6,5789.84,13.105,2.723,1.2041],
        [1460.0,0.006112127,1308.7,5844.39,13.136,2.7322,1.2033],
        [1480.0,0.006112127,1323.8,5899.13,13.168,2.7412,1.2025],
        [1500.0,0.006112127,1338.9,5954.04,13.199,2.7501,1.2017],
        [1550.0,0.006112127,1376.66,6092.08,13.276,2.7715,1.1998],
        [1600.0,0.006112127,1414.41,6231.18,13.351,2.7921,1.198],
        [1650.0,0.006112127,1452.17,6371.27,13.425,2.8117,1.1964],
        [1700.0,0.006112127,1489.92,6512.33,13.497,2.8305,1.1948],
        [1750.0,0.006112127,1527.68,6654.32,13.568,2.8486,1.1933],
        [1800.0,0.006112127,1565.43,6797.19,13.638,2.8661,1.1919],
        [1850.0,0.006112127,1603.19,6940.91,13.707,2.8829,1.1906],
        [1900.0,0.006112127,1640.94,7085.47,13.774,2.8992,1.1893],
        [1950.0,0.006112127,1678.7,7230.83,13.84,2.9152,1.1881],
        [2000.0,0.006112127,1716.45,7376.98,13.905,2.9307,1.1869],

        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

#[test]
pub fn single_phase_table_0_01_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,0.01,495.286,4160.66,11.694,2.3423,1.2454],
        [820.0,0.01,504.516,4207.69,11.737,2.3573,1.2435],
        [840.0,0.01,513.747,4254.97,11.78,2.3707,1.2417],
        [860.0,0.01,522.977,4302.51,11.822,2.3841,1.2401],
        [880.0,0.01,532.208,4350.33,11.864,2.3975,1.2384],
        [900.0,0.01,541.439,4398.42,11.906,2.4109,1.2368],
        [920.0,0.01,550.669,4446.77,11.946,2.4243,1.2351],
        [940.0,0.01,559.9,4495.39,11.987,2.4376,1.2336],
        [960.0,0.01,569.13,4544.27,12.027,2.4508,1.232],
        [980.0,0.01,578.361,4593.42,12.066,2.4639,1.2305],
        [1000.0,0.01,587.591,4642.82,12.106,2.4769,1.229],
        [1020.0,0.01,596.822,4692.49,12.144,2.4898,1.2275],
        [1040.0,0.01,606.053,4742.41,12.183,2.5025,1.2261],
        [1060.0,0.01,615.283,4792.59,12.22,2.5152,1.2247],
        [1080.0,0.01,624.514,4843.02,12.258,2.5276,1.2234],
        [1100.0,0.01,633.744,4893.7,12.295,2.54,1.2221],
        [1120.0,0.01,642.975,4944.62,12.332,2.5521,1.2208],
        [1140.0,0.01,652.205,4995.78,12.368,2.5641,1.2195],
        [1160.0,0.01,661.436,5047.18,12.405,2.5759,1.2183],
        [1180.0,0.01,670.666,5098.82,12.44,2.5876,1.2171],
        [1200.0,0.01,679.897,5150.68,12.476,2.5991,1.2159],
        [1220.0,0.01,689.128,5202.78,12.511,2.6104,1.2148],
        [1240.0,0.01,698.358,5255.1,12.546,2.6215,1.2137],
        [1260.0,0.01,707.589,5307.64,12.58,2.6325,1.2126],
        [1280.0,0.01,716.819,5360.4,12.614,2.6432,1.2115],
        [1300.0,0.01,726.05,5413.37,12.648,2.6538,1.2105],
        [1320.0,0.01,735.28,5466.55,12.682,2.6642,1.2095],
        [1340.0,0.01,744.511,5519.93,12.715,2.6745,1.2086],
        [1360.0,0.01,753.741,5573.52,12.748,2.6845,1.2076],
        [1380.0,0.01,762.972,5627.31,12.781,2.6944,1.2067],
        [1400.0,0.01,772.202,5681.3,12.813,2.7041,1.2058],
        [1420.0,0.01,781.433,5735.48,12.846,2.7136,1.2049],
        [1440.0,0.01,790.663,5789.84,12.878,2.723,1.2041],
        [1460.0,0.01,799.894,5844.39,12.909,2.7322,1.2033],
        [1480.0,0.01,809.125,5899.13,12.941,2.7412,1.2025],
        [1500.0,0.01,818.355,5954.04,12.972,2.7501,1.2017],
        [1550.0,0.01,841.431,6092.08,13.048,2.7715,1.1998],
        [1600.0,0.01,864.508,6231.18,13.124,2.7921,1.198],
        [1650.0,0.01,887.584,6371.27,13.198,2.8117,1.1964],
        [1700.0,0.01,910.66,6512.33,13.27,2.8305,1.1948],
        [1750.0,0.01,933.737,6654.32,13.341,2.8486,1.1933],
        [1800.0,0.01,956.813,6797.19,13.411,2.8661,1.1919],
        [1850.0,0.01,979.889,6940.91,13.479,2.8829,1.1906],
        [1900.0,0.01,1002.966,7085.47,13.547,2.8992,1.1893],
        [1950.0,0.01,1026.042,7230.83,13.613,2.9152,1.1881],
        [2000.0,0.01,1049.118,7376.98,13.678,2.9307,1.1869],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

#[test]
pub fn single_phase_table_0_1_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![


        [800.0,0.1,49.5278,4160.62,10.631,2.3424,1.2454],
        [820.0,0.1,50.4509,4207.65,10.675,2.3573,1.2435],
        [840.0,0.1,51.374,4254.93,10.717,2.3707,1.2418],
        [860.0,0.1,52.2971,4302.48,10.76,2.3842,1.2401],
        [880.0,0.1,53.2202,4350.3,10.802,2.3976,1.2384],
        [900.0,0.1,54.1433,4398.38,10.843,2.411,1.2368],
        [920.0,0.1,55.0664,4446.74,10.884,2.4243,1.2352],
        [940.0,0.1,55.9895,4495.36,10.924,2.4376,1.2336],
        [960.0,0.1,56.9126,4544.24,10.964,2.4508,1.232],
        [980.0,0.1,57.8357,4593.39,11.004,2.4639,1.2305],
        [1000.0,0.1,58.7588,4642.8,11.043,2.477,1.229],
        [1020.0,0.1,59.6819,4692.47,11.082,2.4898,1.2276],
        [1040.0,0.1,60.605,4742.39,11.12,2.5026,1.2261],
        [1060.0,0.1,61.5281,4792.57,11.158,2.5152,1.2247],
        [1080.0,0.1,62.4512,4843.0,11.195,2.5277,1.2234],
        [1100.0,0.1,63.3742,4893.67,11.232,2.54,1.2221],
        [1120.0,0.1,64.2973,4944.6,11.269,2.5522,1.2208],
        [1140.0,0.1,65.2204,4995.76,11.306,2.5642,1.2195],
        [1160.0,0.1,66.1435,5047.16,11.342,2.576,1.2183],
        [1180.0,0.1,67.0666,5098.8,11.378,2.5876,1.2171],
        [1200.0,0.1,67.9896,5150.67,11.413,2.5991,1.2159],
        [1220.0,0.1,68.9127,5202.76,11.448,2.6104,1.2148],
        [1240.0,0.1,69.8358,5255.08,11.483,2.6215,1.2137],
        [1260.0,0.1,70.7589,5307.62,11.518,2.6325,1.2126],
        [1280.0,0.1,71.6819,5360.38,11.552,2.6433,1.2116],
        [1300.0,0.1,72.605,5413.35,11.586,2.6538,1.2105],
        [1320.0,0.1,73.5281,5466.53,11.619,2.6643,1.2095],
        [1340.0,0.1,74.4512,5519.92,11.652,2.6745,1.2086],
        [1360.0,0.1,75.3742,5573.51,11.686,2.6845,1.2076],
        [1380.0,0.1,76.2973,5627.3,11.718,2.6944,1.2067],
        [1400.0,0.1,77.2204,5681.29,11.751,2.7041,1.2058],
        [1420.0,0.1,78.1434,5735.46,11.783,2.7136,1.2049],
        [1440.0,0.1,79.0665,5789.83,11.815,2.723,1.2041],
        [1460.0,0.1,79.9896,5844.38,11.846,2.7322,1.2033],
        [1480.0,0.1,80.9126,5899.12,11.878,2.7412,1.2025],
        [1500.0,0.1,81.8357,5954.03,11.909,2.7501,1.2017],
        [1550.0,0.1,84.1434,6092.08,11.986,2.7715,1.1998],
        [1600.0,0.1,86.451,6231.17,12.061,2.7921,1.198],
        [1650.0,0.1,88.7587,6371.27,12.135,2.8117,1.1964],
        [1700.0,0.1,91.0663,6512.33,12.207,2.8306,1.1948],
        [1750.0,0.1,93.374,6654.31,12.278,2.8487,1.1933],
        [1800.0,0.1,95.6816,6797.18,12.348,2.8661,1.1919],
        [1850.0,0.1,97.9893,6940.91,12.417,2.8829,1.1906],
        [1900.0,0.1,100.297,7085.47,12.484,2.8993,1.1893],
        [1950.0,0.1,102.605,7230.83,12.55,2.9152,1.1881],
        [2000.0,0.1,104.912,7376.98,12.615,2.9307,1.1869],

        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_1_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,1.0,4.95196,4160.21,9.5681,2.3434,1.2455],
        [820.0,1.0,5.04434,4207.26,9.6115,2.3582,1.2435],
        [840.0,1.0,5.1367,4254.56,9.6544,2.3716,1.2418],
        [860.0,1.0,5.22907,4302.12,9.6968,2.385,1.2401],
        [880.0,1.0,5.32143,4349.96,9.7386,2.3983,1.2385],
        [900.0,1.0,5.41379,4398.06,9.78,2.4117,1.2368],
        [920.0,1.0,5.50614,4446.42,9.8208,2.425,1.2352],
        [940.0,1.0,5.5985,4495.06,9.8613,2.4383,1.2337],
        [960.0,1.0,5.69085,4543.95,9.9012,2.4515,1.2321],
        [980.0,1.0,5.78319,4593.11,9.9408,2.4645,1.2306],
        [1000.0,1.0,5.87554,4642.54,9.9799,2.4775,1.2291],
        [1020.0,1.0,5.96788,4692.21,10.019,2.4904,1.2276],
        [1040.0,1.0,6.06023,4742.15,10.057,2.5031,1.2262],
        [1060.0,1.0,6.15257,4792.34,10.095,2.5157,1.2248],
        [1080.0,1.0,6.24491,4842.78,10.132,2.5281,1.2235],
        [1100.0,1.0,6.33724,4893.46,10.17,2.5404,1.2221],
        [1120.0,1.0,6.42958,4944.39,10.206,2.5526,1.2209],
        [1140.0,1.0,6.52191,4995.56,10.243,2.5646,1.2196],
        [1160.0,1.0,6.61425,5046.97,10.279,2.5764,1.2184],
        [1180.0,1.0,6.70658,5098.62,10.315,2.588,1.2172],
        [1200.0,1.0,6.79891,5150.49,10.35,2.5995,1.216],
        [1220.0,1.0,6.89124,5202.6,10.385,2.6108,1.2149],
        [1240.0,1.0,6.98357,5254.92,10.42,2.6219,1.2138],
        [1260.0,1.0,7.0759,5307.47,10.455,2.6328,1.2127],
        [1280.0,1.0,7.16822,5360.23,10.489,2.6436,1.2116],
        [1300.0,1.0,7.26055,5413.21,10.523,2.6541,1.2106],
        [1320.0,1.0,7.35287,5466.4,10.556,2.6645,1.2096],
        [1340.0,1.0,7.4452,5519.79,10.59,2.6748,1.2086],
        [1360.0,1.0,7.53752,5573.39,10.623,2.6848,1.2077],
        [1380.0,1.0,7.62985,5627.18,10.655,2.6947,1.2068],
        [1400.0,1.0,7.72217,5681.17,10.688,2.7044,1.2059],
        [1420.0,1.0,7.81449,5735.36,10.72,2.7139,1.205],
        [1440.0,1.0,7.90681,5789.73,10.752,2.7232,1.2042],
        [1460.0,1.0,7.99913,5844.28,10.784,2.7324,1.2033],
        [1480.0,1.0,8.09145,5899.02,10.815,2.7414,1.2025],
        [1500.0,1.0,8.18377,5953.94,10.846,2.7503,1.2018],
        [1550.0,1.0,8.41457,6091.99,10.923,2.7717,1.1999],
        [1600.0,1.0,8.64536,6231.1,10.998,2.7922,1.1981],
        [1650.0,1.0,8.87615,6371.2,11.072,2.8119,1.1965],
        [1700.0,1.0,9.10694,6512.27,11.145,2.8307,1.1949],
        [1750.0,1.0,9.33773,6654.26,11.216,2.8488,1.1934],
        [1800.0,1.0,9.56851,6797.14,11.285,2.8662,1.192],
        [1850.0,1.0,9.7993,6940.87,11.354,2.883,1.1907],
        [1900.0,1.0,10.0301,7085.43,11.421,2.8994,1.1894],
        [1950.0,1.0,10.2609,7230.8,11.487,2.9153,1.1882],
        [2000.0,1.0,10.4916,7376.95,11.552,2.9308,1.187],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_2_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,2.0,2.47553,4159.76000,9.24790,2.34450,1.24550],
        [820.0,2.0,2.52175,4206.83000,9.29130,2.35920,1.24360],
        [840.0,2.0,2.56797,4254.14000,9.33420,2.37250,1.24190],
        [860.0,2.0,2.61418,4301.73000,9.37660,2.38590,1.24020],
        [880.0,2.0,2.66039,4349.58000,9.41840,2.39920,1.23860],
        [900.0,2.0,2.70659,4397.69000,9.45980,2.41250,1.23690],
        [920.0,2.0,2.75279,4446.08000,9.50070,2.42580,1.23530],
        [940.0,2.0,2.79899,4494.73000,9.54110,2.43900,1.23370],
        [960.0,2.0,2.84519,4543.64000,9.58110,2.45210,1.23220],
        [980.0,2.0,2.89139,4592.81000,9.62070,2.46520,1.23070],
        [1020.0,2.0,2.98377,4691.93000,9.69850,2.49100,1.22770],
        [1040.0,2.0,3.02996,4741.88000,9.73690,2.50370,1.22630],
        [1060.0,2.0,3.07615,4792.08000,9.77480,2.51620,1.22490],
        [1080.0,2.0,3.12234,4842.53000,9.81240,2.52870,1.22360],
        [1100.0,2.0,3.16852,4893.23000,9.84960,2.54090,1.22220],
        [1120.0,2.0,3.21470,4944.17000,9.88640,2.55310,1.22100],
        [1140.0,2.0,3.26089,4995.35000,9.92290,2.56500,1.21970],
        [1160.0,2.0,3.30707,5046.77000,9.95900,2.57680,1.21850],
        [1180.0,2.0,3.35325,5098.42000,9.99480,2.58840,1.21730],
        [1200.0,2.0,3.39942,5150.30000,10.03000,2.59990,1.21610],
        [1220.0,2.0,3.44560,5202.41000,10.06500,2.61110,1.21500],
        [1240.0,2.0,3.49178,5254.75000,10.10000,2.62220,1.21390],
        [1260.0,2.0,3.53795,5307.30000,10.13500,2.63320,1.21280],
        [1280.0,2.0,3.58413,5360.07000,10.16900,2.64390,1.21170],
        [1300.0,2.0,3.63030,5413.06000,10.20300,2.65450,1.21070],
        [1320.0,2.0,3.67647,5466.25000,10.23600,2.66480,1.20970],
        [1340.0,2.0,3.72265,5519.65000,10.27000,2.67510,1.20870],
        [1360.0,2.0,3.76882,5573.25000,10.30300,2.68510,1.20780],
        [1380.0,2.0,3.81499,5627.05000,10.33500,2.69490,1.20690],
        [1400.0,2.0,3.86116,5681.05000,10.36800,2.70460,1.20600],
        [1420.0,2.0,3.90733,5735.23000,10.40000,2.71410,1.20510],
        [1440.0,2.0,3.95350,5789.61000,10.43200,2.72350,1.20430],
        [1460.0,2.0,3.99966,5844.17000,10.46400,2.73260,1.20340],
        [1480.0,2.0,4.04583,5898.92000,10.49500,2.74170,1.20260],
        [1500.0,2.0,4.09200,5953.84000,10.52600,2.75050,1.20180],
        [1550.0,2.0,4.20741,6091.90000,10.60300,2.77190,1.20000],
        [1600.0,2.0,4.32282,6231.01000,10.67800,2.79240,1.19820],
        [1650.0,2.0,4.43823,6371.13000,10.75200,2.81210,1.19650],
        [1700.0,2.0,4.55364,6512.21000,10.82500,2.83090,1.19500],
        [1750.0,2.0,4.66905,6654.20000,10.89600,2.84890,1.19350],
        [1800.0,2.0,4.78445,6797.09000,10.96500,2.86630,1.19210],
        [1850.0,2.0,4.89985,6940.83000,11.03400,2.88320,1.19080],
        [1900.0,2.0,5.01525,7085.40000,11.10100,2.89950,1.18950],
        [1950.0,2.0,5.13065,7230.77000,11.16700,2.91540,1.18830],
        [2000.0,2.0,5.24605,7376.93000,11.23200,2.93090,1.18710],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_4_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.00,4.00,1.23731,4158.85000,8.92730,2.34660,1.24570],
        [820.00,4.00,1.26046,4205.96000,8.97080,2.36120,1.24380],
        [840.00,4.00,1.28360,4253.31000,9.01370,2.37440,1.24210],
        [860.00,4.00,1.30673,4300.93000,9.05610,2.38770,1.24040],
        [880.00,4.00,1.32986,4348.82000,9.09800,2.40090,1.23880],
        [900.00,4.00,1.35299,4396.97000,9.13940,2.41410,1.23710],
        [920.00,4.00,1.37612,4445.38000,9.18030,2.42730,1.23550],
        [940.00,4.00,1.39924,4494.06000,9.22080,2.44040,1.23390],
        [960.00,4.00,1.42237,4543.00000,9.26080,2.45350,1.23240],
        [980.00,4.00,1.44548,4592.20000,9.30030,2.46650,1.23090],
        [1020.00,4.00,1.49172,4691.38000,9.37820,2.49220,1.22790],
        [1040.00,4.00,1.51483,4741.35000,9.41660,2.50480,1.22650],
        [1060.00,4.00,1.53794,4791.57000,9.45460,2.51730,1.22510],
        [1080.00,4.00,1.56105,4842.04000,9.49210,2.52970,1.22380],
        [1100.00,4.00,1.58416,4892.75000,9.52930,2.54190,1.22240],
        [1120.00,4.00,1.60727,4943.71000,9.56620,2.55400,1.22110],
        [1140.00,4.00,1.63037,4994.91000,9.60270,2.56590,1.21990],
        [1160.00,4.00,1.65348,5046.35000,9.63880,2.57770,1.21860],
        [1180.00,4.00,1.67658,5098.02000,9.67460,2.58930,1.21750],
        [1200.00,4.00,1.69968,5149.92000,9.71010,2.60070,1.21630],
        [1220.00,4.00,1.72278,5202.05000,9.74520,2.61190,1.21510],
        [1240.00,4.00,1.74588,5254.39000,9.78010,2.62300,1.21400],
        [1260.00,4.00,1.76898,5306.96000,9.81460,2.63390,1.21300],
        [1280.00,4.00,1.79208,5359.75000,9.84880,2.64460,1.21190],
        [1300.00,4.00,1.81518,5412.74000,9.88270,2.65510,1.21090],
        [1320.00,4.00,1.83827,5465.95000,9.91630,2.66550,1.20990],
        [1340.00,4.00,1.86137,5519.36000,9.94960,2.67570,1.20890],
        [1360.00,4.00,1.88446,5572.98000,9.98260,2.68570,1.20800],
        [1380.00,4.00,1.90756,5626.79000,10.01500,2.69550,1.20710],
        [1400.00,4.00,1.93065,5680.79000,10.04800,2.70520,1.20620],
        [1420.00,4.00,1.95374,5734.99000,10.08000,2.71460,1.20530],
        [1440.00,4.00,1.97684,5789.38000,10.11200,2.72400,1.20440],
        [1460.00,4.00,1.99993,5843.95000,10.14400,2.73310,1.20360],
        [1480.00,4.00,2.02302,5898.70000,10.17500,2.74210,1.20280],
        [1500.00,4.00,2.04611,5953.63000,10.20600,2.75090,1.20200],
        [1550.00,4.00,2.10383,6091.72000,10.28300,2.77230,1.20010],
        [1600.00,4.00,2.16156,6230.85000,10.35800,2.79280,1.19840],
        [1650.00,4.00,2.21927,6370.99000,10.43200,2.81240,1.19670],
        [1700.00,4.00,2.27699,6512.08000,10.50500,2.83120,1.19510],
        [1750.00,4.00,2.33471,6654.09000,10.57600,2.84920,1.19370],
        [1800.00,4.00,2.39242,6796.99000,10.64500,2.86660,1.19230],
        [1850.00,4.00,2.45013,6940.74000,10.71400,2.88340,1.19090],
        [1900.00,4.00,2.50784,7085.33000,10.78100,2.89970,1.18960],
        [1950.00,4.00,2.56555,7230.71000,10.84700,2.91560,1.18840],
        [2000.00,4.00,2.62326,7376.88000,10.91200,2.93110,1.18720],



        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}


#[test]
pub fn single_phase_table_6_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,6.0,0.824571,4157.95,8.7395,2.3488,1.2459],
        [820.0,6.0,0.840027,4205.09,8.783,2.3632,1.244],
        [840.0,6.0,0.855474,4252.48,8.826,2.3763,1.2423],
        [860.0,6.0,0.870917,4300.14,8.8684,2.3894,1.2406],
        [880.0,6.0,0.886357,4348.06,8.9103,2.4026,1.2389],
        [900.0,6.0,0.901794,4396.24,8.9517,2.4157,1.2373],
        [920.0,6.0,0.917229,4444.69,8.9927,2.4288,1.2357],
        [940.0,6.0,0.93266,4493.4,9.0332,2.4419,1.2341],
        [960.0,6.0,0.94809,4542.37,9.0732,2.4549,1.2326],
        [980.0,6.0,0.963517,4591.59,9.1128,2.4678,1.2311],
        [1020.0,6.0,0.994365,4690.82,9.1907,2.4933,1.2281],
        [1040.0,6.0,1.00979,4740.81,9.2291,2.5059,1.2267],
        [1060.0,6.0,1.02521,4791.05,9.2671,2.5184,1.2253],
        [1080.0,6.0,1.04062,4841.55,9.3047,2.5307,1.2239],
        [1100.0,6.0,1.05604,4892.28,9.3419,2.5429,1.2226],
        [1120.0,6.0,1.07145,4943.26,9.3787,2.5549,1.2213],
        [1140.0,6.0,1.08687,4994.48,9.4152,2.5668,1.2201],
        [1160.0,6.0,1.10228,5045.93,9.4514,2.5785,1.2188],
        [1180.0,6.0,1.11769,5097.62,9.4872,2.5901,1.2176],
        [1200.0,6.0,1.1331,5149.54,9.5227,2.6015,1.2165],
        [1220.0,6.0,1.14851,5201.68,9.5579,2.6127,1.2153],
        [1240.0,6.0,1.16392,5254.04,9.5927,2.6237,1.2142],
        [1260.0,6.0,1.17933,5306.62,9.6272,2.6346,1.2131],
        [1280.0,6.0,1.19473,5359.42,9.6614,2.6453,1.2121],
        [1300.0,6.0,1.21014,5412.43,9.6953,2.6558,1.2111],
        [1320.0,6.0,1.22554,5465.65,9.729,2.6661,1.2101],
        [1340.0,6.0,1.24094,5519.08,9.7623,2.6763,1.2091],
        [1360.0,6.0,1.25635,5572.7,9.7953,2.6862,1.2082],
        [1380.0,6.0,1.27175,5626.52,9.8281,2.6961,1.2072],
        [1400.0,6.0,1.28715,5680.54,9.8606,2.7057,1.2063],
        [1420.0,6.0,1.30255,5734.75,9.8928,2.7152,1.2055],
        [1440.0,6.0,1.31795,5789.15,9.9247,2.7245,1.2046],
        [1460.0,6.0,1.33335,5843.73,9.9564,2.7336,1.2038],
        [1480.0,6.0,1.34875,5898.49,9.9878,2.7426,1.203],
        [1500.0,6.0,1.36415,5953.43,10.019,2.7514,1.2022],
        [1550.0,6.0,1.40264,6091.54,10.096,2.7727,1.2003],
        [1600.0,6.0,1.44113,6230.69,10.171,2.7932,1.1985],
        [1650.0,6.0,1.47962,6370.84,10.245,2.8127,1.1969],
        [1700.0,6.0,1.51811,6511.95,10.317,2.8315,1.1953],
        [1750.0,6.0,1.55659,6653.98,10.388,2.8495,1.1938],
        [1800.0,6.0,1.59508,6796.89,10.458,2.8669,1.1924],
        [1850.0,6.0,1.63356,6940.66,10.527,2.8837,1.1911],
        [1900.0,6.0,1.67204,7085.25,10.594,2.9,1.1898],
        [1950.0,6.0,1.71051,7230.65,10.66,2.9158,1.1886],
        [2000.0,6.0,1.74899,7376.83,10.725,2.9313,1.1874],




        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}


#[test]
pub fn single_phase_table_8_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,8.0,0.618202,4157.04,8.606,2.351,1.246],
        [820.0,8.0,0.629812,4204.22,8.6496,2.3653,1.2442],
        [840.0,8.0,0.641412,4251.65,8.6926,2.3782,1.2425],
        [860.0,8.0,0.65301,4299.35,8.735,2.3912,1.2408],
        [880.0,8.0,0.664604,4347.3,8.777,2.4043,1.2391],
        [900.0,8.0,0.676195,4395.52,8.8184,2.4173,1.2375],
        [920.0,8.0,0.687783,4444.0,8.8594,2.4304,1.2359],
        [940.0,8.0,0.699369,4492.73,8.8999,2.4433,1.2343],
        [960.0,8.0,0.710952,4541.73,8.94,2.4563,1.2328],
        [980.0,8.0,0.722533,4590.98,8.9796,2.4691,1.2312],
        [1020.0,8.0,0.745689,4690.26,9.0576,2.4945,1.2283],
        [1040.0,8.0,0.757264,4740.28,9.096,2.5071,1.2269],
        [1060.0,8.0,0.768838,4790.54,9.134,2.5195,1.2255],
        [1080.0,8.0,0.78041,4841.05,9.1716,2.5318,1.2241],
        [1100.0,8.0,0.79198,4891.81,9.2088,2.5439,1.2228],
        [1120.0,8.0,0.803549,4942.81,9.2457,2.5559,1.2215],
        [1140.0,8.0,0.815116,4994.05,9.2822,2.5677,1.2203],
        [1160.0,8.0,0.826683,5045.52,9.3184,2.5794,1.219],
        [1180.0,8.0,0.838248,5097.22,9.3542,2.5909,1.2178],
        [1200.0,8.0,0.849812,5149.15,9.3897,2.6023,1.2167],
        [1220.0,8.0,0.861374,5201.31,9.4248,2.6134,1.2155],
        [1240.0,8.0,0.872936,5253.69,9.4597,2.6244,1.2144],
        [1260.0,8.0,0.884497,5306.29,9.4942,2.6353,1.2133],
        [1280.0,8.0,0.896057,5359.1,9.5284,2.6459,1.2123],
        [1300.0,8.0,0.907616,5412.12,9.5624,2.6564,1.2113],
        [1320.0,8.0,0.919174,5465.35,9.596,2.6667,1.2103],
        [1340.0,8.0,0.930732,5518.79,9.6293,2.6769,1.2093],
        [1360.0,8.0,0.942288,5572.43,9.6624,2.6868,1.2083],
        [1380.0,8.0,0.953844,5626.26,9.6951,2.6966,1.2074],
        [1400.0,8.0,0.9654,5680.29,9.7276,2.7062,1.2065],
        [1420.0,8.0,0.976954,5734.51,9.7598,2.7157,1.2056],
        [1440.0,8.0,0.988508,5788.92,9.7918,2.725,1.2048],
        [1460.0,8.0,1.00006,5843.51,9.8235,2.7341,1.204],
        [1480.0,8.0,1.01161,5898.28,9.8549,2.743,1.2032],
        [1500.0,8.0,1.02317,5953.23,9.886,2.7518,1.2024],
        [1550.0,8.0,1.05205,6091.36,9.9629,2.7732,1.2005],
        [1600.0,8.0,1.08092,6230.53,10.038,2.7936,1.1987],
        [1650.0,8.0,1.1098,6370.7,10.112,2.8131,1.197],
        [1700.0,8.0,1.13867,6511.82,10.184,2.8318,1.1955],
        [1750.0,8.0,1.16754,6653.87,10.256,2.8498,1.194],
        [1800.0,8.0,1.1964,6796.79,10.325,2.8672,1.1926],
        [1850.0,8.0,1.22527,6940.57,10.394,2.8839,1.1912],
        [1900.0,8.0,1.25413,7085.18,10.461,2.9002,1.1899],
        [1950.0,8.0,1.283,7230.59,10.527,2.916,1.1887],
        [2000.0,8.0,1.31186,7376.78,10.592,2.9315,1.1875],





        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_10_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,10.0,0.49438,4156.14,8.5024,2.3532,1.2462],
        [820.0,10.0,0.503682,4203.35,8.5459,2.3673,1.2443],
        [840.0,10.0,0.512975,4250.82,8.589,2.3801,1.2426],
        [860.0,10.0,0.522265,4298.56,8.6315,2.393,1.241],
        [880.0,10.0,0.531551,4346.55,8.6735,2.406,1.2393],
        [900.0,10.0,0.540835,4394.79,8.7149,2.4189,1.2377],
        [920.0,10.0,0.550116,4443.3,8.7559,2.4319,1.2361],
        [940.0,10.0,0.559394,4492.07,8.7965,2.4448,1.2345],
        [960.0,10.0,0.568669,4541.09,8.8366,2.4577,1.2329],
        [980.0,10.0,0.577943,4590.38,8.8762,2.4704,1.2314],
        [1020.0,10.0,0.596484,4689.7,8.9542,2.4957,1.2285],
        [1040.0,10.0,0.605751,4739.74,8.9926,2.5082,1.2271],
        [1060.0,10.0,0.615017,4790.03,9.0306,2.5206,1.2257],
        [1080.0,10.0,0.624281,4840.56,9.0682,2.5328,1.2243],
        [1100.0,10.0,0.633544,4891.34,9.1055,2.5449,1.223],
        [1120.0,10.0,0.642805,4942.36,9.1424,2.5568,1.2217],
        [1140.0,10.0,0.652065,4993.61,9.1789,2.5686,1.2204],
        [1160.0,10.0,0.661324,5045.1,9.2151,2.5803,1.2192],
        [1180.0,10.0,0.670581,5096.82,9.2509,2.5917,1.218],
        [1200.0,10.0,0.679837,5148.77,9.2864,2.6031,1.2168],
        [1220.0,10.0,0.689093,5200.94,9.3216,2.6142,1.2157],
        [1240.0,10.0,0.698347,5253.34,9.3565,2.6252,1.2146],
        [1260.0,10.0,0.7076,5305.95,9.391,2.636,1.2135],
        [1280.0,10.0,0.716852,5358.77,9.4252,2.6466,1.2125],
        [1300.0,10.0,0.726104,5411.81,9.4592,2.6571,1.2114],
        [1320.0,10.0,0.735354,5465.06,9.4928,2.6673,1.2104],
        [1340.0,10.0,0.744604,5518.5,9.5261,2.6775,1.2095],
        [1360.0,10.0,0.753853,5572.15,9.5592,2.6874,1.2085],
        [1380.0,10.0,0.763101,5626.0,9.592,2.6972,1.2076],
        [1400.0,10.0,0.772349,5680.04,9.6245,2.7068,1.2067],
        [1420.0,10.0,0.781596,5734.27,9.6567,2.7162,1.2058],
        [1440.0,10.0,0.790843,5788.68,9.6886,2.7255,1.205],
        [1460.0,10.0,0.800088,5843.28,9.7203,2.7346,1.2041],
        [1480.0,10.0,0.809334,5898.07,9.7517,2.7435,1.2033],
        [1500.0,10.0,0.818578,5953.02,9.7829,2.7523,1.2025],
        [1550.0,10.0,0.841688,6091.17,9.8597,2.7736,1.2007],
        [1600.0,10.0,0.864795,6230.37,9.9351,2.7939,1.1989],
        [1650.0,10.0,0.8879,6370.55,10.009,2.8134,1.1972],
        [1700.0,10.0,0.911002,6511.7,10.081,2.8321,1.1956],
        [1750.0,10.0,0.934102,6653.75,10.152,2.8501,1.1941],
        [1800.0,10.0,0.9572,6796.7,10.222,2.8674,1.1927],
        [1850.0,10.0,0.980297,6940.49,10.291,2.8842,1.1914],
        [1900.0,10.0,1.00339,7085.11,10.358,2.9004,1.1901],
        [1950.0,10.0,1.02649,7230.53,10.424,2.9163,1.1889],
        [2000.0,10.0,1.04958,7376.73,10.489,2.9317,1.1877],




        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}


#[test]
pub fn single_phase_table_20_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,20.0,0.246737,4151.59,8.1791,2.3642,1.247],
        [820.0,20.0,0.251424,4199.0,8.2228,2.3774,1.2452],
        [840.0,20.0,0.256102,4246.67,8.266,2.3897,1.2435],
        [860.0,20.0,0.260776,4294.58,8.3087,2.4021,1.2419],
        [880.0,20.0,0.265447,4342.75,8.3508,2.4145,1.2402],
        [900.0,20.0,0.270116,4391.17,8.3925,2.427,1.2386],
        [920.0,20.0,0.274781,4439.83,8.4336,2.4396,1.237],
        [940.0,20.0,0.279444,4488.75,8.4742,2.4521,1.2354],
        [960.0,20.0,0.284105,4537.92,8.5144,2.4646,1.2339],
        [980.0,20.0,0.288763,4587.33,8.5542,2.477,1.2324],
        [1020.0,20.0,0.298073,4686.91,8.6324,2.5017,1.2294],
        [1040.0,20.0,0.302726,4737.06,8.6709,2.5139,1.228],
        [1060.0,20.0,0.307376,4787.46,8.709,2.526,1.2266],
        [1080.0,20.0,0.312025,4838.1,8.7467,2.538,1.2253],
        [1100.0,20.0,0.316673,4888.98,8.784,2.5498,1.2239],
        [1120.0,20.0,0.321319,4940.1,8.821,2.5616,1.2226],
        [1140.0,20.0,0.325963,4991.44,8.8576,2.5732,1.2214],
        [1160.0,20.0,0.330607,5043.02,8.8938,2.5846,1.2201],
        [1180.0,20.0,0.335249,5094.83,8.9297,2.5959,1.2189],
        [1200.0,20.0,0.33989,5146.86,8.9653,2.607,1.2178],
        [1220.0,20.0,0.34453,5199.11,9.0005,2.618,1.2166],
        [1240.0,20.0,0.349169,5251.58,9.0354,2.6288,1.2155],
        [1260.0,20.0,0.353806,5304.26,9.07,2.6395,1.2144],
        [1280.0,20.0,0.358443,5357.15,9.1043,2.65,1.2134],
        [1300.0,20.0,0.36308,5410.26,9.1382,2.6603,1.2124],
        [1320.0,20.0,0.367715,5463.56,9.1719,2.6705,1.2113],
        [1340.0,20.0,0.372349,5517.07,9.2053,2.6805,1.2104],
        [1360.0,20.0,0.376983,5570.78,9.2384,2.6903,1.2094],
        [1380.0,20.0,0.381616,5624.68,9.2712,2.6999,1.2085],
        [1400.0,20.0,0.386249,5678.78,9.3037,2.7094,1.2076],
        [1420.0,20.0,0.39088,5733.06,9.336,2.7188,1.2067],
        [1440.0,20.0,0.395512,5787.53,9.3679,2.7279,1.2059],
        [1460.0,20.0,0.400142,5842.18,9.3997,2.737,1.205],
        [1480.0,20.0,0.404772,5897.0,9.4311,2.7458,1.2042],
        [1500.0,20.0,0.409402,5952.01,9.4623,2.7545,1.2034],
        [1550.0,20.0,0.420973,6090.27,9.5392,2.7756,1.2015],
        [1600.0,20.0,0.432542,6229.55,9.6146,2.7958,1.1997],
        [1650.0,20.0,0.444108,6369.83,9.6885,2.8152,1.198],
        [1700.0,20.0,0.455672,6511.06,9.761,2.8337,1.1965],
        [1750.0,20.0,0.467234,6653.19,9.8321,2.8516,1.195],
        [1800.0,20.0,0.478794,6796.21,9.9019,2.8688,1.1935],
        [1850.0,20.0,0.490353,6940.07,9.9705,2.8855,1.1922],
        [1900.0,20.0,0.50191,7084.74,10.038,2.9016,1.1909],
        [1950.0,20.0,0.513466,7230.22,10.104,2.9173,1.1896],
        [2000.0,20.0,0.52502,7376.47,10.169,2.9328,1.1884],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_40_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,40.0,0.122915,4142.46,7.8523,2.3865,1.2487],
        [820.0,40.0,0.125295,4190.26,7.8964,2.398,1.2471],
        [840.0,40.0,0.127665,4238.33,7.94,2.4091,1.2454],
        [860.0,40.0,0.130032,4286.62,7.983,2.4204,1.2438],
        [880.0,40.0,0.132396,4335.14,8.0255,2.4318,1.2421],
        [900.0,40.0,0.134757,4383.89,8.0674,2.4434,1.2405],
        [920.0,40.0,0.137115,4432.88,8.1088,2.4551,1.2389],
        [940.0,40.0,0.139471,4482.1,8.1497,2.4668,1.2374],
        [960.0,40.0,0.141824,4531.55,8.1901,2.4785,1.2358],
        [980.0,40.0,0.144174,4581.24,8.2301,2.4903,1.2343],
        [1020.0,40.0,0.148869,4681.32,8.3087,2.5137,1.2314],
        [1040.0,40.0,0.151214,4731.71,8.3474,2.5253,1.2299],
        [1060.0,40.0,0.153557,4782.33,8.3856,2.5369,1.2286],
        [1080.0,40.0,0.155898,4833.19,8.4235,2.5484,1.2272],
        [1100.0,40.0,0.158238,4884.27,8.461,2.5598,1.2259],
        [1120.0,40.0,0.160577,4935.58,8.4981,2.5711,1.2246],
        [1140.0,40.0,0.162914,4987.11,8.5348,2.5822,1.2233],
        [1160.0,40.0,0.165249,5038.86,8.5712,2.5933,1.2221],
        [1180.0,40.0,0.167584,5090.84,8.6072,2.6042,1.2208],
        [1200.0,40.0,0.169917,5143.03,8.6429,2.615,1.2197],
        [1220.0,40.0,0.172249,5195.44,8.6782,2.6256,1.2185],
        [1240.0,40.0,0.174581,5248.06,8.7132,2.6362,1.2174],
        [1260.0,40.0,0.176911,5300.88,8.7479,2.6465,1.2163],
        [1280.0,40.0,0.17924,5353.92,8.7822,2.6567,1.2152],
        [1300.0,40.0,0.181569,5407.15,8.8163,2.6668,1.2142],
        [1320.0,40.0,0.183896,5460.59,8.8501,2.6767,1.2132],
        [1340.0,40.0,0.186223,5514.22,8.8835,2.6864,1.2122],
        [1360.0,40.0,0.188549,5568.04,8.9167,2.696,1.2112],
        [1380.0,40.0,0.190875,5622.06,8.9495,2.7055,1.2103],
        [1400.0,40.0,0.193199,5676.26,8.9821,2.7148,1.2094],
        [1420.0,40.0,0.195524,5730.65,9.0144,2.7239,1.2085],
        [1440.0,40.0,0.197847,5785.22,9.0465,2.7329,1.2076],
        [1460.0,40.0,0.20017,5839.97,9.0783,2.7417,1.2068],
        [1480.0,40.0,0.202492,5894.89,9.1098,2.7504,1.206],
        [1500.0,40.0,0.204814,5949.98,9.141,2.759,1.2052],
        [1550.0,40.0,0.210617,6088.45,9.218,2.7797,1.2032],
        [1600.0,40.0,0.216416,6227.94,9.2935,2.7996,1.2014],
        [1650.0,40.0,0.222213,6368.4,9.3675,2.8186,1.1997],
        [1700.0,40.0,0.228008,6509.79,9.4401,2.8369,1.1981],
        [1750.0,40.0,0.233801,6652.08,9.5113,2.8545,1.1966],
        [1800.0,40.0,0.239592,6795.23,9.5812,2.8715,1.1951],
        [1850.0,40.0,0.245382,6939.22,9.6498,2.888,1.1937],
        [1900.0,40.0,0.25117,7084.02,9.7172,2.904,1.1924],
        [1950.0,40.0,0.256956,7229.61,9.7835,2.9195,1.1911],
        [2000.0,40.0,0.262741,7375.97,9.8486,2.9348,1.1899],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_60_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,60.0,0.0816416,4133.27,7.6583,2.4092,1.2506],
        [820.0,60.0,0.0832519,4181.48,7.7028,2.419,1.249],
        [840.0,60.0,0.0848536,4229.95,7.7468,2.4288,1.2474],
        [860.0,60.0,0.0864518,4278.63,7.7901,2.439,1.2457],
        [880.0,60.0,0.0880467,4327.52,7.8329,2.4494,1.2441],
        [900.0,60.0,0.0896384,4376.61,7.8751,2.46,1.2425],
        [920.0,60.0,0.0912274,4425.92,7.9167,2.4708,1.2409],
        [940.0,60.0,0.0928137,4475.44,7.9579,2.4816,1.2393],
        [960.0,60.0,0.0943976,4525.18,7.9986,2.4926,1.2378],
        [980.0,60.0,0.0959791,4575.14,8.0388,2.5036,1.2363],
        [1020.0,60.0,0.0991359,4675.73,8.1178,2.5258,1.2334],
        [1040.0,60.0,0.100711,4726.36,8.1566,2.5368,1.2319],
        [1060.0,60.0,0.102285,4777.21,8.1951,2.5479,1.2305],
        [1080.0,60.0,0.103857,4828.27,8.2331,2.5588,1.2292],
        [1100.0,60.0,0.105428,4879.56,8.2707,2.5697,1.2278],
        [1120.0,60.0,0.106997,4931.06,8.3079,2.5806,1.2265],
        [1140.0,60.0,0.108565,4982.78,8.3448,2.5913,1.2252],
        [1160.0,60.0,0.110131,5034.71,8.3813,2.602,1.224],
        [1180.0,60.0,0.111697,5086.86,8.4174,2.6125,1.2228],
        [1200.0,60.0,0.113261,5139.22,8.4532,2.623,1.2216],
        [1220.0,60.0,0.114824,5191.78,8.4886,2.6333,1.2204],
        [1240.0,60.0,0.116386,5244.55,8.5237,2.6435,1.2193],
        [1260.0,60.0,0.117947,5297.52,8.5585,2.6535,1.2182],
        [1280.0,60.0,0.119507,5350.69,8.593,2.6635,1.2171],
        [1300.0,60.0,0.121066,5404.05,8.6271,2.6733,1.2161],
        [1320.0,60.0,0.122625,5457.62,8.661,2.6829,1.2151],
        [1340.0,60.0,0.124182,5511.37,8.6945,2.6924,1.2141],
        [1360.0,60.0,0.125739,5565.31,8.7277,2.7018,1.2131],
        [1380.0,60.0,0.127295,5619.44,8.7607,2.711,1.2121],
        [1400.0,60.0,0.128851,5673.75,8.7933,2.7201,1.2112],
        [1420.0,60.0,0.130406,5728.25,8.8257,2.7291,1.2103],
        [1440.0,60.0,0.13196,5782.92,8.8578,2.7379,1.2094],
        [1460.0,60.0,0.133514,5837.76,8.8896,2.7465,1.2086],
        [1480.0,60.0,0.135067,5892.78,8.9212,2.7551,1.2078],
        [1500.0,60.0,0.136619,5947.96,8.9525,2.7634,1.2069],
        [1550.0,60.0,0.140499,6086.65,9.0296,2.7838,1.205],
        [1600.0,60.0,0.144375,6226.33,9.1052,2.8033,1.2031],
        [1650.0,60.0,0.148249,6366.96,9.1793,2.8221,1.2014],
        [1700.0,60.0,0.152121,6508.52,9.252,2.8401,1.1998],
        [1750.0,60.0,0.155991,6650.97,9.3232,2.8575,1.1982],
        [1800.0,60.0,0.159859,6794.26,9.3932,2.8743,1.1967],
        [1850.0,60.0,0.163725,6938.38,9.4619,2.8905,1.1953],
        [1900.0,60.0,0.16759,7083.31,9.5294,2.9063,1.194],
        [1950.0,60.0,0.171453,7229.01,9.5957,2.9217,1.1927],
        [2000.0,60.0,0.175316,7375.47,9.6608,2.9368,1.1914],



        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_80_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,80.0,0.0610054,4124.02,7.5186,2.4322,1.2526],
        [820.0,80.0,0.0622309,4172.66,7.5635,2.4404,1.2511],
        [840.0,80.0,0.0634484,4221.55,7.6078,2.4489,1.2494],
        [860.0,80.0,0.0646622,4270.62,7.6515,2.4578,1.2478],
        [880.0,80.0,0.0658726,4319.87,7.6946,2.4672,1.2462],
        [900.0,80.0,0.0670799,4369.31,7.7371,2.4767,1.2446],
        [920.0,80.0,0.0682844,4418.94,7.779,2.4866,1.243],
        [940.0,80.0,0.0694862,4468.77,7.8205,2.4966,1.2414],
        [960.0,80.0,0.0706855,4518.81,7.8614,2.5068,1.2399],
        [980.0,80.0,0.0718825,4569.05,7.9018,2.5171,1.2383],
        [1020.0,80.0,0.0742701,4670.15,7.9812,2.5379,1.2354],
        [1040.0,80.0,0.0754611,4721.01,8.0202,2.5484,1.2339],
        [1060.0,80.0,0.0766503,4772.08,8.0588,2.5589,1.2325],
        [1080.0,80.0,0.0778378,4823.36,8.097,2.5693,1.2312],
        [1100.0,80.0,0.0790238,4874.85,8.1348,2.5797,1.2298],
        [1120.0,80.0,0.0802083,4926.55,8.1722,2.5901,1.2285],
        [1140.0,80.0,0.0813914,4978.46,8.2092,2.6005,1.2272],
        [1160.0,80.0,0.0825733,5030.57,8.2458,2.6107,1.226],
        [1180.0,80.0,0.0837539,5082.89,8.282,2.6209,1.2247],
        [1200.0,80.0,0.0849334,5135.41,8.3179,2.631,1.2235],
        [1220.0,80.0,0.0861118,5188.12,8.3535,2.6409,1.2224],
        [1240.0,80.0,0.0872891,5241.04,8.3887,2.6508,1.2212],
        [1260.0,80.0,0.0884655,5294.16,8.4235,2.6606,1.2201],
        [1280.0,80.0,0.089641,5347.47,8.4581,2.6702,1.219],
        [1300.0,80.0,0.0908156,5400.97,8.4923,2.6798,1.218],
        [1320.0,80.0,0.0919894,5454.65,8.5262,2.6892,1.2169],
        [1340.0,80.0,0.0931624,5508.53,8.5598,2.6984,1.2159],
        [1360.0,80.0,0.0943346,5562.59,8.5931,2.7076,1.215],
        [1380.0,80.0,0.0955062,5616.83,8.6261,2.7166,1.214],
        [1400.0,80.0,0.096677,5671.25,8.6589,2.7255,1.2131],
        [1420.0,80.0,0.0978473,5725.85,8.6913,2.7342,1.2122],
        [1440.0,80.0,0.0990169,5780.62,8.7235,2.7428,1.2113],
        [1460.0,80.0,0.100186,5835.56,8.7554,2.7513,1.2104],
        [1480.0,80.0,0.101354,5890.67,8.787,2.7597,1.2095],
        [1500.0,80.0,0.102522,5945.95,8.8183,2.7679,1.2087],
        [1550.0,80.0,0.10544,6084.85,8.8956,2.7879,1.2067],
        [1600.0,80.0,0.108355,6224.72,8.9713,2.8071,1.2049],
        [1650.0,80.0,0.111268,6365.54,9.0454,2.8255,1.2031],
        [1700.0,80.0,0.114178,6507.26,9.1182,2.8433,1.2014],
        [1750.0,80.0,0.117086,6649.86,9.1896,2.8604,1.1999],
        [1800.0,80.0,0.119993,6793.3,9.2596,2.877,1.1984],
        [1850.0,80.0,0.122897,6937.55,9.3284,2.893,1.1969],
        [1900.0,80.0,0.125801,7082.59,9.3959,2.9087,1.1955],
        [1950.0,80.0,0.128703,7228.41,9.4622,2.9239,1.1942],
        [2000.0,80.0,0.131603,7374.98,9.5274,2.9389,1.1929],

        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}
#[test]
pub fn single_phase_table_100_bar(){

    let steam_table: Vec<[f64; 7]> =
        vec![
        [800.0,100.0,0.0486242,4114.73,7.4087,2.4555,1.2548],
        [820.0,100.0,0.0496189,4163.82,7.4539,2.4621,1.2532],
        [840.0,100.0,0.0506058,4213.13,7.4986,2.4693,1.2516],
        [860.0,100.0,0.051589,4262.59,7.5427,2.477,1.2499],
        [880.0,100.0,0.0525689,4312.21,7.5861,2.4851,1.2483],
        [900.0,100.0,0.0535456,4362.0,7.6289,2.4937,1.2467],
        [920.0,100.0,0.0545194,4411.96,7.6711,2.5026,1.2451],
        [940.0,100.0,0.0554905,4462.1,7.7128,2.5117,1.2435],
        [960.0,100.0,0.0564591,4512.43,7.754,2.5211,1.242],
        [980.0,100.0,0.0574253,4562.95,7.7946,2.5306,1.2404],
        [1020.0,100.0,0.0593515,4664.56,7.8744,2.5501,1.2375],
        [1040.0,100.0,0.0603117,4715.66,7.9136,2.56,1.236],
        [1060.0,100.0,0.0612701,4766.96,7.9524,2.5699,1.2346],
        [1080.0,100.0,0.0622268,4818.46,7.9907,2.5798,1.2332],
        [1100.0,100.0,0.063182,4870.16,8.0287,2.5898,1.2319],
        [1120.0,100.0,0.0641358,4922.05,8.0662,2.5997,1.2305],
        [1140.0,100.0,0.0650881,4974.14,8.1033,2.6096,1.2292],
        [1160.0,100.0,0.0660392,5026.43,8.14,2.6194,1.228],
        [1180.0,100.0,0.066989,5078.92,8.1764,2.6292,1.2267],
        [1200.0,100.0,0.0679377,5131.6,8.2124,2.639,1.2255],
        [1220.0,100.0,0.0688853,5184.48,8.2481,2.6486,1.2244],
        [1240.0,100.0,0.0698319,5237.55,8.2834,2.6582,1.2232],
        [1260.0,100.0,0.0707775,5290.8,8.3183,2.6676,1.2221],
        [1280.0,100.0,0.0717221,5344.25,8.353,2.677,1.221],
        [1300.0,100.0,0.0726659,5397.88,8.3873,2.6863,1.2199],
        [1320.0,100.0,0.0736089,5451.7,8.4213,2.6954,1.2189],
        [1340.0,100.0,0.0745511,5505.7,8.455,2.7044,1.2178],
        [1360.0,100.0,0.0754926,5559.88,8.4883,2.7133,1.2168],
        [1380.0,100.0,0.0764333,5614.23,8.5214,2.7221,1.2159],
        [1400.0,100.0,0.0773734,5668.76,8.5542,2.7308,1.2149],
        [1420.0,100.0,0.0783129,5723.46,8.5867,2.7394,1.214],
        [1440.0,100.0,0.0792517,5778.34,8.6189,2.7478,1.2131],
        [1460.0,100.0,0.08019,5833.37,8.6509,2.7561,1.2122],
        [1480.0,100.0,0.0811277,5888.58,8.6825,2.7643,1.2114],
        [1500.0,100.0,0.0820649,5943.94,8.7139,2.7723,1.2105],
        [1550.0,100.0,0.0844057,6083.05,8.7913,2.7919,1.2085],
        [1600.0,100.0,0.0867437,6223.13,8.8671,2.8108,1.2066],
        [1650.0,100.0,0.0890792,6364.12,8.9414,2.829,1.2048],
        [1700.0,100.0,0.0914125,6506.01,9.014,2.8465,1.2031],
        [1750.0,100.0,0.0937437,6648.76,9.086,2.8634,1.2015],
        [1800.0,100.0,0.0960732,6792.34,9.156,2.8797,1.2],
        [1850.0,100.0,0.098401,6936.72,9.225,2.8956,1.1985],
        [1900.0,100.0,0.100727,7081.89,9.292,2.911,1.1971],
        [1950.0,100.0,0.103052,7227.82,9.359,2.9261,1.1958],
        [2000.0,100.0,0.105376,7374.49,9.424,2.9409,1.1945],


        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let p_bar = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let kappa_dimensionless = dataset[6];
            assert_pt_flash_high_temp(t_deg_c, p_bar, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, kappa_dimensionless, 
                );
        }

}

fn assert_pt_flash_high_temp(
    t_deg_c: f64,
    p_bar: f64,
    v_m3_per_kg: f64,
    h_kj_per_kg: f64,
    s_kj_per_kg_k: f64,
    cp_kj_per_kg_k: f64,
    kappa_dimensionless: f64,
){
    let p = Pressure::new::<bar>(p_bar);
    let t = ThermodynamicTemperature::new::<degree_celsius>(t_deg_c);
    let h_ref = AvailableEnergy::new::<kilojoule_per_kilogram>(h_kj_per_kg);
    // check if t is less than or equal to tsat 
    
    let t_sat = sat_temp_4(p);
    let fifty_kelvin = TemperatureInterval::new::<temperature_interval::kelvin>(50.0);
    
    let x: f64;
    
    if t > t_sat + fifty_kelvin {
        x = 1.0;
    } else {
        x = x_ph_flash(p, h_ref);
    };


    // assert h
    let h_test = h_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        h_kj_per_kg,
        h_test.get::<kilojoule_per_kilogram>(),
        max_relative=2e-4
        );

    // assert volume to within 0.01%  (that's the tolerable error for 
    // backward eqn)
    let v_test = v_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        v_m3_per_kg,
        v_test.get::<cubic_meter_per_kilogram>(),
        max_relative=1e-4
        );

    // now entropy 
    let s_test = s_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        s_kj_per_kg_k,
        s_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=1e-3
        );

    // cp 
    let cp_test = cp_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        cp_kj_per_kg_k,
        cp_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=1e-3
        );

    // kappa
    let kappa_test = kappa_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        kappa_dimensionless,
        kappa_test.get::<ratio>(),
        max_relative=9e-3
        );

    // eta and lambda tbd



}




