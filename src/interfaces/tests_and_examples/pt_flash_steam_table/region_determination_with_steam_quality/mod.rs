use uom::si::{pressure::bar, thermodynamic_temperature::kelvin};
use uom::si::f64::*;

use crate::interfaces::functional_programming::pt_flash_eqm::{region_fwd_eqn_two_phase, FwdEqnRegion};


/// saturation table (see page 174)
#[test]
pub fn region_determination_saturated_steam(){

    //[t_deg_c,t_kelvin,psat_bar,v_liq_m3_per_kg,v_vap_m3_per_kg,h_liq_kj_per_kg,h_vap_kj_per_kg,enthalpy_of_vap,s_liq_kj_per_kg_k,s_vap_kj_per_kg_k],
    let steam_table: Vec<[f64; 10]> =
        vec![
        //[0.0,273.15,0.006112127,0.00100021,206.14,-0.041588,2500.89,2500.93,-0.00015455,9.1558],
        [0.01,273.16,0.00611657,0.00100021,205.997,0.00061178,2500.91,2500.91,0.0,9.1555],
        [1.0,274.15,0.00657088,0.00100015,192.445,4.17665,2502.73,2498.55,0.01526,9.1291],
        [2.0,275.15,0.00705988,0.00100011,179.764,8.3916,2504.57,2496.17,0.030606,9.1027],
        [3.0,276.15,0.00758082,0.00100008,168.014,12.6035,2506.4,2493.8,0.045886,9.0765],
        [4.0,277.15,0.00813549,0.00100007,157.121,16.8127,2508.24,2491.42,0.061101,9.0506],
        [5.0,278.15,0.00872575,0.00100008,147.017,21.0194,2510.07,2489.05,0.076252,9.0249],
        [6.0,279.15,0.00935353,0.00100011,137.638,25.2237,2511.91,2486.68,0.09134,8.9994],
        [7.0,280.15,0.0100209,0.00100014,128.928,29.4258,2513.74,2484.31,0.10637,8.9742],
        [8.0,281.15,0.0107299,0.0010002,120.834,33.626,2515.57,2481.94,0.12133,8.9492],
        [9.0,282.15,0.0114828,0.00100027,113.309,37.8244,2517.4,2479.58,0.13624,8.9244],
        [10.0,283.15,0.0122818,0.00100035,106.309,42.0211,2519.23,2477.21,0.15109,8.8998],
        [11.0,284.15,0.0131295,0.00100044,99.7927,46.2162,2521.06,2474.84,0.16587,8.8755],
        [12.0,285.15,0.0140282,0.00100055,93.7243,50.41,2522.89,2472.48,0.18061,8.8514],
        [13.0,286.15,0.0149806,0.00100067,88.0698,54.6024,2524.71,2470.11,0.19528,8.8275],
        [14.0,287.15,0.0159894,0.0010008,82.7981,58.7936,2526.54,2467.75,0.2099,8.8038],
        [15.0,288.15,0.0170574,0.00100095,77.8807,62.9837,2528.36,2465.38,0.22447,8.7804],
        [16.0,289.15,0.0181876,0.0010011,73.2915,67.1727,2530.19,2463.01,0.23898,8.7571],
        [17.0,290.15,0.0193829,0.00100127,69.0063,71.3608,2532.01,2460.65,0.25344,8.7341],
        [18.0,291.15,0.0206466,0.00100145,65.0029,75.5479,2533.83,2458.28,0.26785,8.7112],
        [19.0,292.15,0.0219818,0.00100164,61.2609,79.7343,2535.65,2455.92,0.2822,8.6886],
        [20.0,293.15,0.0233921,0.00100184,57.7615,83.9199,2537.47,2453.55,0.2965,8.6661],
        [21.0,294.15,0.024881,0.00100205,54.4873,88.1048,2539.29,2451.18,0.31075,8.6439],
        [22.0,295.15,0.0264521,0.00100228,51.4225,92.289,2541.1,2448.81,0.32495,8.6218],
        [23.0,296.15,0.0281092,0.00100251,48.5521,96.4727,2542.92,2446.45,0.3391,8.6],
        [24.0,297.15,0.0298563,0.00100275,45.8626,100.656,2544.73,2444.08,0.3532,8.5783],
        [25.0,298.15,0.0316975,0.00100301,43.3414,104.838,2546.54,2441.71,0.36726,8.5568],
        [26.0,299.15,0.0336369,0.00100327,40.9768,109.021,2548.35,2439.33,0.38126,8.5355],
        [27.0,300.15,0.0356789,0.00100354,38.7582,113.202,2550.16,2436.96,0.39521,8.5144],
        [28.0,301.15,0.0378281,0.00100382,36.6754,117.384,2551.97,2434.59,0.40912,8.4934],
        [29.0,302.15,0.0400892,0.00100411,34.7194,121.565,2553.78,2432.21,0.42298,8.4727],
        [30.0,303.15,0.0424669,0.00100441,32.8816,125.745,2555.58,2429.84,0.43679,8.4521],
        [31.0,304.15,0.0449663,0.00100472,31.154,129.926,2557.39,2427.46,0.45056,8.4317],
        [32.0,305.15,0.0475925,0.00100504,29.5295,134.106,2559.19,2425.08,0.46428,8.4115],
        [33.0,306.15,0.0503508,0.00100536,28.001,138.286,2560.99,2422.7,0.47795,8.3914],
        [34.0,307.15,0.0532469,0.0010057,26.5624,142.465,2562.79,2420.32,0.49158,8.3715],
        [35.0,308.15,0.0562862,0.00100604,25.2078,146.645,2564.58,2417.94,0.50517,8.3518],
        [36.0,309.15,0.0594747,0.00100639,23.9318,150.824,2566.38,2415.56,0.51871,8.3323],
        [37.0,310.15,0.0628185,0.00100675,22.7292,155.004,2568.17,2413.17,0.5322,8.3129],
        [38.0,311.15,0.0663237,0.00100712,21.5954,159.183,2569.96,2410.78,0.54566,8.2936],
        [39.0,312.15,0.0699968,0.00100749,20.5261,163.362,2571.75,2408.39,0.55906,8.2746],
        [40.0,313.15,0.0738443,0.00100788,19.517,167.541,2573.54,2406.0,0.57243,8.2557],
        [41.0,314.15,0.0778731,0.00100827,18.5646,171.72,2575.33,2403.61,0.58575,8.2369],
        [42.0,315.15,0.0820901,0.00100867,17.6652,175.899,2577.11,2401.21,0.59903,8.2183],
        [43.0,316.15,0.0865026,0.00100908,16.8155,180.079,2578.89,2398.82,0.61227,8.1999],
        [44.0,317.15,0.091118,0.00100949,16.0126,184.258,2580.67,2396.42,0.62547,8.1816],
        [45.0,318.15,0.0959439,0.00100991,15.2534,188.437,2582.45,2394.02,0.63862,8.1634],
        [46.0,319.15,0.100988,0.00101034,14.5355,192.617,2584.23,2391.61,0.65174,8.1454],
        [47.0,320.15,0.106259,0.00101078,13.8562,196.796,2586.0,2389.21,0.66481,8.1276],
        [48.0,321.15,0.111764,0.00101123,13.2132,200.976,2587.77,2386.8,0.67785,8.1099],
        [49.0,322.15,0.117512,0.00101168,12.6045,205.156,2589.54,2384.39,0.69084,8.0923],
        [50.0,323.15,0.123513,0.00101214,12.0279,209.336,2591.31,2381.97,0.70379,8.0749],
        [51.0,324.15,0.129774,0.0010126,11.4815,213.517,2593.08,2379.56,0.71671,8.0576],
        [52.0,325.15,0.136305,0.00101308,10.9637,217.697,2594.84,2377.14,0.72958,8.0405],
        [53.0,326.15,0.143116,0.00101356,10.4726,221.878,2596.6,2374.72,0.74242,8.0235],
        [54.0,327.15,0.150215,0.00101404,10.0069,226.059,2598.35,2372.3,0.75522,8.0066],
        [55.0,328.15,0.157614,0.00101454,9.56492,230.241,2600.11,2369.87,0.76798,7.9899],
        [56.0,329.15,0.165322,0.00101504,9.14543,234.423,2601.86,2367.44,0.7807,7.9733],
        [57.0,330.15,0.17335,0.00101555,8.74712,238.605,2603.61,2365.01,0.79339,7.9568],
        [58.0,331.15,0.181708,0.00101606,8.36879,242.788,2605.36,2362.57,0.80603,7.9405],
        [59.0,332.15,0.190407,0.00101658,8.00932,246.971,2607.1,2360.13,0.81864,7.9243],
        [60.0,333.15,0.199458,0.00101711,7.66766,251.154,2608.85,2357.69,0.83122,7.9082],
        [61.0,334.15,0.208873,0.00101765,7.34281,255.338,2610.58,2355.25,0.84375,7.8922],
        [62.0,335.15,0.218664,0.00101819,7.03384,259.523,2612.32,2352.8,0.85625,7.8764],
        [63.0,336.15,0.228842,0.00101874,6.7399,263.708,2614.05,2350.35,0.86872,7.8607],
        [64.0,337.15,0.239421,0.00101929,6.46015,267.893,2615.78,2347.89,0.88115,7.8451],
        [65.0,338.15,0.250411,0.00101985,6.19383,272.079,2617.51,2345.43,0.89354,7.8296],
        [66.0,339.15,0.261827,0.00102042,5.94021,276.266,2619.23,2342.97,0.9059,7.8142],
        [67.0,340.15,0.27368,0.001021,5.69861,280.453,2620.96,2340.5,0.91823,7.799],
        [68.0,341.15,0.285986,0.00102158,5.4684,284.641,2622.67,2338.03,0.93052,7.7839],
        [69.0,342.15,0.298756,0.00102216,5.24896,288.829,2624.39,2335.56,0.94277,7.7689],
        [70.0,343.15,0.312006,0.00102276,5.03973,293.018,2626.1,2333.08,0.95499,7.754],
        [71.0,344.15,0.32575,0.00102336,4.84018,297.208,2627.81,2330.6,0.96718,7.7392],
        [72.0,345.15,0.340001,0.00102396,4.6498,301.398,2629.51,2328.11,0.97933,7.7245],
        [73.0,346.15,0.354775,0.00102458,4.46812,305.589,2631.21,2325.62,0.99146,7.71],
        [74.0,347.15,0.370088,0.0010252,4.29469,309.781,2632.91,2323.13,1.0035,7.6955],
        [75.0,348.15,0.385954,0.00102582,4.12908,313.974,2634.6,2320.63,1.0156,7.6812],
        [76.0,349.15,0.402389,0.00102645,3.9709,318.167,2636.29,2318.13,1.0276,7.6669],
        [77.0,350.15,0.419409,0.00102709,3.81978,322.361,2637.98,2315.62,1.0396,7.6528],
        [78.0,351.15,0.437031,0.00102773,3.67535,326.556,2639.66,2313.11,1.0516,7.6388],
        [79.0,352.15,0.455271,0.00102838,3.53729,330.752,2641.34,2310.59,1.0635,7.6248],
        [80.0,353.15,0.474147,0.00102904,3.40527,334.949,2643.01,2308.07,1.0754,7.611],
        [81.0,354.15,0.493676,0.0010297,3.27899,339.146,2644.68,2305.54,1.0873,7.5973],
        [82.0,355.15,0.513875,0.00103037,3.15818,343.345,2646.35,2303.01,1.0991,7.5837],
        [83.0,356.15,0.534762,0.00103105,3.04257,347.544,2648.01,2300.47,1.1109,7.5701],
        [84.0,357.15,0.556355,0.00103173,2.9319,351.745,2649.67,2297.93,1.1227,7.5567],
        [85.0,358.15,0.578675,0.00103242,2.82593,355.946,2651.33,2295.38,1.1344,7.5434],
        [86.0,359.15,0.601738,0.00103311,2.72445,360.148,2652.98,2292.83,1.1461,7.5301],
        [87.0,360.15,0.625565,0.00103381,2.62722,364.352,2654.62,2290.27,1.1578,7.517],
        [88.0,361.15,0.650174,0.00103451,2.53406,368.556,2656.26,2287.7,1.1694,7.5039],
        [89.0,362.15,0.675587,0.00103522,2.44476,372.762,2657.9,2285.14,1.1811,7.4909],
        [90.0,363.15,0.701824,0.00103594,2.35915,376.968,2659.53,2282.56,1.1927,7.4781],
        [91.0,364.15,0.728904,0.00103667,2.27705,381.176,2661.16,2279.98,1.2042,7.4653],
        [92.0,365.15,0.756849,0.0010374,2.1983,385.385,2662.78,2277.39,1.2158,7.4526],
        [93.0,366.15,0.785681,0.00103813,2.12275,389.595,2664.39,2274.8,1.2273,7.44],
        [94.0,367.15,0.81542,0.00103887,2.05025,393.806,2666.01,2272.2,1.2387,7.4275],
        [95.0,368.15,0.846089,0.00103962,1.98065,398.019,2667.61,2269.6,1.2502,7.415],
        [96.0,369.15,0.877711,0.00104038,1.91383,402.232,2669.22,2266.98,1.2616,7.4027],
        [97.0,370.15,0.910308,0.00104114,1.84965,406.447,2670.81,2264.37,1.273,7.3904],
        [98.0,371.15,0.943902,0.0010419,1.78801,410.663,2672.4,2261.74,1.2844,7.3782],
        [99.0,372.15,0.978518,0.00104268,1.72878,414.88,2673.99,2259.11,1.2957,7.3661],
        [100.0,373.15,1.01418,0.00104346,1.67186,419.099,2675.57,2256.47,1.307,7.3541],
        [102.0,375.15,1.08873,0.00104503,1.56454,427.541,2678.72,2251.18,1.3296,7.3303],
        [104.0,377.15,1.16776,0.00104663,1.46529,435.988,2681.84,2245.85,1.352,7.3068],
        [106.0,379.15,1.25147,0.00104826,1.37342,444.44,2684.94,2240.5,1.3743,7.2836],
        [108.0,381.15,1.34007,0.00104991,1.28831,452.899,2688.02,2235.12,1.3965,7.2607],
        [110.0,383.15,1.43376,0.00105158,1.20939,461.363,2691.07,2229.7,1.4187,7.238],
        [112.0,385.15,1.53277,0.00105328,1.13615,469.834,2694.09,2224.26,1.4407,7.2157],
        [114.0,387.15,1.63734,0.001055,1.06813,478.312,2697.09,2218.78,1.4626,7.1937],
        [116.0,389.15,1.74768,0.00105675,1.00489,486.796,2700.07,2213.27,1.4844,7.1719],
        [118.0,391.15,1.86404,0.00105853,0.94607,495.287,2703.02,2207.73,1.5062,7.1504],
        [120.0,393.15,1.98665,0.00106033,0.891304,503.785,2705.93,2202.15,1.5278,7.1291],
        [122.0,395.15,2.11578,0.00106215,0.840276,512.29,2708.82,2196.53,1.5494,7.1081],
        [124.0,397.15,2.25168,0.001064,0.792695,520.803,2711.69,2190.88,1.5708,7.0873],
        [126.0,399.15,2.3946,0.00106588,0.748294,529.323,2714.52,2185.19,1.5922,7.0668],
        [128.0,401.15,2.54481,0.00106778,0.706832,537.851,2717.32,2179.47,1.6134,7.0465],
        [130.0,403.15,2.7026,0.00106971,0.668084,546.388,2720.09,2173.7,1.6346,7.0264],
        [132.0,405.15,2.86823,0.00107167,0.631849,554.933,2722.83,2167.89,1.6557,7.0066],
        [134.0,407.15,3.04199,0.00107365,0.597939,563.486,2725.53,2162.04,1.6767,6.9869],
        [136.0,409.15,3.22417,0.00107566,0.566183,572.048,2728.2,2156.15,1.6977,6.9675],
        [138.0,411.15,3.41508,0.0010777,0.536425,580.62,2730.84,2150.22,1.7185,6.9483],
        [140.0,413.15,3.61501,0.00107976,0.508519,589.2,2733.44,2144.24,1.7393,6.9293],
        [142.0,415.15,3.82427,0.00108185,0.482334,597.79,2736.01,2138.22,1.76,6.9105],
        [144.0,417.15,4.04318,0.00108397,0.457748,606.39,2738.54,2132.15,1.7806,6.8918],
        [146.0,419.15,4.27205,0.00108612,0.434648,615.0,2741.04,2126.04,1.8011,6.8734],
        [148.0,421.15,4.51122,0.0010883,0.412931,623.621,2743.5,2119.88,1.8216,6.8551],
        [150.0,423.15,4.76101,0.0010905,0.392502,632.252,2745.92,2113.67,1.842,6.837],
        [152.0,425.15,5.02177,0.00109274,0.373273,640.893,2748.3,2107.41,1.8623,6.8191],
        [154.0,427.15,5.29383,0.00109501,0.355162,649.546,2750.64,2101.1,1.8825,6.8014],
        [156.0,429.15,5.57755,0.0010973,0.338095,658.211,2752.95,2094.74,1.9027,6.7838],
        [158.0,431.15,5.87329,0.00109963,0.322002,666.887,2755.21,2088.32,1.9228,6.7664],
        [160.0,433.15,6.18139,0.00110199,0.306818,675.575,2757.43,2081.86,1.9428,6.7491],
        [162.0,435.15,6.50224,0.00110438,0.292486,684.275,2759.61,2075.33,1.9627,6.732],
        [164.0,437.15,6.83619,0.0011068,0.278948,692.988,2761.75,2068.76,1.9826,6.715],
        [166.0,439.15,7.18364,0.00110925,0.266155,701.714,2763.84,2062.13,2.0025,6.6982],
        [168.0,441.15,7.54495,0.00111174,0.254059,710.453,2765.89,2055.44,2.0222,6.6815],
        [170.0,443.15,7.92053,0.00111426,0.242616,719.206,2767.89,2048.69,2.0419,6.6649],
        [172.0,445.15,8.31077,0.00111682,0.231785,727.973,2769.85,2041.88,2.0616,6.6485],
        [174.0,447.15,8.71606,0.00111941,0.221528,736.755,2771.77,2035.01,2.0811,6.6322],
        [176.0,449.15,9.13681,0.00112203,0.21181,745.551,2773.63,2028.08,2.1007,6.6161],
        [178.0,451.15,9.57343,0.00112469,0.202598,754.362,2775.45,2021.09,2.1201,6.6],
        [180.0,453.15,10.0263,0.00112739,0.193862,763.188,2777.22,2014.03,2.1395,6.5841],
        [182.0,455.15,10.496,0.00113012,0.185572,772.03,2778.94,2006.91,2.1589,6.5682],
        [184.0,457.15,10.9827,0.00113289,0.177703,780.889,2780.61,1999.72,2.1782,6.5525],
        [186.0,459.15,11.4871,0.0011357,0.170229,789.764,2782.23,1992.47,2.1974,6.5369],
        [188.0,461.15,12.0094,0.00113855,0.163127,798.656,2783.8,1985.14,2.2166,6.5214],
        [190.0,463.15,12.5502,0.00114144,0.156377,807.566,2785.31,1977.74,2.2358,6.506],
        [192.0,465.15,13.1099,0.00114437,0.149957,816.494,2786.77,1970.28,2.2549,6.4907],
        [194.0,467.15,13.6889,0.00114734,0.143848,825.44,2788.18,1962.74,2.2739,6.4755],
        [196.0,469.15,14.2877,0.00115036,0.138034,834.405,2789.53,1955.12,2.2929,6.4603],
        [198.0,471.15,14.9069,0.00115341,0.132497,843.389,2790.82,1947.44,2.3119,6.4453],
        [200.0,473.15,15.5467,0.00115651,0.127222,852.393,2792.06,1939.67,2.3308,6.4303],
        [202.0,475.15,16.2078,0.00115966,0.122195,861.417,2793.24,1931.82,2.3497,6.4154],
        [204.0,477.15,16.8906,0.00116285,0.117402,870.463,2794.36,1923.9,2.3685,6.4006],
        [206.0,479.15,17.5955,0.00116609,0.11283,879.529,2795.42,1915.89,2.3873,6.3858],
        [208.0,481.15,18.3231,0.00116937,0.108467,888.618,2796.42,1907.8,2.406,6.3711],
        [210.0,483.15,19.0739,0.00117271,0.104302,897.729,2797.35,1899.62,2.4248,6.3565],
        [212.0,485.15,19.8483,0.00117609,0.100325,906.863,2798.22,1891.36,2.4434,6.342],
        [214.0,487.15,20.647,0.00117953,0.0965249,916.021,2799.03,1883.01,2.4621,6.3275],
        [216.0,489.15,21.4702,0.00118302,0.0928934,925.203,2799.77,1874.57,2.4807,6.313],
        [218.0,491.15,22.3187,0.00118656,0.0894214,934.409,2800.45,1866.04,2.4993,6.2986],
        [220.0,493.15,23.1929,0.00119016,0.0861007,943.642,2801.05,1857.41,2.5178,6.2842],
        [222.0,495.15,24.0933,0.00119381,0.0829236,952.9,2801.59,1848.69,2.5363,6.2699],
        [224.0,497.15,25.0205,0.00119752,0.0798826,962.185,2802.05,1839.87,2.5548,6.2557],
        [226.0,499.15,25.9749,0.00120129,0.076971,971.498,2802.45,1830.95,2.5733,6.2414],
        [228.0,501.15,26.9572,0.00120512,0.0741823,980.839,2802.76,1821.93,2.5917,6.2272],
        [230.0,503.15,27.9679,0.00120901,0.0715102,990.21,2803.01,1812.8,2.6102,6.2131],
        [232.0,505.15,29.0075,0.00121297,0.0689492,999.609,2803.18,1803.57,2.6285,6.1989],
        [234.0,507.15,30.0767,0.00121699,0.0664936,1009.04,2803.27,1794.23,2.6469,6.1848],
        [236.0,509.15,31.1758,0.00122108,0.0641385,1018.5,2803.28,1784.78,2.6653,6.1707],
        [238.0,511.15,32.3056,0.00122523,0.0618788,1028.0,2803.21,1775.22,2.6836,6.1566],
        [240.0,513.15,33.4665,0.00122946,0.0597101,1037.52,2803.06,1765.54,2.7019,6.1425],
        [242.0,515.15,34.6592,0.00123376,0.057628,1047.08,2802.82,1755.74,2.7203,6.1285],
        [244.0,517.15,35.8843,0.00123814,0.0556284,1056.68,2802.5,1745.82,2.7385,6.1144],
        [246.0,519.15,37.1423,0.00124259,0.0537073,1066.31,2802.1,1735.78,2.7568,6.1003],
        [248.0,521.15,38.4338,0.00124712,0.0518612,1075.98,2801.6,1725.62,2.7751,6.0863],
        [250.0,523.15,39.7594,0.00125174,0.0500866,1085.69,2801.01,1715.33,2.7934,6.0722],
        [252.0,525.15,41.1197,0.00125644,0.0483801,1095.43,2800.33,1704.9,2.8117,6.0582],
        [254.0,527.15,42.5154,0.00126122,0.0467386,1105.22,2799.56,1694.34,2.8299,6.0441],
        [256.0,529.15,43.9471,0.0012661,0.0451592,1115.04,2798.69,1683.64,2.8482,6.03],
        [258.0,531.15,45.4153,0.00127107,0.043639,1124.91,2797.71,1672.8,2.8664,6.0158],
        [260.0,533.15,46.9207,0.00127613,0.0421755,1134.83,2796.64,1661.82,2.8847,6.0017],
        [262.0,535.15,48.464,0.00128129,0.040766,1144.78,2795.47,1650.68,2.903,5.9875],
        [264.0,537.15,50.0457,0.00128656,0.0394082,1154.79,2794.19,1639.4,2.9213,5.9733],
        [266.0,539.15,51.6666,0.00129193,0.0380997,1164.84,2792.8,1627.96,2.9396,5.959],
        [268.0,541.15,53.3273,0.00129741,0.0368385,1174.94,2791.3,1616.36,2.9579,5.9448],
        [270.0,543.15,55.0284,0.00130301,0.0356224,1185.09,2789.69,1604.6,2.9762,5.9304],
        [272.0,545.15,56.7706,0.00130872,0.0344496,1195.3,2787.96,1592.66,2.9945,5.916],
        [274.0,547.15,58.5547,0.00131455,0.033318,1205.55,2786.11,1580.56,3.0129,5.9016],
        [276.0,549.15,60.3812,0.00132052,0.032226,1215.87,2784.14,1568.28,3.0312,5.8871],
        [278.0,551.15,62.251,0.00132661,0.0311719,1226.24,2782.05,1555.81,3.0496,5.8725],
        [280.0,553.15,64.1646,0.00133285,0.030154,1236.67,2779.82,1543.15,3.0681,5.8578],
        [282.0,555.15,66.1228,0.00133922,0.0291708,1247.16,2777.47,1530.3,3.0865,5.8431],
        [284.0,557.15,68.1264,0.00134575,0.0282208,1257.72,2774.97,1517.25,3.105,5.8283],
        [286.0,559.15,70.176,0.00135243,0.0273027,1268.34,2772.34,1504.0,3.1236,5.8134],
        [288.0,561.15,72.2724,0.00135928,0.0264152,1279.03,2769.56,1490.53,3.1421,5.7984],
        [290.0,563.15,74.4164,0.00136629,0.0255568,1289.8,2766.63,1476.84,3.1608,5.7832],
        [292.0,565.15,76.6087,0.00137349,0.0247265,1300.63,2763.55,1462.92,3.1794,5.768],
        [294.0,567.15,78.8502,0.00138087,0.0239231,1311.54,2760.31,1448.76,3.1982,5.7526],
        [296.0,569.15,81.1415,0.00138844,0.0231454,1322.54,2756.9,1434.37,3.217,5.7372],
        [298.0,571.15,83.4835,0.00139622,0.0223924,1333.61,2753.33,1419.72,3.2358,5.7215],
        [300.0,573.15,85.8771,0.00140422,0.0216631,1344.77,2749.57,1404.8,3.2547,5.7058],
        [305.0,578.15,92.0919,0.00142524,0.019937,1373.07,2739.38,1366.3,3.3024,5.6656],
        [310.0,583.15,98.6475,0.00144788,0.0183389,1402.0,2727.92,1325.92,3.3506,5.6243],
        [315.0,588.15,105.558,0.00147239,0.0168557,1431.63,2715.08,1283.45,3.3994,5.5816],
        [320.0,593.15,112.839,0.00149906,0.0154759,1462.05,2700.67,1238.62,3.4491,5.5373],
        [325.0,598.15,120.505,0.0015283,0.0141887,1493.37,2684.48,1191.11,3.4997,5.4911],
        [330.0,603.15,128.575,0.0015606,0.012984,1525.74,2666.25,1140.51,3.5516,5.4425],
        [335.0,608.15,137.067,0.00159667,0.0118522,1559.34,2645.6,1086.26,3.6048,5.391],
        [340.0,613.15,146.002,0.00163751,0.0107838,1594.45,2622.07,1027.62,3.6599,5.3359],
        [345.0,618.15,155.401,0.0016846,0.0097698,1631.44,2595.01,963.57,3.7175,5.2763],
        [350.0,623.15,165.292,0.00174007,0.0088009,1670.86,2563.59,892.73,3.7783,5.2109],
        [355.0,628.15,175.701,0.0018078,0.007866,1713.71,2526.45,812.74,3.8438,5.1377],
        [360.0,633.15,186.664,0.00189451,0.0069449,1761.49,2480.99,719.5,3.9164,5.0527],
        [365.0,638.15,198.222,0.00201561,0.0060044,1817.59,2422.0,604.41,4.0011,4.9482],
        [370.0,643.15,210.434,0.00222209,0.0049462,1892.64,2333.5,440.86,4.1142,4.7996],
        [371.0,644.15,212.964,0.0022902,0.0046914,1913.25,2307.45,394.2,4.1453,4.7573],
        [372.0,645.15,215.528,0.0023817,0.0043985,1938.54,2274.69,336.15,4.1836,4.7046],
        [373.0,646.15,218.132,0.00252643,0.0040212,1974.14,2227.55,253.42,4.2377,4.6299],
        [373.946,647.096,220.64,0.00310559,0.00310559,2087.55,2087.55,0.0,4.412,4.412],
        ];

        for dataset in steam_table {
            let t_deg_c = dataset[0];
            let t_kelvin = dataset[1];
            let psat_bar = dataset[2];
            let v_liq_m3_per_kg = dataset[3];
            let v_vap_m3_per_kg = dataset[4];
            let h_liq_kj_per_kg = dataset[5];
            let h_vap_kj_per_kg = dataset[6];
            let enthalpy_of_vap_kj_per_kg = dataset[7];
            let s_liq_kj_per_kg_k = dataset[8];
            let s_vap_kj_per_kg_k = dataset[9];
            assert_region_sat_point(t_deg_c, t_kelvin, psat_bar, 
                v_liq_m3_per_kg, v_vap_m3_per_kg, h_liq_kj_per_kg, 
                h_vap_kj_per_kg, enthalpy_of_vap_kj_per_kg, 
                s_liq_kj_per_kg_k, s_vap_kj_per_kg_k);
        }


}

fn assert_region_sat_point(t_deg_c: f64, t_kelvin: f64, psat_bar: f64, 
    _v_liq_m3_per_kg: f64, _v_vap_m3_per_kg: f64, 
    _h_liq_kj_per_kg: f64, _h_vap_kj_per_kg: f64, 
    _enthalpy_of_vap_kj_per_kg: f64, 
    _s_liq_kj_per_kg_k: f64, _s_vap_kj_per_kg_k: f64) {

    dbg!(&t_deg_c);
    // for the saturated steam table, I have three scenarios,
    // one is 0.5 quality 
    // one is 0.0 quality (bubble pt)
    // one is 1.0 quality 
    //
    // for coding I also want to consider negative quality 
    // so that robustness is considered
    let t = ThermodynamicTemperature::new::<kelvin>(t_kelvin);
    let p = Pressure::new::<bar>(psat_bar);

    let x1 = 0.0;
    let x2 = 0.5;
    let x3 = 1.0;
    // negative quality (nonphysical)
    // it will be adjusted to 0.0 in code
    let x4 = -0.1;
    // quality greater than 1 (nonphysical)
    // it will be adjusted to 1.0 in code
    let x5 = 1.2;


    let test_reg_sat_water_1 = region_fwd_eqn_two_phase(
        t, p, x1);
    let test_reg_vle_2 = region_fwd_eqn_two_phase(
        t, p, x2);
    let test_reg_sat_steam_3 = region_fwd_eqn_two_phase(
        t, p, x3);
    let test_reg_sat_water_4 = region_fwd_eqn_two_phase(
        t, p, x4);
    let test_reg_sat_steam_5 = region_fwd_eqn_two_phase(
        t, p, x5);

    // now what shall be the regions along this saturated line? 
    // at or below 623.15 K, then region 1 or 2
    // depending on quality
    let reference_region_sat_water: FwdEqnRegion;
    let reference_region_sat_steam: FwdEqnRegion;
    // vap liq eqm
    let mut reference_region_vle: FwdEqnRegion = FwdEqnRegion::Region4;

    // below 623.15 

    if t_kelvin <= 623.15 {
        reference_region_sat_steam = FwdEqnRegion::Region2;
        reference_region_sat_water = FwdEqnRegion::Region1;
        dbg!(&test_reg_sat_water_1);

        assert_eq!(reference_region_sat_water,
            test_reg_sat_water_1);
        assert_eq!(reference_region_vle,
            test_reg_vle_2);
        assert_eq!(reference_region_sat_steam,
            test_reg_sat_steam_3);
        assert_eq!(reference_region_sat_water,
            test_reg_sat_water_4);
        assert_eq!(reference_region_sat_steam,
            test_reg_sat_steam_5);
    } else if t_kelvin < 647.096 {
        // from 623.15 to just before crit pt
        reference_region_sat_steam = FwdEqnRegion::Region3;
        reference_region_sat_water = FwdEqnRegion::Region3;

        assert_eq!(reference_region_sat_water,
            test_reg_sat_water_1);
        assert_eq!(reference_region_vle,
            test_reg_vle_2);
        assert_eq!(reference_region_sat_steam,
            test_reg_sat_steam_3);
        assert_eq!(reference_region_sat_water,
            test_reg_sat_water_4);
        assert_eq!(reference_region_sat_steam,
            test_reg_sat_steam_5);
    } else {
        // at crit point, we must have all of them be region 3
        reference_region_vle = FwdEqnRegion::Region3;
        reference_region_sat_steam = FwdEqnRegion::Region3;
        reference_region_sat_water = FwdEqnRegion::Region3;


        assert_eq!(reference_region_sat_water,
            test_reg_sat_water_1);
        assert_eq!(reference_region_vle,
            test_reg_vle_2);
        assert_eq!(reference_region_sat_steam,
            test_reg_sat_steam_3);
        assert_eq!(reference_region_sat_water,
            test_reg_sat_water_4);
        assert_eq!(reference_region_sat_steam,
            test_reg_sat_steam_5);
    };


}

pub mod region_1_2_3_5_test;
