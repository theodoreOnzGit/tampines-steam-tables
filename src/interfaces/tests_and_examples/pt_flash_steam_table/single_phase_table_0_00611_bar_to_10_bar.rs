use uom::si::dynamic_viscosity::micropascal_second;
use uom::si::thermal_conductivity::milliwatt_per_meter_kelvin;
use uom::si::{available_energy::kilojoule_per_kilogram, temperature_interval};
use uom::si::pressure::bar;
use uom::si::f64::*;
use uom::si::ratio::ratio;
use uom::si::specific_heat_capacity::kilojoule_per_kilogram_kelvin;
use uom::si::specific_volume::cubic_meter_per_kilogram;
use uom::si::thermodynamic_temperature::degree_celsius;
use uom::si::velocity::meter_per_second;

use crate::dynamic_viscosity::mu_tp_eqm_two_phase;
use crate::thermal_conductivity::lambda_tp_eqm_two_phase;
use crate::{interfaces::functional_programming::{ph_flash_eqm::x_ph_flash, pt_flash_eqm::{cp_tp_eqm_two_phase, h_tp_eqm_two_phase, kappa_tp_eqm_two_phase, s_tp_eqm_two_phase, v_tp_eqm_two_phase, w_tp_eqm_two_phase}}, region_4_vap_liq_equilibrium::sat_temp_4};

/// single phase table (see page 192)
///
/// NOTE: ph flash UNABLE to do triple point liquid and vapour accurately.
#[test]
pub fn single_phase_table_0_to_240_degc_except_triple_pt_0_00611_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[0.006112127,0.0,0.00100021,-0.04159,-0.0001545,4.2199,1402.3,3216538.0,1792.0,555.57],
        //[0.006112127,0.0,206.14,2500.89,9.1558,1.8882,408.88,1.3269,8.9455,16.76],
        [0.006112127,2.0,207.657,2504.66,9.1695,1.8822,410.5,1.3277,9.0033,16.889],
        [0.006112127,4.0,209.173,2508.42,9.1831,1.878,412.08,1.3282,9.0617,17.019],
        [0.006112127,6.0,210.688,2512.18,9.1966,1.875,413.63,1.3286,9.1207,17.15],
        [0.006112127,8.0,212.203,2515.92,9.21,1.873,415.15,1.3288,9.1803,17.282],
        [0.006112127,10.0,213.717,2519.67,9.2233,1.8716,416.65,1.3289,9.2404,17.414],
        [0.006112127,12.0,215.231,2523.41,9.2364,1.8706,418.13,1.329,9.3011,17.548],
        [0.006112127,14.0,216.744,2527.15,9.2495,1.87,419.6,1.329,9.3622,17.682],
        [0.006112127,16.0,218.258,2530.89,9.2625,1.8696,421.06,1.329,9.4239,17.817],
        [0.006112127,18.0,219.771,2534.63,9.2754,1.8694,422.51,1.329,9.4861,17.953],
        [0.006112127,20.0,221.284,2538.37,9.2882,1.8693,423.95,1.3289,9.5488,18.089],
        [0.006112127,25.0,225.065,2547.71,9.3198,1.8695,427.53,1.3287,9.7075,18.434],
        [0.006112127,30.0,228.846,2557.06,9.3509,1.8701,431.07,1.3285,9.8689,18.784],
        [0.006112127,35.0,232.626,2566.42,9.3815,1.8708,434.57,1.3282,10.033,19.138],
        [0.006112127,40.0,236.406,2575.77,9.4116,1.8718,438.03,1.3279,10.199,19.498],
        [0.006112127,45.0,240.185,2585.13,9.4413,1.8728,441.47,1.3276,10.368,19.862],
        [0.006112127,50.0,243.964,2594.5,9.4705,1.874,444.87,1.3272,10.538,20.231],
        [0.006112127,55.0,247.743,2603.87,9.4993,1.8753,448.25,1.3269,10.711,20.604],
        [0.006112127,60.0,251.521,2613.25,9.5276,1.8767,451.59,1.3265,10.885,20.982],
        [0.006112127,65.0,255.299,2622.64,9.5556,1.8781,454.9,1.3262,11.061,21.364],
        [0.006112127,70.0,259.077,2632.03,9.5832,1.8797,458.19,1.3258,11.239,21.751],
        [0.006112127,75.0,262.855,2641.44,9.6104,1.8813,461.44,1.3254,11.419,22.142],
        [0.006112127,80.0,266.632,2650.85,9.6372,1.8831,464.67,1.3249,11.599,22.537],
        [0.006112127,85.0,270.409,2660.27,9.6637,1.8849,467.88,1.3245,11.782,22.936],
        [0.006112127,90.0,274.186,2669.7,9.6898,1.8867,471.05,1.324,11.965,23.339],
        [0.006112127,95.0,277.963,2679.14,9.7157,1.8887,474.2,1.3236,12.15,23.747],
        [0.006112127,100.0,281.74,2688.58,9.7411,1.8907,477.33,1.3231,12.336,24.158],
        [0.006112127,110.0,289.294,2707.51,9.7912,1.8949,483.51,1.3221,12.712,24.993],
        [0.006112127,120.0,296.847,2726.48,9.8401,1.8993,489.59,1.3211,13.092,25.843],
        [0.006112127,130.0,304.399,2745.5,9.8878,1.9039,495.58,1.3201,13.475,26.708],
        [0.006112127,140.0,311.952,2764.56,9.9346,1.9087,501.49,1.319,13.862,27.587],
        [0.006112127,150.0,319.504,2783.67,9.9803,1.9137,507.31,1.3179,14.252,28.481],
        [0.006112127,160.0,327.056,2802.84,10.025,1.9188,513.05,1.3168,14.645,29.388],
        [0.006112127,170.0,334.608,2822.05,10.069,1.924,518.72,1.3156,15.04,30.309],
        [0.006112127,180.0,342.16,2841.32,10.112,1.9294,524.31,1.3145,15.438,31.242],
        [0.006112127,190.0,349.712,2860.64,10.154,1.9348,529.83,1.3133,15.838,32.189],
        [0.006112127,200.0,357.264,2880.01,10.195,1.9404,535.28,1.3121,16.24,33.148],
        [0.006112127,210.0,364.816,2899.45,10.236,1.946,540.66,1.3109,16.643,34.119],
        [0.006112127,220.0,372.367,2918.93,10.276,1.9517,545.98,1.3097,17.048,35.102],
        [0.006112127,230.0,379.919,2938.48,10.315,1.9575,551.23,1.3085,17.454,36.096],
        [0.006112127,240.0,387.47,2958.08,10.354,1.9633,556.43,1.3073,17.862,37.102],
        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }

}
#[test]
pub fn single_phase_table_250_to_800_degc_0_00611_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        [0.006112127,250.0,395.022,2977.75,10.392,1.9692,561.56,1.3061,18.27,38.119],
        [0.006112127,260.0,402.573,2997.47,10.429,1.9752,566.64,1.3049,18.68,39.147],
        [0.006112127,270.0,410.125,3017.25,10.466,1.9812,571.67,1.3037,19.09,40.185],
        [0.006112127,280.0,417.676,3037.09,10.502,1.9873,576.64,1.3025,19.501,41.234],
        [0.006112127,290.0,425.227,3057.0,10.538,1.9934,581.56,1.3013,19.913,42.292],
        [0.006112127,300.0,432.779,3076.96,10.573,1.9996,586.43,1.3001,20.325,43.361],
        [0.006112127,310.0,440.33,3096.99,10.608,2.0058,591.25,1.2989,20.737,44.439],
        [0.006112127,320.0,447.881,3117.08,10.642,2.012,596.02,1.2977,21.15,45.527],
        [0.006112127,330.0,455.432,3137.23,10.675,2.0183,600.74,1.2965,21.563,46.623],
        [0.006112127,340.0,462.984,3157.44,10.709,2.0247,605.42,1.2953,21.977,47.729],
        [0.006112127,350.0,470.535,3177.72,10.741,2.031,610.06,1.2941,22.39,48.844],
        [0.006112127,360.0,478.086,3198.07,10.774,2.0374,614.65,1.2929,22.803,49.967],
        [0.006112127,370.0,485.637,3218.47,10.806,2.0439,619.2,1.2917,23.217,51.099],
        [0.006112127,380.0,493.188,3238.94,10.837,2.0504,623.7,1.2905,23.63,52.239],
        [0.006112127,390.0,500.74,3259.48,10.869,2.0569,628.17,1.2893,24.043,53.388],
        [0.006112127,400.0,508.291,3280.08,10.899,2.0635,632.6,1.2881,24.456,54.544],
        [0.006112127,410.0,515.842,3300.75,10.93,2.0701,636.99,1.2869,24.868,55.708],
        [0.006112127,420.0,523.393,3321.48,10.96,2.0767,641.34,1.2858,25.281,56.88],
        [0.006112127,430.0,530.944,3342.28,10.99,2.0834,645.65,1.2846,25.692,58.059],
        [0.006112127,440.0,538.495,3363.15,11.019,2.0901,649.93,1.2834,26.104,59.245],
        [0.006112127,450.0,546.046,3384.08,11.048,2.0968,654.18,1.2822,26.515,60.438],
        [0.006112127,460.0,553.598,3405.09,11.077,2.1036,658.39,1.2811,26.925,61.639],
        [0.006112127,470.0,561.149,3426.16,11.106,2.1103,662.56,1.2799,27.335,62.846],
        [0.006112127,480.0,568.7,3447.29,11.134,2.1172,666.7,1.2788,27.745,64.06],
        [0.006112127,490.0,576.251,3468.5,11.162,2.124,670.81,1.2776,28.154,65.281],
        [0.006112127,500.0,583.802,3489.77,11.19,2.1309,674.89,1.2765,28.562,66.508],
        [0.006112127,510.0,591.353,3511.12,11.217,2.1378,678.94,1.2753,28.969,67.741],
        [0.006112127,520.0,598.904,3532.53,11.244,2.1447,682.96,1.2742,29.376,68.981],
        [0.006112127,530.0,606.455,3554.01,11.271,2.1517,686.95,1.2731,29.783,70.226],
        [0.006112127,540.0,614.006,3575.56,11.298,2.1586,690.9,1.272,30.188,71.478],
        [0.006112127,550.0,621.557,3597.18,11.324,2.1656,694.83,1.2708,30.593,72.735],
        [0.006112127,560.0,629.108,3618.88,11.351,2.1726,698.74,1.2697,30.997,73.998],
        [0.006112127,570.0,636.66,3640.64,11.376,2.1796,702.61,1.2686,31.4,75.266],
        [0.006112127,580.0,644.211,3662.47,11.402,2.1867,706.46,1.2675,31.802,76.54],
        [0.006112127,590.0,651.762,3684.37,11.428,2.1937,710.29,1.2664,32.204,77.819],
        [0.006112127,600.0,659.313,3706.34,11.453,2.2008,714.08,1.2654,32.605,79.104],
        [0.006112127,650.0,697.068,3817.27,11.577,2.2362,732.71,1.2601,34.595,85.6],
        [0.006112127,700.0,734.823,3929.96,11.695,2.2716,750.77,1.255,36.564,92.212],
        [0.006112127,750.0,772.578,4044.43,11.81,2.307,768.31,1.2501,38.508,98.926],
        [0.006112127,800.0,810.333,4160.66,11.921,2.3423,785.38,1.2454,40.428,105.73],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }

}

/// single phase table (see page 192)
///
/// NOTE: ph flash UNABLE to do triple point liquid and vapour accurately.
/// or even close to 0 degc
#[test]
pub fn single_phase_table_0_to_240_degc_except_triple_pt_0_1_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[0.1,0.0,0.0010002,-0.03202,-0.0001539,4.2199,1402.3,196604.0,1792.0,555.58],
        [0.1,2.0,0.0010001,8.40098,0.030607,4.2133,1412.1,199379.0,1673.7,560.6],
        [0.1,4.0,0.00100007,16.8219,0.061101,4.2078,1421.5,202050.0,1567.4,565.4],
        [0.1,6.0,0.0010001,25.2326,0.091339,4.2031,1430.5,204616.0,1471.6,570.01],
        [0.1,8.0,0.00100019,33.6348,0.12133,4.1991,1439.2,207075.0,1384.8,574.45],
        [0.1,10.0,0.00100034,42.0296,0.15108,4.1958,1447.4,209428.0,1306.0,578.72],
        [0.1,12.0,0.00100054,50.4183,0.18061,4.1929,1455.3,211674.0,1234.1,582.83],
        [0.1,14.0,0.0010008,58.8017,0.2099,4.1905,1462.8,213814.0,1168.4,586.81],
        [0.1,16.0,0.0010011,67.1805,0.23898,4.1884,1470.0,215848.0,1108.1,590.65],
        [0.1,18.0,0.00100145,75.5555,0.26785,4.1866,1476.8,217779.0,1052.7,594.36],
        [0.1,20.0,0.00100184,83.9271,0.2965,4.1851,1483.3,219606.0,1001.6,597.96],
        [0.1,25.0,0.001003,104.845,0.36725,4.1822,1498.0,223737.0,890.04,606.46],
        [0.1,30.0,0.00100441,125.75,0.43679,4.1803,1510.8,227261.0,797.22,614.35],
        [0.1,35.0,0.00100604,146.649,0.50517,4.1792,1521.8,230209.0,719.12,621.66],
        [0.1,40.0,0.00100788,167.543,0.57243,4.1788,1531.2,232610.0,652.72,628.45],
        [0.1,45.0,0.00100991,188.438,0.63862,4.179,1538.9,234495.0,595.76,634.75],
        [0.1,45.8075,0.00101026,191.812,0.64922,4.1791,1540.0,234753.0,587.32,635.72],
        [0.1,45.8075,14.6706,2583.89,8.1489,1.9413,440.51,1.3227,10.377,19.942],
        [0.1,50.0,14.8674,2591.99,8.1741,1.9272,443.67,1.324,10.521,20.255],
        [0.1,55.0,15.1015,2601.6,8.2037,1.9178,447.26,1.3246,10.694,20.631],
        [0.1,60.0,15.3353,2611.18,8.2326,1.9124,450.74,1.3248,10.87,21.011],
        [0.1,65.0,15.5687,2620.73,8.2611,1.9091,454.14,1.3247,11.047,21.396],
        [0.1,70.0,15.8018,2630.27,8.2891,1.9071,457.5,1.3246,11.226,21.784],
        [0.1,75.0,16.0347,2639.8,8.3167,1.9058,460.81,1.3243,11.406,22.176],
        [0.1,80.0,16.2674,2649.33,8.3438,1.9051,464.09,1.324,11.587,22.572],
        [0.1,85.0,16.4999,2658.86,8.3706,1.9048,467.33,1.3236,11.77,22.972],
        [0.1,90.0,16.7323,2668.38,8.397,1.9048,470.55,1.3233,11.955,23.376],
        [0.1,95.0,16.9646,2677.9,8.4231,1.9051,473.73,1.3229,12.14,23.784],
        [0.1,100.0,17.1967,2687.43,8.4488,1.9057,476.89,1.3225,12.327,24.196],
        [0.1,110.0,17.6607,2706.5,8.4992,1.9074,483.12,1.3216,12.703,25.03],
        [0.1,120.0,18.1243,2725.58,8.5484,1.9098,489.25,1.3207,13.084,25.88],
        [0.1,130.0,18.5876,2744.69,8.5964,1.9128,495.28,1.3197,13.468,26.744],
        [0.1,140.0,19.0507,2763.84,8.6433,1.9163,501.22,1.3187,13.856,27.622],
        [0.1,150.0,19.5136,2783.02,8.6892,1.9201,507.07,1.3176,14.247,28.515],
        [0.1,160.0,19.9763,2802.24,8.734,1.9243,512.83,1.3166,14.64,29.42],
        [0.1,170.0,20.4389,2821.51,8.778,1.9288,518.52,1.3154,15.036,30.34],
        [0.1,180.0,20.9013,2840.82,8.8211,1.9336,524.13,1.3143,15.434,31.272],
        [0.1,190.0,21.3637,2860.18,8.8634,1.9385,529.66,1.3132,15.834,32.217],
        [0.1,200.0,21.826,2879.59,8.9048,1.9436,535.13,1.312,16.236,33.175],
        [0.1,210.0,22.2882,2899.05,8.9455,1.9489,540.52,1.3108,16.64,34.145],
        [0.1,220.0,22.7504,2918.57,8.9855,1.9543,545.85,1.3097,17.045,35.126],
        [0.1,230.0,23.2124,2938.14,9.0248,1.9598,551.12,1.3085,17.452,36.119],
        [0.1,240.0,23.6745,2957.76,9.0634,1.9654,556.32,1.3073,17.859,37.124],
        ];

        for dataset in steam_table {
            let p_bar = dataset[0] as f64;
            let t_deg_c = dataset[1] as f64;
            let v_m3_per_kg = dataset[2] as f64;
            let h_kj_per_kg = dataset[3] as f64;
            let s_kj_per_kg_k = dataset[4] as f64;
            let cp_kj_per_kg_k = dataset[5] as f64;
            let w_m_per_s = dataset[6] as f64;
            let kappa_dimensionless = dataset[7] as f64;
            let eta_micropascal_second = dataset[8] as f64;
            let lambda_milliwatt_per_meter_kelvin = dataset[9] as f64;
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }

}
#[test]
pub fn single_phase_table_250_to_800_degc_0_1_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![

        [0.1,250.0,24.1365,2977.45,9.1014,1.9711,561.46,1.3061,18.268,38.14],
        [0.1,260.0,24.5985,2997.19,9.1388,1.9769,566.55,1.3049,18.678,39.17],
        [0.1,270.0,25.0604,3016.98,9.1756,1.9827,571.58,1.3037,19.089,40.2],
        [0.1,280.0,25.5223,3036.84,9.2118,1.9887,576.56,1.3025,19.5,41.25],
        [0.1,290.0,25.9842,3056.76,9.2475,1.9947,581.48,1.3013,19.912,42.31],
        [0.1,300.0,26.446,3076.73,9.2827,2.0007,586.36,1.3001,20.324,43.38],
        [0.1,310.0,26.9078,3096.77,9.3173,2.0069,591.18,1.2989,20.736,44.45],
        [0.1,320.0,27.3696,3116.87,9.3515,2.013,595.96,1.2977,21.149,45.54],
        [0.1,330.0,27.8314,3137.03,9.3852,2.0192,600.68,1.2965,21.563,46.64],
        [0.1,340.0,28.2932,3157.26,9.4185,2.0255,605.37,1.2953,21.976,47.74],
        [0.1,350.0,28.755,3177.54,9.4513,2.0318,610.0,1.2941,22.389,48.86],
        [0.1,360.0,29.2167,3197.89,9.4837,2.0382,614.6,1.2929,22.803,49.98],
        [0.1,370.0,29.6785,3218.31,9.5157,2.0446,619.15,1.2917,23.216,51.11],
        [0.1,380.0,30.1402,3238.79,9.5473,2.051,623.66,1.2905,23.63,52.25],
        [0.1,390.0,30.6019,3259.33,9.5785,2.0575,628.13,1.2893,24.043,53.4],
        [0.1,400.0,31.0636,3279.94,9.6093,2.0641,632.56,1.2881,24.456,54.55],
        [0.1,410.0,31.5253,3300.61,9.6398,2.0706,636.95,1.2869,24.868,55.72],
        [0.1,420.0,31.987,3321.35,9.6699,2.0772,641.3,1.2857,25.28,56.89],
        [0.1,430.0,32.4486,3342.15,9.6997,2.0839,645.62,1.2846,25.692,58.07],
        [0.1,440.0,32.9103,3363.03,9.7292,2.0905,649.9,1.2834,26.104,59.25],
        [0.1,450.0,33.372,3383.96,9.7584,2.0972,654.15,1.2822,26.515,60.45],
        [0.1,460.0,33.8336,3404.97,9.7872,2.104,658.36,1.2811,26.925,61.65],
        [0.1,470.0,34.2953,3426.04,9.8158,2.1107,662.53,1.2799,27.335,62.85],
        [0.1,480.0,34.7569,3447.19,9.844,2.1175,666.68,1.2788,27.745,64.07],
        [0.1,490.0,35.2185,3468.4,9.872,2.1244,670.79,1.2776,28.154,65.29],
        [0.1,500.0,35.6802,3489.67,9.8997,2.1312,674.87,1.2765,28.562,66.52],
        [0.1,510.0,36.1418,3511.02,9.9271,2.1381,678.92,1.2753,28.97,67.75],
        [0.1,520.0,36.6034,3532.44,9.9543,2.145,682.94,1.2742,29.377,68.99],
        [0.1,530.0,37.065,3553.92,9.9812,2.152,686.92,1.2731,29.783,70.23],
        [0.1,540.0,37.5267,3575.48,10.008,2.1589,690.88,1.272,30.188,71.48],
        [0.1,550.0,37.9883,3597.1,10.034,2.1659,694.82,1.2708,30.593,72.74],
        [0.1,560.0,38.4499,3618.79,10.061,2.1729,698.72,1.2697,30.997,74.0],
        [0.1,570.0,38.9115,3640.56,10.086,2.1799,702.6,1.2686,31.4,75.27],
        [0.1,580.0,39.3731,3662.39,10.112,2.1869,706.45,1.2675,31.803,76.55],
        [0.1,590.0,39.8347,3684.3,10.138,2.194,710.27,1.2664,32.204,77.83],
        [0.1,600.0,40.2963,3706.27,10.163,2.201,714.07,1.2654,32.605,79.11],
        [0.1,650.0,42.6042,3817.2,10.287,2.2364,732.7,1.2601,34.596,85.61],
        [0.1,700.0,44.9121,3929.91,10.405,2.2718,750.76,1.255,36.564,92.22],
        [0.1,750.0,47.2199,4044.38,10.52,2.3071,768.31,1.2501,38.508,98.93],
        [0.1,800.0,49.5278,4160.62,10.631,2.3424,785.38,1.2454,40.429,105.74],


        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }

}

/// single phase table (see page 192)
///
/// NOTE: ph flash UNABLE to do triple point liquid and vapour accurately.
/// or even close to 0 degc
#[test]
pub fn single_phase_table_2_to_800_degc_except_triple_pt_1_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![

        //[1.0,0.0,0.00100016,0.05966,-0.0001478,4.2194,1402.4,19665.0,1791.8,555.65],
        [1.0,2.0,0.00100006,8.49179,0.03061,4.2129,1412.2,19943.0,1673.5,560.66],
        [1.0,4.0,0.00100003,16.9119,0.061101,4.2074,1421.6,20210.0,1567.3,565.47],
        [1.0,6.0,0.00100006,25.3219,0.091336,4.2027,1430.7,20467.0,1471.5,570.08],
        [1.0,8.0,0.00100015,33.7233,0.12133,4.1988,1439.3,20713.0,1384.7,574.51],
        [1.0,10.0,0.0010003,42.1174,0.15108,4.1955,1447.6,20948.0,1305.9,578.78],
        [1.0,12.0,0.0010005,50.5054,0.1806,4.1926,1455.4,21172.0,1234.0,582.89],
        [1.0,14.0,0.00100076,58.8881,0.20989,4.1902,1463.0,21386.0,1168.3,586.86],
        [1.0,16.0,0.00100106,67.2664,0.23897,4.1881,1470.1,21590.0,1108.1,590.7],
        [1.0,18.0,0.00100141,75.6407,0.26783,4.1863,1476.9,21783.0,1052.7,594.42],
        [1.0,20.0,0.0010018,84.0118,0.29648,4.1848,1483.4,21966.0,1001.6,598.01],
        [1.0,25.0,0.00100296,104.928,0.36723,4.1819,1498.2,22379.0,890.02,606.52],
        [1.0,30.0,0.00100437,125.833,0.43676,4.18,1511.0,22731.0,797.22,614.39],
        [1.0,35.0,0.001006,146.73,0.50513,4.179,1522.0,23026.0,719.13,621.71],
        [1.0,40.0,0.00100784,167.623,0.57239,4.1786,1531.3,23266.0,652.73,628.49],
        [1.0,45.0,0.00100987,188.516,0.63859,4.1788,1539.0,23455.0,595.77,634.8],
        [1.0,50.0,0.0010121,209.412,0.70375,4.1796,1545.3,23595.0,546.52,640.64],
        [1.0,55.0,0.0010145,230.313,0.76794,4.1809,1550.2,23689.0,503.63,646.04],
        [1.0,60.0,0.00101708,251.222,0.83117,4.1828,1553.9,23739.0,466.04,651.02],
        [1.0,65.0,0.00101982,272.141,0.8935,4.1852,1556.3,23749.0,432.91,655.59],
        [1.0,70.0,0.00102273,293.074,0.95495,4.1881,1557.6,23722.0,403.56,659.78],
        [1.0,75.0,0.00102579,314.023,1.0156,4.1915,1557.8,23658.0,377.42,663.58],
        [1.0,80.0,0.00102902,334.991,1.0754,4.1955,1557.1,23561.0,354.06,667.01],
        [1.0,85.0,0.00103239,355.979,1.1344,4.2,1555.4,23432.0,333.08,670.08],
        [1.0,90.0,0.00103593,376.992,1.1926,4.205,1552.8,23275.0,314.18,672.8],
        [1.0,95.0,0.00103962,398.03,1.2502,4.2106,1549.3,23090.0,297.09,675.17],
        [1.0,99.6,0.00104315,417.436,1.3026,4.2161,1545.5,22896.0,282.75,677.07],
        [1.0,99.6,1.69402,2674.95,7.3588,2.0759,472.05,1.3154,12.218,24.532],
        [1.0,100.0,1.69596,2675.77,7.361,2.0741,472.34,1.3155,12.234,24.564],
        [1.0,110.0,1.74482,2696.32,7.4154,2.0399,479.27,1.3165,12.62,25.397],
        [1.0,120.0,1.79324,2716.61,7.4676,2.0187,485.89,1.3166,13.009,26.24],
        [1.0,130.0,1.84132,2736.72,7.5181,2.0039,492.31,1.3163,13.401,27.096],
        [1.0,140.0,1.88913,2756.7,7.5671,1.9933,498.57,1.3158,13.796,27.963],
        [1.0,150.0,1.93673,2776.59,7.6147,1.9857,504.7,1.3152,14.192,28.843],
        [1.0,160.0,1.98414,2796.42,7.661,1.9805,510.7,1.3145,14.591,29.736],
        [1.0,170.0,2.0314,2816.21,7.7062,1.9772,516.59,1.3137,14.992,30.642],
        [1.0,180.0,2.07853,2835.97,7.7503,1.9755,522.38,1.3129,15.394,31.56],
        [1.0,190.0,2.12556,2855.72,7.7934,1.9751,528.07,1.3119,15.798,32.491],
        [1.0,200.0,2.17249,2875.48,7.8356,1.9757,533.67,1.311,16.204,33.436],
        [1.0,210.0,2.21935,2895.24,7.8769,1.9772,539.19,1.3099,16.611,34.392],
        [1.0,220.0,2.26614,2915.02,7.9174,1.9793,544.62,1.3089,17.019,35.361],
        [1.0,230.0,2.31287,2934.83,7.9572,1.9821,549.98,1.3078,17.428,36.342],
        [1.0,240.0,2.35955,2954.66,7.9962,1.9854,555.27,1.3067,17.838,37.335],
        [1.0,250.0,2.40619,2974.54,8.0346,1.9891,560.49,1.3056,18.249,38.34],
        [1.0,260.0,2.45279,2994.45,8.0723,1.9932,565.65,1.3045,18.661,39.356],
        [1.0,270.0,2.49935,3014.4,8.1094,1.9975,570.74,1.3033,19.073,40.383],
        [1.0,280.0,2.54588,3034.4,8.1458,2.0022,575.77,1.3022,19.486,41.421],
        [1.0,290.0,2.59239,3054.45,8.1818,2.007,580.75,1.301,19.899,42.47],
        [1.0,300.0,2.63887,3074.54,8.2171,2.0121,585.67,1.2998,20.313,43.53],
        [1.0,310.0,2.68533,3094.69,8.252,2.0173,590.54,1.2987,20.727,44.599],
        [1.0,320.0,2.73176,3114.89,8.2863,2.0227,595.35,1.2975,21.141,45.679],
        [1.0,330.0,2.77818,3135.14,8.3202,2.0282,600.11,1.2963,21.555,46.768],
        [1.0,340.0,2.82458,3155.45,8.3536,2.0338,604.83,1.2951,21.969,47.867],
        [1.0,350.0,2.87097,3175.82,8.3865,2.0396,609.5,1.2939,22.384,48.975],
        [1.0,360.0,2.91735,3196.24,8.419,2.0454,614.12,1.2928,22.798,50.093],
        [1.0,370.0,2.96371,3216.73,8.4511,2.0514,618.7,1.2916,23.212,51.219],
        [1.0,380.0,3.01006,3237.27,8.4828,2.0574,623.23,1.2904,23.626,52.354],
        [1.0,390.0,3.05639,3257.87,8.5141,2.0635,627.73,1.2892,24.04,53.498],
        [1.0,400.0,3.10272,3278.54,8.5451,2.0697,632.18,1.2881,24.453,54.649],
        [1.0,410.0,3.14904,3299.27,8.5756,2.0759,636.59,1.2869,24.866,55.809],
        [1.0,420.0,3.19535,3320.06,8.6059,2.0822,640.96,1.2857,25.279,56.977],
        [1.0,430.0,3.24165,3340.91,8.6357,2.0886,645.3,1.2845,25.692,58.153],
        [1.0,440.0,3.28795,3361.83,8.6653,2.095,649.59,1.2834,26.103,59.336],
        [1.0,450.0,3.33424,3382.81,8.6945,2.1015,653.85,1.2822,26.515,60.527],
        [1.0,460.0,3.38052,3403.86,8.7234,2.108,658.08,1.2811,26.926,61.725],
        [1.0,470.0,3.42679,3424.97,8.752,2.1146,662.27,1.2799,27.336,62.93],
        [1.0,480.0,3.47306,3446.15,8.7803,2.1212,666.43,1.2788,27.746,64.142],
        [1.0,490.0,3.51932,3467.4,8.8083,2.1279,670.55,1.2776,28.155,65.361],
        [1.0,500.0,3.56558,3488.71,8.8361,2.1345,674.64,1.2765,28.564,66.586],
        [1.0,510.0,3.61184,3510.09,8.8635,2.1413,678.7,1.2753,28.971,67.818],
        [1.0,520.0,3.65809,3531.53,8.8907,2.148,682.73,1.2742,29.379,69.056],
        [1.0,530.0,3.70433,3553.05,8.9177,2.1548,686.73,1.2731,29.785,70.3],
        [1.0,540.0,3.75057,3574.63,8.9444,2.1617,690.7,1.272,30.191,71.551],
        [1.0,550.0,3.79681,3596.28,8.9709,2.1685,694.64,1.2709,30.596,72.807],
        [1.0,560.0,3.84304,3618.0,8.9971,2.1754,698.55,1.2698,31.0,74.069],
        [1.0,570.0,3.88928,3639.79,9.0231,2.1823,702.44,1.2687,31.403,75.337],
        [1.0,580.0,3.9355,3661.65,9.0489,2.1892,706.29,1.2676,31.806,76.611],
        [1.0,590.0,3.98173,3683.58,9.0744,2.1962,710.12,1.2665,32.207,77.889],
        [1.0,600.0,4.02795,3705.57,9.0998,2.2031,713.93,1.2654,32.608,79.173],
        [1.0,650.0,4.25902,3816.6,9.2234,2.2381,732.59,1.2601,34.6,85.67],
        [1.0,700.0,4.49004,3929.38,9.3424,2.2732,750.68,1.255,36.568,92.282],
        [1.0,750.0,4.72101,4043.92,9.4571,2.3083,768.24,1.2502,38.512,98.999],
        [1.0,800.0,4.95196,4160.21,9.5681,2.3434,785.34,1.2455,40.433,105.81],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_800_degc_except_triple_pt_2_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![

        //[2.0,0.0,0.00100011,0.16152,-0.0001411,4.2189,1402.6,9835.3,1791.5,555.73],
        [2.0,2.0,0.00100001,8.59268,0.030613,4.2124,1412.4,9974.1,1673.3,560.74],
        [2.0,4.0,0.00099998,17.0119,0.061101,4.2069,1421.8,10108.0,1567.1,565.54],
        [2.0,6.0,0.00100001,25.421,0.091333,4.2023,1430.8,10236.0,1471.3,570.14],
        [2.0,8.0,0.0010001,33.8216,0.12132,4.1984,1439.5,10359.0,1384.6,574.57],
        [2.0,10.0,0.00100025,42.215,0.15107,4.1951,1447.7,10477.0,1305.8,578.84],
        [2.0,12.0,0.00100045,50.6022,0.18058,4.1922,1455.6,10589.0,1234.0,582.95],
        [2.0,14.0,0.00100071,58.9842,0.20988,4.1898,1463.1,10696.0,1168.3,586.93],
        [2.0,16.0,0.00100101,67.3618,0.23895,4.1878,1470.3,10798.0,1108.0,590.76],
        [2.0,18.0,0.00100136,75.7355,0.26781,4.186,1477.1,10894.0,1052.6,594.48],
        [2.0,20.0,0.00100175,84.1059,0.29646,4.1845,1483.6,10986.0,1001.6,598.07],
        [2.0,25.0,0.00100292,105.021,0.36721,4.1816,1498.3,11192.0,890.01,606.57],
        [2.0,30.0,0.00100432,125.924,0.43673,4.1798,1511.1,11369.0,797.22,614.45],
        [2.0,35.0,0.00100595,146.82,0.5051,4.1787,1522.1,11516.0,719.13,621.76],
        [2.0,40.0,0.00100779,167.712,0.57235,4.1783,1531.5,11636.0,652.74,628.55],
        [2.0,45.0,0.00100983,188.604,0.63854,4.1785,1539.2,11730.0,595.79,634.85],
        [2.0,50.0,0.00101205,209.498,0.70371,4.1793,1545.5,11800.0,546.54,640.69],
        [2.0,55.0,0.00101446,230.398,0.76789,4.1807,1550.4,11847.0,503.65,646.09],
        [2.0,60.0,0.00101703,251.306,0.83112,4.1825,1554.0,11873.0,466.07,651.07],
        [2.0,65.0,0.00101977,272.224,0.89344,4.1849,1556.5,11878.0,432.94,655.64],
        [2.0,70.0,0.00102268,293.156,0.95489,4.1879,1557.8,11864.0,403.58,659.83],
        [2.0,75.0,0.00102575,314.104,1.0155,4.1913,1558.0,11832.0,377.45,663.63],
        [2.0,80.0,0.00102897,335.07,1.0753,4.1953,1557.2,11784.0,354.08,667.06],
        [2.0,85.0,0.00103235,356.058,1.1343,4.1998,1555.6,11720.0,333.11,670.13],
        [2.0,90.0,0.00103588,377.069,1.1926,4.2048,1553.0,11641.0,314.21,672.85],
        [2.0,95.0,0.00103957,398.107,1.2501,4.2103,1549.5,11548.0,297.12,675.23],
        [2.0,100.0,0.00104341,419.173,1.3069,4.2164,1545.3,11443.0,281.61,677.27],
        [2.0,110.0,0.00105155,461.405,1.4186,4.2302,1534.6,11197.0,254.63,680.38],
        [2.0,120.0,0.00106033,503.786,1.5278,4.2464,1521.0,10909.0,232.03,682.24],
        [2.0,120.212,0.00106052,504.684,1.5301,4.2467,1520.7,10903.0,231.6,682.27],
        [2.0,120.212,0.885735,2706.24,7.1269,2.1752,481.88,1.3108,12.934,26.675],
        [2.0,130.0,0.910412,2727.25,7.1796,2.1232,488.81,1.3122,13.326,27.5],
        [2.0,140.0,0.935281,2748.31,7.2312,2.0902,495.51,1.3126,13.728,28.354],
        [2.0,150.0,0.959894,2769.09,7.2809,2.0667,501.97,1.3125,14.132,29.218],
        [2.0,160.0,0.984303,2789.66,7.329,2.0492,508.26,1.3122,14.537,30.095],
        [2.0,170.0,1.00854,2810.09,7.3756,2.0359,514.39,1.3118,14.943,30.984],
        [2.0,180.0,1.03265,2830.39,7.4209,2.0261,520.39,1.3112,15.35,31.887],
        [2.0,190.0,1.05663,2850.62,7.465,2.0189,526.26,1.3105,15.759,32.802],
        [2.0,200.0,1.08052,2870.78,7.5081,2.0139,532.02,1.3098,16.168,33.73],
        [2.0,210.0,1.10432,2890.9,7.5502,2.0106,537.68,1.3089,16.578,34.672],
        [2.0,220.0,1.12805,2911.0,7.5914,2.0089,543.23,1.308,16.99,35.626],
        [2.0,230.0,1.15172,2931.08,7.6317,2.0083,548.7,1.3071,17.402,36.593],
        [2.0,240.0,1.17534,2951.17,7.6712,2.0087,554.09,1.3061,17.814,37.572],
        [2.0,250.0,1.19891,2971.26,7.71,2.01,559.4,1.305,18.228,38.564],
        [2.0,260.0,1.22244,2991.37,7.7481,2.012,564.63,1.304,18.642,39.568],
        [2.0,270.0,1.24593,3011.5,7.7855,2.0145,569.8,1.3029,19.056,40.584],
        [2.0,280.0,1.26939,3031.66,7.8223,2.0176,574.89,1.3018,19.471,41.612],
        [2.0,290.0,1.29282,3051.85,7.8584,2.0211,579.93,1.3007,19.885,42.651],
        [2.0,300.0,1.31623,3072.08,7.894,2.025,584.9,1.2996,20.301,43.701],
        [2.0,310.0,1.33962,3092.35,7.9291,2.0291,589.81,1.2984,20.716,44.761],
        [2.0,320.0,1.36298,3112.67,7.9636,2.0336,594.67,1.2973,21.131,45.833],
        [2.0,330.0,1.38632,3133.03,7.9977,2.0383,599.48,1.2961,21.547,46.915],
        [2.0,340.0,1.40965,3153.43,8.0312,2.0432,604.23,1.295,21.962,48.007],
        [2.0,350.0,1.43296,3173.89,8.0643,2.0483,608.93,1.2938,22.377,49.108],
        [2.0,360.0,1.45626,3194.4,8.097,2.0535,613.59,1.2927,22.793,50.219],
        [2.0,370.0,1.47955,3214.96,8.1292,2.059,618.2,1.2915,23.208,51.34],
        [2.0,380.0,1.50282,3235.58,8.161,2.0645,622.76,1.2903,23.622,52.47],
        [2.0,390.0,1.52608,3256.25,8.1924,2.0702,627.28,1.2892,24.037,53.609],
        [2.0,400.0,1.54934,3276.98,8.2235,2.076,631.75,1.288,24.451,54.756],
        [2.0,410.0,1.57258,3297.77,8.2541,2.0818,636.19,1.2868,24.865,55.912],
        [2.0,420.0,1.59581,3318.62,8.2844,2.0878,640.58,1.2857,25.278,57.076],
        [2.0,430.0,1.61904,3339.53,8.3144,2.0939,644.93,1.2845,25.691,58.248],
        [2.0,440.0,1.64226,3360.5,8.344,2.1,649.25,1.2834,26.103,59.428],
        [2.0,450.0,1.66547,3381.53,8.3733,2.1062,653.53,1.2822,26.515,60.616],
        [2.0,460.0,1.68868,3402.62,8.4022,2.1125,657.77,1.2811,26.926,61.812],
        [2.0,470.0,1.71187,3423.78,8.4309,2.1189,661.97,1.2799,27.337,63.014],
        [2.0,480.0,1.73507,3445.0,8.4593,2.1253,666.14,1.2788,27.747,64.224],
        [2.0,490.0,1.75825,3466.29,8.4873,2.1317,670.28,1.2776,28.157,65.441],
        [2.0,500.0,1.78144,3487.64,8.5151,2.1382,674.39,1.2765,28.565,66.665],
        [2.0,510.0,1.80462,3509.05,8.5426,2.1448,678.46,1.2754,28.973,67.895],
        [2.0,520.0,1.82779,3530.53,8.5699,2.1514,682.5,1.2742,29.381,69.132],
        [2.0,530.0,1.85096,3552.08,8.5969,2.158,686.51,1.2731,29.787,70.375],
        [2.0,540.0,1.87412,3573.69,8.6236,2.1647,690.49,1.272,30.193,71.624],
        [2.0,550.0,1.89728,3595.37,8.6501,2.1715,694.44,1.2709,30.599,72.88],
        [2.0,560.0,1.92044,3617.12,8.6764,2.1782,698.36,1.2698,31.003,74.141],
        [2.0,570.0,1.9436,3638.94,8.7024,2.185,702.26,1.2687,31.406,75.408],
        [2.0,580.0,1.96675,3660.82,8.7282,2.1918,706.12,1.2676,31.809,76.681],
        [2.0,590.0,1.9899,3682.77,8.7538,2.1986,709.96,1.2665,32.211,77.96],
        [2.0,600.0,2.01304,3704.79,8.7792,2.2055,713.78,1.2654,32.612,79.244],
        [2.0,650.0,2.12873,3815.93,8.9029,2.24,732.47,1.2602,34.604,85.74],
        [2.0,700.0,2.24437,3928.8,9.022,2.2748,750.59,1.2551,36.572,92.354],
        [2.0,750.0,2.35996,4043.41,9.1368,2.3096,768.18,1.2502,38.517,99.073],
        [2.0,800.0,2.47553,4159.76,9.2479,2.3445,785.29,1.2455,40.437,105.89],


        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_800_degc_4_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[4.0,0.0,0.001,0.36519,-0.0001277,4.2179,1402.9,4920.4,1791.1,555.88],
        [4.0,2.0,0.000999906,8.79442,0.030619,4.2115,1412.7,4989.8,1673.0,560.88],
        [4.0,4.0,0.000999877,17.2118,0.061101,4.2061,1422.1,5056.6,1566.8,565.68],
        [4.0,6.0,0.000999911,25.6192,0.091327,4.2015,1431.1,5120.8,1471.1,570.28],
        [4.0,8.0,0.00100001,34.0182,0.12131,4.1976,1439.8,5182.3,1384.4,574.71],
        [4.0,10.0,0.00100016,42.41,0.15105,4.1943,1448.0,5241.1,1305.6,578.97],
        [4.0,12.0,0.00100036,50.7957,0.18056,4.1915,1455.9,5297.3,1233.8,583.08],
        [4.0,14.0,0.00100061,59.1763,0.20985,4.1891,1463.4,5350.8,1168.2,587.05],
        [4.0,16.0,0.00100092,67.5525,0.23892,4.1871,1470.6,5401.7,1107.9,590.89],
        [4.0,18.0,0.00100127,75.9249,0.26777,4.1854,1477.4,5450.0,1052.6,594.6],
        [4.0,20.0,0.00100166,84.2941,0.29642,4.1839,1483.9,5495.7,1001.5,598.19],
        [4.0,25.0,0.00100283,105.206,0.36715,4.181,1498.6,5599.0,889.98,606.69],
        [4.0,30.0,0.00100423,126.106,0.43667,4.1792,1511.5,5687.2,797.22,614.56],
        [4.0,35.0,0.00100586,146.999,0.50503,4.1782,1522.5,5761.0,719.15,621.87],
        [4.0,40.0,0.0010077,167.889,0.57228,4.1778,1531.8,5821.1,652.77,628.65],
        [4.0,45.0,0.00100974,188.778,0.63846,4.1781,1539.5,5868.3,595.82,634.95],
        [4.0,50.0,0.00101196,209.671,0.70361,4.1789,1545.8,5903.3,546.58,640.79],
        [4.0,55.0,0.00101437,230.568,0.76779,4.1802,1550.7,5926.8,503.7,646.19],
        [4.0,60.0,0.00101694,251.474,0.83101,4.1821,1554.4,5939.6,466.11,651.17],
        [4.0,65.0,0.00101968,272.39,0.89333,4.1845,1556.8,5942.2,432.99,655.75],
        [4.0,70.0,0.00102259,293.32,0.95477,4.1874,1558.1,5935.3,403.63,659.93],
        [4.0,75.0,0.00102565,314.265,1.0154,4.1909,1558.4,5919.4,377.5,663.74],
        [4.0,80.0,0.00102887,335.229,1.0752,4.1949,1557.6,5895.2,354.14,667.17],
        [4.0,85.0,0.00103225,356.215,1.1342,4.1993,1555.9,5863.2,333.16,670.24],
        [4.0,90.0,0.00103578,377.224,1.1924,4.2044,1553.4,5823.9,314.26,672.96],
        [4.0,95.0,0.00103947,398.259,1.2499,4.2099,1549.9,5777.7,297.17,675.34],
        [4.0,100.0,0.0010433,419.323,1.3068,4.216,1545.7,5725.1,281.67,677.39],
        [4.0,110.0,0.00105144,461.55,1.4185,4.2297,1535.0,5602.3,254.68,680.5],
        [4.0,120.0,0.00106021,503.926,1.5276,4.2459,1521.5,5458.4,232.09,682.36],
        [4.0,130.0,0.00106963,546.476,1.6345,4.2645,1505.3,5296.2,212.97,683.03],
        [4.0,140.0,0.00107974,589.225,1.7392,4.2859,1486.7,5117.8,196.65,682.55],
        [4.0,143.6,0.00108356,604.723,1.7766,4.2944,1479.4,5049.8,191.34,682.1],
        [4.0,143.6,0.462392,2738.06,6.8954,2.3403,491.09,1.3039,13.742,29.477],
        [4.0,150.0,0.470887,2752.78,6.9305,2.2749,495.98,1.306,14.009,30.006],
        [4.0,160.0,0.483935,2775.19,6.9828,2.2121,503.07,1.3074,14.426,30.845],
        [4.0,170.0,0.496761,2797.09,7.0328,2.1708,509.78,1.3078,14.844,31.697],
        [4.0,180.0,0.509418,2818.64,7.0809,2.1403,516.24,1.3079,15.261,32.563],
        [4.0,190.0,0.521938,2839.92,7.1274,2.1167,522.51,1.3077,15.678,33.442],
        [4.0,200.0,0.534345,2860.99,7.1724,2.0984,528.61,1.3073,16.096,34.336],
        [4.0,210.0,0.546656,2881.9,7.2161,2.0841,534.56,1.3068,16.513,35.245],
        [4.0,220.0,0.558886,2902.69,7.2587,2.0732,540.38,1.3062,16.931,36.168],
        [4.0,230.0,0.571047,2923.37,7.3002,2.0649,546.08,1.3055,17.349,37.105],
        [4.0,240.0,0.583149,2943.99,7.3408,2.0588,551.68,1.3048,17.767,38.056],
        [4.0,250.0,0.595199,2964.56,7.3805,2.0546,557.17,1.3039,18.185,39.021],
        [4.0,260.0,0.607205,2985.09,7.4194,2.0519,562.57,1.303,18.603,40.0],
        [4.0,270.0,0.619173,3005.6,7.4575,2.0504,567.88,1.3021,19.022,40.993],
        [4.0,280.0,0.631106,3026.1,7.4949,2.05,573.11,1.3011,19.44,41.998],
        [4.0,290.0,0.643008,3046.6,7.5316,2.0505,578.26,1.3001,19.858,43.016],
        [4.0,300.0,0.654884,3067.11,7.5677,2.0518,583.34,1.299,20.277,44.047],
        [4.0,310.0,0.666736,3087.64,7.6032,2.0537,588.36,1.298,20.695,45.09],
        [4.0,320.0,0.678566,3108.19,7.6381,2.0561,593.31,1.2969,21.113,46.145],
        [4.0,330.0,0.690376,3128.76,7.6725,2.0591,598.19,1.2958,21.53,47.211],
        [4.0,340.0,0.70217,3149.37,7.7064,2.0624,603.02,1.2947,21.948,48.288],
        [4.0,350.0,0.713947,3170.01,7.7398,2.0661,607.8,1.2936,22.365,49.376],
        [4.0,360.0,0.725709,3190.69,7.7728,2.0702,612.52,1.2924,22.782,50.475],
        [4.0,370.0,0.737458,3211.42,7.8052,2.0745,617.18,1.2913,23.199,51.584],
        [4.0,380.0,0.749196,3232.18,7.8373,2.079,621.8,1.2902,23.615,52.703],
        [4.0,390.0,0.760921,3253.0,7.8689,2.0838,626.37,1.289,24.031,53.832],
        [4.0,400.0,0.772637,3273.86,7.9001,2.0887,630.9,1.2879,24.446,54.971],
        [4.0,410.0,0.784343,3294.77,7.931,2.0938,635.38,1.2868,24.861,56.118],
        [4.0,420.0,0.79604,3315.74,7.9614,2.0991,639.81,1.2856,25.275,57.275],
        [4.0,430.0,0.807729,3336.76,7.9915,2.1046,644.2,1.2845,25.689,58.44],
        [4.0,440.0,0.81941,3357.83,8.0213,2.1101,648.56,1.2833,26.103,59.614],
        [4.0,450.0,0.831084,3378.96,8.0507,2.1158,652.87,1.2822,26.515,60.796],
        [4.0,460.0,0.842751,3400.15,8.0798,2.1216,657.14,1.281,26.927,61.986],
        [4.0,470.0,0.854413,3421.39,8.1086,2.1275,661.38,1.2799,27.339,63.184],
        [4.0,480.0,0.866068,3442.69,8.1371,2.1334,665.58,1.2788,27.75,64.389],
        [4.0,490.0,0.877718,3464.06,8.1652,2.1395,669.75,1.2776,28.16,65.602],
        [4.0,500.0,0.889363,3485.49,8.1931,2.1456,673.88,1.2765,28.569,66.823],
        [4.0,510.0,0.901003,3506.97,8.2207,2.1519,677.98,1.2754,28.978,68.05],
        [4.0,520.0,0.912638,3528.52,8.2481,2.1581,682.04,1.2743,29.386,69.284],
        [4.0,530.0,0.924269,3550.14,8.2752,2.1645,686.07,1.2732,29.793,70.525],
        [4.0,540.0,0.935896,3571.81,8.302,2.1709,690.07,1.272,30.199,71.772],
        [4.0,550.0,0.94752,3593.55,8.3286,2.1773,694.04,1.2709,30.604,73.026],
        [4.0,560.0,0.959139,3615.36,8.3549,2.1838,697.99,1.2698,31.009,74.286],
        [4.0,570.0,0.970756,3637.23,8.381,2.1904,701.9,1.2688,31.413,75.552],
        [4.0,580.0,0.982369,3659.17,8.4069,2.1969,705.78,1.2677,31.816,76.824],
        [4.0,590.0,0.993979,3681.17,8.4325,2.2036,709.64,1.2666,32.218,78.101],
        [4.0,600.0,1.00559,3703.24,8.4579,2.2102,713.47,1.2655,32.619,79.384],
        [4.0,650.0,1.06359,3814.59,8.5819,2.2439,732.23,1.2603,34.612,85.88],
        [4.0,700.0,1.12153,3927.63,8.7012,2.2779,750.4,1.2552,36.581,92.497],
        [4.0,750.0,1.17944,4042.38,8.8161,2.3122,768.04,1.2504,38.526,99.221],
        [4.0,800.0,1.23731,4158.85,8.9273,2.3466,785.19,1.2457,40.446,106.04],



        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_800_degc_6_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[6.0,0.0,0.000999902,0.56879,-0.0001144,4.2169,1403.2,3282.0,1790.6,556.03],
        [6.0,2.0,0.000999806,8.9961,0.030625,4.2105,1413.0,3328.3,1672.6,561.03],
        [6.0,4.0,0.000999778,17.4117,0.0611,4.2052,1422.4,3372.9,1566.5,565.82],
        [6.0,6.0,0.000999814,25.8173,0.09132,4.2006,1431.4,3415.7,1470.8,570.42],
        [6.0,8.0,0.000999909,34.2147,0.12129,4.1968,1440.1,3456.7,1384.2,574.84],
        [6.0,10.0,0.00100006,42.605,0.15103,4.1936,1448.3,3495.9,1305.5,579.1],
        [6.0,12.0,0.00100027,50.9892,0.18054,4.1908,1456.2,3533.4,1233.7,583.21],
        [6.0,14.0,0.00100052,59.3684,0.20982,4.1884,1463.8,3569.1,1168.0,587.17],
        [6.0,16.0,0.00100082,67.7432,0.23889,4.1864,1470.9,3603.0,1107.8,591.01],
        [6.0,18.0,0.00100117,76.1143,0.26774,4.1847,1477.7,3635.2,1052.5,594.71],
        [6.0,20.0,0.00100157,84.4823,0.29638,4.1832,1484.2,3665.7,1001.4,598.3],
        [6.0,25.0,0.00100274,105.391,0.3671,4.1805,1499.0,3734.6,889.95,606.8],
        [6.0,30.0,0.00100414,126.288,0.43661,4.1787,1511.8,3793.4,797.21,614.67],
        [6.0,35.0,0.00100578,147.179,0.50496,4.1777,1522.8,3842.6,719.16,621.97],
        [6.0,40.0,0.00100762,168.066,0.5722,4.1773,1532.1,3882.7,652.79,628.76],
        [6.0,45.0,0.00100965,188.953,0.63837,4.1776,1539.9,3914.2,595.86,635.06],
        [6.0,50.0,0.00101188,209.843,0.70352,4.1784,1546.2,3937.6,546.62,640.9],
        [6.0,55.0,0.00101428,230.738,0.76769,4.1798,1551.1,3953.3,503.74,646.3],
        [6.0,60.0,0.00101685,251.642,0.83091,4.1817,1554.7,3961.8,466.16,651.28],
        [6.0,65.0,0.00101959,272.556,0.89322,4.1841,1557.2,3963.6,433.04,655.85],
        [6.0,70.0,0.0010225,293.483,0.95465,4.187,1558.5,3959.0,403.69,660.04],
        [6.0,75.0,0.00102556,314.426,1.0152,4.1905,1558.7,3948.5,377.56,663.84],
        [6.0,80.0,0.00102878,335.388,1.075,4.1944,1558.0,3932.4,354.19,667.28],
        [6.0,85.0,0.00103215,356.372,1.134,4.1989,1556.3,3911.1,333.22,670.35],
        [6.0,90.0,0.00103568,377.378,1.1923,4.2039,1553.7,3884.9,314.32,673.07],
        [6.0,95.0,0.00103937,398.412,1.2498,4.2094,1550.3,3854.2,297.22,675.45],
        [6.0,100.0,0.0010432,419.474,1.3066,4.2155,1546.1,3819.1,281.72,677.5],
        [6.0,110.0,0.00105134,461.696,1.4183,4.2293,1535.4,3737.3,254.73,680.62],
        [6.0,120.0,0.0010601,504.067,1.5275,4.2453,1521.9,3641.5,232.14,682.48],
        [6.0,130.0,0.00106952,546.611,1.6343,4.2639,1505.8,3533.5,213.03,683.16],
        [6.0,140.0,0.00107961,589.355,1.739,4.2853,1487.2,3414.6,196.7,682.68],
        [6.0,150.0,0.00109042,632.328,1.8418,4.3099,1466.3,3286.3,182.64,681.1],
        [6.0,158.832,0.00110061,670.501,1.9311,4.3345,1445.9,3166.0,171.77,679.02],
        [6.0,158.832,0.315575,2756.14,6.7592,2.48,495.88,1.2987,14.264,31.552],
        [6.0,160.0,0.316666,2759.02,6.7658,2.4597,496.87,1.2994,14.314,31.645],
        [6.0,170.0,0.325824,2782.97,6.8205,2.3427,504.69,1.3029,14.743,32.45],
        [6.0,180.0,0.334744,2806.04,6.872,2.2759,511.81,1.3042,15.171,33.273],
        [6.0,190.0,0.343496,2828.55,6.9211,2.2295,518.55,1.3047,15.597,34.111],
        [6.0,200.0,0.352116,2850.66,6.9684,2.1942,525.04,1.3048,16.023,34.967],
        [6.0,210.0,0.360628,2872.46,7.0139,2.1666,531.32,1.3047,16.448,35.839],
        [6.0,220.0,0.36905,2894.01,7.0581,2.1446,537.43,1.3044,16.873,36.727],
        [6.0,230.0,0.377395,2915.37,7.101,2.1273,543.38,1.3039,17.296,37.632],
        [6.0,240.0,0.385675,2936.57,7.1427,2.1136,549.19,1.3034,17.72,38.553],
        [6.0,250.0,0.393899,2957.65,7.1834,2.103,554.88,1.3027,18.143,39.49],
        [6.0,260.0,0.402075,2978.64,7.2231,2.0949,560.45,1.302,18.566,40.442],
        [6.0,270.0,0.410209,2999.56,7.262,2.0888,565.91,1.3012,18.988,41.41],
        [6.0,280.0,0.418307,3020.42,7.3001,2.0845,571.28,1.3003,19.41,42.392],
        [6.0,290.0,0.426372,3041.25,7.3374,2.0817,576.56,1.2994,19.831,43.389],
        [6.0,300.0,0.434409,3062.06,7.374,2.08,581.76,1.2985,20.253,44.399],
        [6.0,310.0,0.44242,3082.86,7.41,2.0794,586.88,1.2975,20.673,45.424],
        [6.0,320.0,0.450409,3103.65,7.4453,2.0797,591.92,1.2965,21.094,46.461],
        [6.0,330.0,0.458378,3124.45,7.4801,2.0807,596.89,1.2954,21.514,47.511],
        [6.0,340.0,0.466328,3145.27,7.5143,2.0823,601.8,1.2944,21.934,48.573],
        [6.0,350.0,0.474262,3166.1,7.548,2.0845,606.65,1.2933,22.353,49.648],
        [6.0,360.0,0.482181,3186.96,7.5812,2.0872,611.43,1.2922,22.772,50.734],
        [6.0,370.0,0.490086,3207.85,7.614,2.0903,616.16,1.2911,23.19,51.831],
        [6.0,380.0,0.497979,3228.77,7.6463,2.0938,620.84,1.29,23.608,52.939],
        [6.0,390.0,0.50586,3249.72,7.6781,2.0976,625.46,1.2889,24.025,54.058],
        [6.0,400.0,0.513731,3270.72,7.7095,2.1017,630.04,1.2878,24.442,55.187],
        [6.0,410.0,0.521592,3291.76,7.7405,2.106,634.56,1.2867,24.858,56.326],
        [6.0,420.0,0.529444,3312.84,7.7712,2.1106,639.04,1.2855,25.273,57.475],
        [6.0,430.0,0.537287,3333.97,7.8014,2.1154,643.47,1.2844,25.688,58.633],
        [6.0,440.0,0.545123,3355.15,7.8314,2.1203,647.86,1.2833,26.102,59.801],
        [6.0,450.0,0.552952,3376.38,7.8609,2.1255,652.21,1.2822,26.516,60.977],
        [6.0,460.0,0.560774,3397.66,7.8901,2.1307,656.52,1.281,26.929,62.162],
        [6.0,470.0,0.568589,3418.99,7.919,2.1362,660.79,1.2799,27.341,63.355],
        [6.0,480.0,0.576399,3440.38,7.9476,2.1417,665.02,1.2788,27.752,64.556],
        [6.0,490.0,0.584203,3461.83,7.9759,2.1473,669.21,1.2776,28.163,65.765],
        [6.0,500.0,0.592002,3483.33,8.0039,2.1531,673.37,1.2765,28.573,66.982],
        [6.0,510.0,0.599796,3504.89,8.0316,2.159,677.49,1.2754,28.982,68.206],
        [6.0,520.0,0.607586,3526.51,8.0591,2.1649,681.58,1.2743,29.39,69.437],
        [6.0,530.0,0.615371,3548.19,8.0862,2.1709,685.63,1.2732,29.798,70.676],
        [6.0,540.0,0.623153,3569.93,8.1131,2.177,689.66,1.2721,30.205,71.921],
        [6.0,550.0,0.63093,3591.73,8.1398,2.1832,693.65,1.271,30.61,73.173],
        [6.0,560.0,0.638704,3613.59,8.1662,2.1895,697.61,1.2699,31.015,74.431],
        [6.0,570.0,0.646475,3635.52,8.1923,2.1958,701.54,1.2688,31.42,75.696],
        [6.0,580.0,0.654242,3657.51,8.2183,2.2021,705.44,1.2677,31.823,76.967],
        [6.0,590.0,0.662006,3679.56,8.2439,2.2085,709.31,1.2667,32.225,78.243],
        [6.0,600.0,0.669768,3701.68,8.2694,2.215,713.16,1.2656,32.627,79.526],
        [6.0,650.0,0.708536,3813.24,8.3937,2.2477,731.99,1.2604,34.62,86.021],
        [6.0,700.0,0.747253,3926.46,8.5131,2.2811,750.22,1.2553,36.59,92.64],
        [6.0,750.0,0.785928,4041.36,8.6282,2.3148,767.91,1.2505,38.535,99.369],
        [6.0,800.0,0.824571,4157.95,8.7395,2.3488,785.1,1.2459,40.455,106.19],
        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

#[test]
pub fn single_phase_table_2_to_800_degc(){

    let steam_table: Vec<[f64; 10]> =
        vec![
        //[8.000,0.000,0.000999801,0.77234,-0.0001013,4.216,1403.5000,2462.9000,1790.2000,556.1800],
        [8.000,2.000,0.000999706,9.19771,0.030632,4.2096,1413.3000,2497.6000,1672.2000,561.1800],
        [8.000,4.000,0.000999679,17.6115,0.0611,4.2043,1422.7000,2531.0000,1566.2000,565.9600],
        [8.000,6.000,0.000999716,26.0154,0.091314,4.1998,1431.8000,2563.1000,1470.6000,570.5600],
        [8.000,8.000,0.000999812,34.4111,0.12128,4.196,1440.4000,2593.9000,1384.0000,574.9800],
        [8.000,10.000,0.000999965,42.7999,0.15101,4.1928,1448.7000,2623.4000,1305.3000,579.2300],
        [8.000,12.000,0.00100017,51.1827,0.18052,4.1901,1456.5000,2651.5000,1233.5000,583.3400],
        [8.000,14.000,0.00100043,59.5605,0.20979,4.1878,1464.1000,2678.2000,1167.9000,587.3000],
        [8.000,16.000,0.00100073,67.9339,0.23885,4.1858,1471.2000,2703.7000,1107.7000,591.1300],
        [8.000,18.000,0.00100108,76.3037,0.2677,4.1841,1478.0000,2727.8000,1052.4000,594.8300],
        [8.000,20.000,0.00100148,84.6704,0.29634,4.1826,1484.5000,2750.7000,1001.4000,598.4200],
        [8.000,25.000,0.00100264,105.576,0.36705,4.1799,1499.3000,2802.4000,889.9300,606.9100],
        [8.000,30.000,0.00100405,126.471,0.43655,4.1781,1512.1000,2846.5000,797.2100,614.7800],
        [8.000,35.000,0.00100569,147.359,0.50489,4.1772,1523.1000,2883.4000,719.1700,622.0800],
        [8.000,40.000,0.00100753,168.243,0.57212,4.1768,1532.4000,2913.5000,652.8200,628.8600],
        [8.000,45.000,0.00100956,189.128,0.63829,4.1771,1540.2000,2937.1000,595.8900,635.1600],
        [8.000,50.000,0.00101179,210.015,0.70343,4.1779,1546.5000,2954.7000,546.6600,641.0000],
        [8.000,55.000,0.00101419,230.908,0.76759,4.1793,1551.4000,2966.5000,503.7900,646.4000],
        [8.000,60.000,0.00101676,251.809,0.8308,4.1812,1555.1000,2972.9000,466.2100,651.3800],
        [8.000,65.000,0.0010195,272.721,0.89311,4.1836,1557.5000,2974.3000,433.0900,655.9600],
        [8.000,70.000,0.0010224,293.647,0.95453,4.1866,1558.8000,2970.9000,403.7400,660.1400],
        [8.000,75.000,0.00102547,314.588,1.0151,4.19,1559.1000,2963.0000,377.6100,663.9500],
        [8.000,80.000,0.00102868,335.548,1.0749,4.194,1558.4000,2951.0000,354.2500,667.3800],
        [8.000,85.000,0.00103206,356.529,1.1339,4.1985,1556.7000,2935.0000,333.2700,670.4600],
        [8.000,90.000,0.00103559,377.533,1.1921,4.2035,1554.1000,2915.4000,314.3700,673.1800],
        [8.000,95.000,0.00103927,398.564,1.2496,4.209,1550.7000,2892.4000,297.2800,675.5700],
        [8.000,100.000,0.0010431,419.624,1.3065,4.215,1546.5000,2866.1000,281.7700,677.6100],
        [8.000,110.000,0.00105123,461.841,1.4181,4.2288,1535.9000,2804.9000,254.7900,680.7300],
        [8.000,120.000,0.00105999,504.207,1.5273,4.2448,1522.4000,2733.1000,232.1900,682.6100],
        [8.000,130.000,0.0010694,546.746,1.6341,4.2634,1506.3000,2652.1000,213.0800,683.2800],
        [8.000,140.000,0.00107948,589.484,1.7388,4.2847,1487.7000,2563.0000,196.7600,682.8100],
        [8.000,150.000,0.00109029,632.451,1.8416,4.3092,1466.9000,2466.9000,182.6900,681.2400],
        [8.000,160.000,0.00110186,675.681,1.9426,4.3373,1443.7000,2364.5000,170.4800,678.8500],
        [8.000,170.000,0.00111426,719.211,2.0419,4.3695,1418.3000,2256.6000,159.7800,675.5300],
        [8.000,170.414,0.00111479,721.018,2.046,4.3709,1417.2000,2252.0000,159.3600,675.3700],
        [8.000,170.414,0.240328,2768.3,6.6615,2.6032,498.8700,1.2944,14.6590,33.2850],
        [8.000,180.000,0.247183,2792.44,6.7154,2.4499,506.9000,1.2994,15.0790,34.0220],
        [8.000,190.000,0.254105,2816.46,6.7678,2.3621,514.3400,1.3013,15.5160,34.8130],
        [8.000,200.000,0.260868,2839.77,6.8176,2.303,521.2900,1.3021,15.9500,35.6240],
        [8.000,210.000,0.267506,2862.57,6.8653,2.2586,527.9500,1.3024,16.3820,36.4550],
        [8.000,220.000,0.274043,2884.97,6.9112,2.2236,534.3600,1.3025,16.8140,37.3060],
        [8.000,230.000,0.280496,2907.06,6.9555,2.1956,540.5800,1.3023,17.2440,38.1760],
        [8.000,240.000,0.286878,2928.9,6.9985,2.1732,546.6300,1.3020,17.6730,39.0640],
        [8.000,250.000,0.293199,2950.54,7.0403,2.1553,552.5200,1.3015,18.1010,39.9710],
        [8.000,260.000,0.299469,2972.02,7.081,2.1411,558.2800,1.3010,18.5280,40.8950],
        [8.000,270.000,0.305693,2993.37,7.1206,2.1298,563.9100,1.3003,18.9540,41.8360],
        [8.000,280.000,0.311878,3014.63,7.1594,2.1211,569.4200,1.2996,19.3800,42.7940],
        [8.000,290.000,0.31803,3035.8,7.1974,2.1145,574.8400,1.2988,19.8050,43.7680],
        [8.000,300.000,0.324151,3056.92,7.2345,2.1097,580.1500,1.2979,20.2290,44.7580],
        [8.000,310.000,0.330245,3078.0,7.271,2.1063,585.3700,1.2970,20.6530,45.7620],
        [8.000,320.000,0.336316,3099.05,7.3068,2.1042,590.5100,1.2961,21.0760,46.7820],
        [8.000,330.000,0.342366,3120.09,7.342,2.1031,595.5800,1.2951,21.4980,47.8150],
        [8.000,340.000,0.348397,3141.12,7.3765,2.1029,600.5700,1.2941,21.9200,48.8620],
        [8.000,350.000,0.354411,3162.15,7.4106,2.1035,605.4900,1.2930,22.3410,49.9220],
        [8.000,360.000,0.360409,3183.19,7.4441,2.1048,610.3400,1.2920,22.7620,50.9950],
        [8.000,370.000,0.366393,3204.25,7.4771,2.1066,615.1400,1.2909,23.1820,52.0810],
        [8.000,380.000,0.372365,3225.33,7.5096,2.109,619.8700,1.2899,23.6010,53.1780],
        [8.000,390.000,0.378324,3246.43,7.5416,2.1117,624.5500,1.2888,24.0190,54.2860],
        [8.000,400.000,0.384273,3267.56,7.5733,2.1149,629.1700,1.2877,24.4370,55.4060],
        [8.000,410.000,0.390212,3288.73,7.6045,2.1184,633.7400,1.2866,24.8550,56.5370],
        [8.000,420.000,0.396142,3309.93,7.6353,2.1223,638.2600,1.2855,25.2710,57.6780],
        [8.000,430.000,0.402063,3331.17,7.6657,2.1264,642.7400,1.2844,25.6870,58.8290],
        [8.000,440.000,0.407977,3352.46,7.6958,2.1307,647.1700,1.2832,26.1020,59.9890],
        [8.000,450.000,0.413883,3373.79,7.7255,2.1352,651.5500,1.2821,26.5170,61.1590],
        [8.000,460.000,0.419783,3395.16,7.7548,2.14,655.8900,1.2810,26.9300,62.3390],
        [8.000,470.000,0.425676,3416.59,7.7839,2.1449,660.1900,1.2799,27.3430,63.5270],
        [8.000,480.000,0.431563,3438.06,7.8126,2.15,664.4500,1.2788,27.7550,64.7240],
        [8.000,490.000,0.437444,3459.59,7.841,2.1553,668.6700,1.2777,28.1670,65.9290],
        [8.000,500.000,0.443321,3481.17,7.869,2.1606,672.8600,1.2766,28.5770,67.1420],
        [8.000,510.000,0.449192,3502.8,7.8969,2.1661,677.0000,1.2754,28.9870,68.3630],
        [8.000,520.000,0.455059,3524.49,7.9244,2.1717,681.1200,1.2743,29.3950,69.5920],
        [8.000,530.000,0.460921,3546.24,7.9516,2.1774,685.1900,1.2732,29.8030,70.8280],
        [8.000,540.000,0.46678,3568.04,7.9786,2.1833,689.2400,1.2721,30.2100,72.0710],
        [8.000,550.000,0.472635,3589.9,8.0053,2.1892,693.2500,1.2711,30.6170,73.3210],
        [8.000,560.000,0.478486,3611.82,8.0318,2.1951,697.2300,1.2700,31.0220,74.5770],
        [8.000,570.000,0.484333,3633.81,8.058,2.2012,701.1800,1.2689,31.4260,75.8410],
        [8.000,580.000,0.490178,3655.85,8.084,2.2073,705.1000,1.2678,31.8300,77.1100],
        [8.000,590.000,0.496019,3677.95,8.1098,2.2135,708.9900,1.2667,32.2330,78.3860],
        [8.000,600.000,0.501857,3700.12,8.1353,2.2197,712.8500,1.2657,32.6340,79.6680],
        [8.000,650.000,0.531012,3811.9,8.2598,2.2516,731.7500,1.2605,34.6280,86.1620],
        [8.000,700.000,0.560113,3925.29,8.3794,2.2843,750.0400,1.2555,36.5990,92.7840],
        [8.000,750.000,0.589174,4040.33,8.4947,2.3175,767.7700,1.2506,38.5440,99.5180],
        [8.000,800.000,0.618202,4157.04,8.606,2.351,785.0000,1.2460,40.4640,106.3500],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}
#[test]
pub fn single_phase_table_2_to_750_degc_10_bar(){

    let steam_table: Vec<[f64; 10]> =
        vec![

        //[10.000,0.000,0.000999699,0.97582,-0.00008842,4.215,1403.80000,1971.40000,1789.70000,556.33000],
        [10.000,2.000,0.000999606,9.39927,0.030637,4.2087,1413.60000,1999.20000,1671.80000,561.32000],
        [10.000,4.000,0.000999581,17.8112,0.061099,4.2034,1423.10000,2025.90000,1565.90000,566.10000],
        [10.000,6.000,0.000999618,26.2135,0.091307,4.199,1432.10000,2051.60000,1470.30000,570.70000],
        [10.000,8.000,0.000999716,34.6076,0.12127,4.1952,1440.70000,2076.20000,1383.70000,575.11000],
        [10.000,10.000,0.00099987,42.9948,0.151,4.1921,1449.00000,2099.80000,1305.10000,579.36000],
        [10.000,12.000,0.00100008,51.3761,0.18049,4.1894,1456.90000,2122.30000,1233.40000,583.46000],
        [10.000,14.000,0.00100033,59.7525,0.20977,4.1871,1464.40000,2143.70000,1167.80000,587.42000],
        [10.000,16.000,0.00100064,68.1246,0.23882,4.1851,1471.50000,2164.10000,1107.60000,591.25000],
        [10.000,18.000,0.00100099,76.4931,0.26766,4.1834,1478.40000,2183.40000,1052.30000,594.95000],
        [10.000,20.000,0.00100139,84.8585,0.2963,4.182,1484.80000,2201.70000,1001.30000,598.54000],
        [10.000,25.000,0.00100255,105.761,0.367,4.1793,1499.60000,2243.10000,889.90000,607.02000],
        [10.000,30.000,0.00100396,126.653,0.43649,4.1776,1512.40000,2278.40000,797.20000,614.89000],
        [10.000,35.000,0.0010056,147.538,0.50482,4.1766,1523.40000,2307.90000,719.18000,622.19000],
        [10.000,40.000,0.00100744,168.421,0.57204,4.1763,1532.80000,2332.00000,652.84000,628.97000],
        [10.000,45.000,0.00100947,189.303,0.6382,4.1766,1540.50000,2350.90000,595.93000,635.27000],
        [10.000,50.000,0.0010117,210.188,0.70334,4.1775,1546.80000,2365.00000,546.70000,641.10000],
        [10.000,55.000,0.0010141,231.079,0.76749,4.1789,1551.70000,2374.40000,503.83000,646.50000],
        [10.000,60.000,0.00101667,251.977,0.8307,4.1808,1555.40000,2379.60000,466.26000,651.49000],
        [10.000,65.000,0.00101941,272.887,0.89299,4.1832,1557.90000,2380.70000,433.14000,656.06000],
        [10.000,70.000,0.00102231,293.81,0.95441,4.1861,1559.20000,2378.00000,403.79000,660.25000],
        [10.000,75.000,0.00102537,314.749,1.015,4.1896,1559.50000,2371.70000,377.66000,664.06000],
        [10.000,80.000,0.00102859,335.707,1.0748,4.1935,1558.70000,2362.10000,354.30000,667.49000],
        [10.000,85.000,0.00103196,356.686,1.1338,4.198,1557.10000,2349.40000,333.32000,670.57000],
        [10.000,90.000,0.00103549,377.688,1.192,4.203,1554.50000,2333.70000,314.42000,673.29000],
        [10.000,95.000,0.00103917,398.717,1.2495,4.2085,1551.10000,2315.30000,297.33000,675.68000],
        [10.000,100.000,0.001043,419.774,1.3063,4.2146,1546.90000,2294.30000,281.83000,677.73000],
        [10.000,110.000,0.00105112,461.987,1.4179,4.2283,1536.30000,2245.40000,254.84000,680.85000],
        [10.000,120.000,0.00105988,504.348,1.5271,4.2443,1522.80000,2188.00000,232.25000,682.73000],
        [10.000,130.000,0.00106928,546.882,1.6339,4.2629,1506.80000,2123.30000,213.13000,683.41000],
        [10.000,140.000,0.00107936,589.614,1.7386,4.2841,1488.30000,2052.10000,196.81000,682.94000],
        [10.000,150.000,0.00109015,632.575,1.8414,4.3086,1467.40000,1975.20000,182.74000,681.37000],
        [10.000,160.000,0.00110171,675.797,1.9423,4.3366,1444.30000,1893.40000,170.53000,678.99000],
        [10.000,170.000,0.0011141,719.32,2.0417,4.3687,1418.90000,1807.10000,159.83000,675.67000],
        [10.000,179.886,0.00112723,762.683,2.1384,4.4051,1391.60000,1718.10000,150.48000,671.34000],
        [10.000,179.886,0.194349,2777.12,6.585,2.715,500.89000,1.29100,14.98100,34.81200],
        [10.000,180.000,0.194418,2777.43,6.5857,2.7119,501.00000,1.29110,14.98600,34.82100],
        [10.000,190.000,0.200319,2803.52,6.6426,2.5285,509.69000,1.29690,15.43300,35.55200],
        [10.000,200.000,0.206004,2828.27,6.6955,2.4288,517.32000,1.29910,15.87600,36.31200],
        [10.000,210.000,0.211542,2852.2,6.7455,2.3614,524.41000,1.30000,16.31600,37.09700],
        [10.000,220.000,0.216966,2875.55,6.7934,2.3105,531.18000,1.30050,16.75500,37.90600],
        [10.000,230.000,0.222297,2898.45,6.8393,2.2702,537.69000,1.30060,17.19100,38.73700],
        [10.000,240.000,0.227551,2920.98,6.8837,2.2378,543.99000,1.30050,17.62500,39.59000],
        [10.000,250.000,0.232739,2943.22,6.9266,2.2116,550.11000,1.30020,18.05800,40.46400],
        [10.000,260.000,0.237871,2965.23,6.9683,2.1905,556.06000,1.29990,18.49000,41.35800],
        [10.000,270.000,0.242955,2987.05,7.0088,2.1735,561.86000,1.29940,18.92000,42.27200],
        [10.000,280.000,0.247998,3008.71,7.0484,2.16,567.53000,1.29880,19.35000,43.20400],
        [10.000,290.000,0.253004,3030.25,7.087,2.1492,573.08000,1.29810,19.77800,44.15400],
        [10.000,300.000,0.257979,3051.7,7.1247,2.1408,578.51000,1.29730,20.20500,45.12200],
        [10.000,310.000,0.262926,3073.08,7.1617,2.1344,583.85000,1.29650,20.63200,46.10700],
        [10.000,320.000,0.267848,3094.4,7.1979,2.1297,589.09000,1.29560,21.05800,47.10800],
        [10.000,330.000,0.272749,3115.68,7.2335,2.1263,594.25000,1.29470,21.48200,48.12400],
        [10.000,340.000,0.277629,3136.93,7.2685,2.1242,599.32000,1.29380,21.90600,49.15500],
        [10.000,350.000,0.282492,3158.16,7.3028,2.1231,604.32000,1.29280,22.32900,50.20100],
        [10.000,360.000,0.287339,3179.39,7.3366,2.1228,609.24000,1.29180,22.75200,51.26000],
        [10.000,370.000,0.292172,3200.62,7.3699,2.1233,614.10000,1.29070,23.17300,52.33300],
        [10.000,380.000,0.296991,3221.86,7.4026,2.1245,618.89000,1.28970,23.59400,53.41900],
        [10.000,390.000,0.301799,3243.11,7.4349,2.1262,623.62000,1.28860,24.01400,54.51700],
        [10.000,400.000,0.306595,3264.39,7.4668,2.1284,628.30000,1.28760,24.43300,55.62700],
        [10.000,410.000,0.311381,3285.68,7.4982,2.1311,632.92000,1.28650,24.85200,56.74900],
        [10.000,420.000,0.316158,3307.01,7.5292,2.1341,637.48000,1.28540,25.26900,57.88200],
        [10.000,430.000,0.320927,3328.37,7.5598,2.1375,642.00000,1.28430,25.68600,59.02500],
        [10.000,440.000,0.325687,3349.76,7.59,2.1412,646.47000,1.28320,26.10200,60.17900],
        [10.000,450.000,0.33044,3371.19,7.6198,2.1451,650.89000,1.28210,26.51800,61.34400],
        [10.000,460.000,0.335186,3392.66,7.6493,2.1494,655.26000,1.28100,26.93200,62.51700],
        [10.000,470.000,0.339926,3414.18,7.6785,2.1538,659.59000,1.27990,27.34600,63.70100],
        [10.000,480.000,0.344659,3435.74,7.7073,2.1584,663.88000,1.27880,27.75800,64.89300],
        [10.000,490.000,0.349387,3457.35,7.7358,2.1632,668.13000,1.27770,28.17000,66.09400],
        [10.000,500.000,0.35411,3479.0,7.764,2.1682,672.34000,1.27660,28.58100,67.30300],
        [10.000,510.000,0.358828,3500.71,7.7919,2.1733,676.52000,1.27550,28.99100,68.52100],
        [10.000,520.000,0.363541,3522.47,7.8195,2.1786,680.65000,1.27440,29.40100,69.74700],
        [10.000,530.000,0.36825,3544.28,7.8468,2.184,684.75000,1.27330,29.80900,70.98000],
        [10.000,540.000,0.372955,3566.15,7.8739,2.1895,688.82000,1.27220,30.21600,72.22100],
        [10.000,550.000,0.377656,3588.07,7.9007,2.1951,692.85000,1.27110,30.62300,73.46900],
        [10.000,560.000,0.382354,3610.05,7.9272,2.2008,696.85000,1.27000,31.02900,74.72500],
        [10.000,570.000,0.387048,3632.09,7.9535,2.2066,700.82000,1.26900,31.43300,75.98700],
        [10.000,580.000,0.391738,3654.19,7.9795,2.2125,704.76000,1.26790,31.83700,77.25500],
        [10.000,590.000,0.396426,3676.34,8.0054,2.2185,708.66000,1.26680,32.24000,78.53000],
        [10.000,600.000,0.401111,3698.56,8.0309,2.2245,712.54000,1.26580,32.64200,79.81100],
        [10.000,650.000,0.424497,3810.55,8.1557,2.2555,731.51000,1.26060,34.63700,86.30500],
        [10.000,700.000,0.447829,3924.12,8.2755,2.2875,749.86000,1.25560,36.60700,92.92900],
        [10.000,750.000,0.471121,4039.31,8.3909,2.3201,767.64000,1.25080,38.55300,99.66700],
        [10.000,800.000,0.49438,4156.14,8.5024,2.3532,784.91000,1.24620,40.47300,106.50000],

        ];

        for dataset in steam_table {
            let p_bar = dataset[0];
            let t_deg_c = dataset[1];
            let v_m3_per_kg = dataset[2];
            let h_kj_per_kg = dataset[3];
            let s_kj_per_kg_k = dataset[4];
            let cp_kj_per_kg_k = dataset[5];
            let w_m_per_s = dataset[6];
            let kappa_dimensionless = dataset[7];
            let eta_micropascal_second = dataset[8];
            let lambda_milliwatt_per_meter_kelvin = dataset[9];
            assert_pt_flash(p_bar, t_deg_c, v_m3_per_kg, h_kj_per_kg, 
                s_kj_per_kg_k, cp_kj_per_kg_k, w_m_per_s, 
                kappa_dimensionless, eta_micropascal_second, 
                lambda_milliwatt_per_meter_kelvin);
        }
}

fn assert_pt_flash(
    p_bar: f64,
    t_deg_c: f64,
    v_m3_per_kg: f64,
    h_kj_per_kg: f64,
    s_kj_per_kg_k: f64,
    cp_kj_per_kg_k: f64,
    w_m_per_s: f64,
    kappa_dimensionless: f64,
    eta_micropascal_second: f64,
    lambda_milliwatt_per_meter_kelvin: f64,
){
    let p = Pressure::new::<bar>(p_bar);
    let t = ThermodynamicTemperature::new::<degree_celsius>(t_deg_c);
    let h_ref = AvailableEnergy::new::<kilojoule_per_kilogram>(h_kj_per_kg);
    // check if t is less than or equal to tsat 
    
    let t_sat = sat_temp_4(p);
    let fifty_kelvin = TemperatureInterval::new::<temperature_interval::kelvin>(50.0);
    
    let x: f64;
    
    if t > t_sat + fifty_kelvin {
        x = 1.0;
    } else {
        x = x_ph_flash(p, h_ref);
    };


    // assert h
    let h_test = h_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        h_kj_per_kg,
        h_test.get::<kilojoule_per_kilogram>(),
        max_relative=1e-4
        );

    // assert volume to within 0.01%  (that's the tolerable error for 
    // backward eqn)
    let v_test = v_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        v_m3_per_kg,
        v_test.get::<cubic_meter_per_kilogram>(),
        max_relative=1e-4
        );

    // now entropy 
    let s_test = s_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        s_kj_per_kg_k,
        s_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=1e-3
        );

    // cp 
    let cp_test = cp_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        cp_kj_per_kg_k,
        cp_test.get::<kilojoule_per_kilogram_kelvin>(),
        max_relative=1e-3
        );
    // w 
    let w_test = w_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        w_m_per_s,
        w_test.get::<meter_per_second>(),
        max_relative=1e-4
        );

    // kappa
    let kappa_test = kappa_tp_eqm_two_phase(t, p, x);
    approx::assert_relative_eq!(
        kappa_dimensionless,
        kappa_test.get::<ratio>(),
        max_relative=9e-3
        );

    // dynamic_viscosity
    let eta_micropascal_second_test = mu_tp_eqm_two_phase(t, p, x)
        .get::<micropascal_second>();
    approx::assert_relative_eq!(
        eta_micropascal_second,
        eta_micropascal_second_test,
        max_relative=2e-2
        );

    // thermal_conductivity

    let lambda_milliwatt_per_meter_kelvin_test 
        = lambda_tp_eqm_two_phase(t, p, x).get::<milliwatt_per_meter_kelvin>();
    approx::assert_relative_eq!(
        lambda_milliwatt_per_meter_kelvin,
        lambda_milliwatt_per_meter_kelvin_test,
        max_relative=1.5e-2
        );


}



